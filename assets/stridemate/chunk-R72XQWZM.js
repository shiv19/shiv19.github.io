import{a as jt}from"./chunk-2GT6F2KJ.js";import{$b as X,$c as ai,Aa as Ae,Ab as oe,Ac as St,Ad as _i,Ba as s,Bb as ze,Bc as Zn,Bd as bi,Ca as v,Cb as K,Cc as Ot,Cd as xi,Da as T,Db as He,Dc as It,Dd as Ci,Ea as te,Eb as We,Ed as Dt,Fa as Ie,Fb as re,Fd as Rt,G as dn,Ga as Ee,Gb as xt,Gd as vi,Ha as De,Hb as le,Hd as Vt,Ia as hn,Ib as Tn,Id as yi,J as A,Ja as me,Jb as Mn,Jd as ki,Ka as gn,Kb as Sn,Kd as wi,La as fn,Lb as je,Ld as Pi,M as Ve,Ma as _n,Mb as Q,Md as Ti,N as g,Na as bn,Nb as On,Nd as Te,O as f,Oa as I,Ob as se,Od as Mi,Pa as E,Pb as ce,Qa as xn,Qb as q,Qc as be,R as z,S as mn,Sa as U,Sb as Ct,Ta as Wt,Tb as Pe,Tc as M,U as mt,Ub as In,Uc as sa,V as D,Va as Cn,Vb as H,Vc as Xn,Wa as ft,Wb as fe,Wc as Jn,Xa as Be,Xb as vt,Xc as ei,Y as pt,Ya as vn,Yb as Z,Yc as ti,Z as pn,Za as yn,Zb as yt,Zc as ni,_ as d,_a as $,_b as Ke,_c as ii,aa as at,ac as Dn,ad as ne,ba as R,bc as Rn,bd as oi,ca as un,cc as Vn,cd as ri,da as x,db as Fe,dc as kt,dd as li,eb as ke,ec as An,ed as Et,fc as Ge,fd as si,ga as L,gb as ue,gc as Bn,gd as qe,ha as h,hb as _t,hc as Ye,hd as rt,ia as ut,ib as we,ic as Fn,ja as w,jc as $n,ka as C,kc as Ln,la as pe,lc as Nn,ld as Ut,ma as ot,mc as zn,md as lt,na as S,nc as Hn,nd as Kt,oa as O,ob as $e,oc as wt,od as Gt,pa as a,pb as Le,pc as Pt,pd as Yt,qa as o,qb as kn,qc as Wn,qd as qt,ra as b,rb as bt,rc as jn,rd as ci,sa as ht,sb as ge,sc as Un,sd as di,ta as gt,tb as Ne,tc as Tt,td as Qt,ua as k,uc as Kn,ud as mi,va as u,vc as Mt,vd as pi,wa as p,wb as wn,wc as Gn,wd as ui,xa as Me,xc as Yn,xd as hi,ya as Se,yb as Pn,yc as qn,yd as gi,za as Oe,zb as Y,zc as Qn,zd as fi}from"./chunk-VM6O2TVU.js";import"./chunk-SLQ2DS3G.js";import{a as W}from"./chunk-3ORAKWS2.js";import{a as Ue,b as _e,c as En}from"./chunk-VGWXPRBH.js";import"./chunk-RKPUEK56.js";import"./chunk-D66CROZD.js";import"./chunk-5QXA6RFF.js";import"./chunk-F67JXMIH.js";import"./chunk-K2ZTZ6NN.js";import"./chunk-4U6PRYVA.js";import"./chunk-FXFZIWDD.js";import"./chunk-CSG5OQLY.js";import"./chunk-VMHM3MLJ.js";import"./chunk-YAUMUHNT.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{a as N,b as j,g as la}from"./chunk-E6HTCO4C.js";var Si=_e("Haptics",{web:()=>import("./chunk-FHAZAMUM.js").then(r=>new r.HapticsWeb)});var ca=r=>({"grid-template-columns":r});function da(r,l){if(r&1){let i=k();a(0,"button",5),u("pointerdown",function(){let t=g(i),n=t.$implicit,c=t.$index,m=p().$index,_=p(2);return f(_.onButtonPress(n,m,c))}),a(1,"span",6),s(2),o()()}if(r&2){let i=l.$implicit,e=l.$index,t=p(),n=t.$implicit,c=t.$index,m=p(2);w("pill-button-first",e===0)("pill-button-last",e===n.length-1)("is-pressed",m.getButtonState(c,e)==="pressed"),L("aria-label","Input "+i),d(2),v(i)}}function ma(r,l){if(r&1&&(a(0,"div",3),S(1,da,3,8,"button",4,pe),o()),r&2){let i=l.$implicit;d(),O(i)}}function pa(r,l){if(r&1&&(a(0,"div",2),S(1,ma,3,0,"div",3,pe),o()),r&2){let i=p();w("collapse-mode",i.collapseMode),h("@.disabled",i.collapseMode),d(),O(i.buttonRows)}}function ua(r,l){if(r&1){let i=k();a(0,"button",10),u("pointerdown",function(){let t=g(i),n=t.$implicit,c=t.$index,m=p().$index,_=p(2);return f(_.onButtonPress(n,m,c))}),b(1,"div",11),a(2,"span",12),s(3),o()()}if(r&2){let i=l.$implicit,e=l.$index,t=p().$index,n=p(2);w("clear-button",i==="C")("is-pressed",n.getButtonState(t,e)==="pressed"),L("aria-label",i==="C"?"Clear input":"Input "+i),d(),h("@buttonGlow",n.getGlowState(t,e)),d(2),v(i)}}function ha(r,l){if(r&1&&(ht(0,8),S(1,ua,4,7,"button",9,pe),gt()),r&2){let i=l.$implicit;d(),O(i)}}function ga(r,l){if(r&1&&(a(0,"div",7),S(1,ha,3,0,"ng-container",8,pe),o()),r&2){let i=p();w("collapse-mode",i.collapseMode),h("@.disabled",i.collapseMode)("ngStyle",me(4,ca,i.getGridTemplateColumns())),d(),O(i.buttonRows)}}var Oi=(()=>{let l=class l{constructor(){this.clear=new z,this.inputChange=new z,this.buttonRows=[],this.collapseMode=!1,this.buttonStates={},this.glowStates={},this.isReducedMotion=!1,this.activeTimeouts=new Set}ngOnInit(){this.isReducedMotion=typeof window.matchMedia=="function"&&window.matchMedia("(prefers-reduced-motion: reduce)").matches}ngOnDestroy(){this.activeTimeouts.forEach(e=>clearTimeout(e)),this.activeTimeouts.clear()}async triggerHaptic(e){try{await Si.impact({style:e})}catch{}}clearTapped(){this.clear.emit(),this.triggerHaptic(jt.Medium)}inputTapped(e){this.inputChange.emit(e),this.triggerHaptic(jt.Light)}get isPillMode(){return this.buttonRows.length>0&&this.buttonRows.every(e=>e.length===2)}getGridTemplateColumns(){var e;return`repeat(${((e=this.buttonRows[0])==null?void 0:e.length)||1}, 1fr)`}getButtonId(e,t){return`btn-${e}-${t}`}getButtonState(e,t){let n=this.getButtonId(e,t);return this.buttonStates[n]||"normal"}getGlowState(e,t){let n=this.getButtonId(e,t);return this.glowStates[n]||"inactive"}onButtonPress(e,t,n){let c=this.getButtonId(t,n);this.buttonStates[c]="pressed",this.glowStates[c]="active";let m=this.isReducedMotion?0:70,_=this.isReducedMotion?0:160,P=setTimeout(()=>{this.buttonStates[c]="normal",this.activeTimeouts.delete(P)},m);this.activeTimeouts.add(P);let y=setTimeout(()=>{this.glowStates[c]="inactive",this.activeTimeouts.delete(y)},_);this.activeTimeouts.add(y),e==="C"?this.clearTapped():this.inputTapped(e)}};l.\u0275fac=function(t){return new(t||l)},l.\u0275cmp=R({type:l,selectors:[["app-calculator-input"]],inputs:{buttonRows:"buttonRows",collapseMode:"collapseMode"},outputs:{clear:"clear",inputChange:"inputChange"},decls:2,vars:1,consts:[[1,"flex","flex-col","gap-2",3,"collapse-mode"],[1,"grid","gap-2",3,"collapse-mode","ngStyle"],[1,"flex","flex-col","gap-2"],[1,"pill-container"],["type","button",1,"pill-button",3,"pill-button-first","pill-button-last","is-pressed"],["type","button",1,"pill-button",3,"pointerdown"],[1,"button-text-sm"],[1,"grid","gap-2",3,"ngStyle"],["ngProjectAs","div.contents",5,["div",8,"contents"]],["type","button",1,"calc-input-key",3,"clear-button","is-pressed"],["type","button",1,"calc-input-key",3,"pointerdown"],[1,"glow-overlay"],[1,"button-text"]],template:function(t,n){t&1&&x(0,pa,3,3,"div",0)(1,ga,3,6,"div",1),t&2&&C(n.isPillMode?0:1)},dependencies:[$,vn],styles:['.calc-input-key[_ngcontent-%COMP%]{cursor:pointer;-webkit-user-select:none;user-select:none;min-height:42px;min-width:42px;position:relative;border-radius:var(--calc-radius-md);border:none;background:transparent;color:var(--calc-text-strong)}.calc-input-key[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;border-radius:inherit;background:var(--calc-surface-raised);box-shadow:inset 0 1px color-mix(in oklab,white 60%,transparent),inset 0 -1px color-mix(in oklab,var(--calc-border-subtle) 70%,transparent);pointer-events:none}.calc-input-key[_ngcontent-%COMP%]:after{content:"";position:absolute;inset:3px;border-radius:calc(var(--calc-radius-md) - 2px);border:1px solid var(--calc-border-strong);background:linear-gradient(to bottom,color-mix(in oklab,var(--calc-surface-raised) 84%,var(--calc-accent) 16%),color-mix(in oklab,var(--calc-surface-2) 80%,var(--calc-accent) 20%));box-shadow:0 1px color-mix(in oklab,white 62%,transparent) inset,0 7px 12px -6px color-mix(in oklab,#0f172a 36%,transparent),0 3px 6px -4px color-mix(in oklab,#0f172a 25%,transparent);transition:transform .12s cubic-bezier(.34,1.56,.64,1),box-shadow .12s cubic-bezier(.34,1.56,.64,1),filter .12s cubic-bezier(.34,1.56,.64,1);pointer-events:none}.calc-input-key.is-pressed[_ngcontent-%COMP%]:after, .calc-input-key[_ngcontent-%COMP%]:active:after{transform:translateY(2px) scale(.97);filter:brightness(.95);box-shadow:0 1px color-mix(in oklab,white 30%,transparent) inset,0 1px 2px color-mix(in oklab,#0f172a 25%,transparent);transition-duration:.06s}.calc-input-key[_ngcontent-%COMP%]   .button-text[_ngcontent-%COMP%]{display:inline-block;position:relative;z-index:1;font-size:1rem;font-weight:400;letter-spacing:.01em;transition:transform .12s cubic-bezier(.34,1.56,.64,1)}.calc-input-key.is-pressed[_ngcontent-%COMP%]   .button-text[_ngcontent-%COMP%], .calc-input-key[_ngcontent-%COMP%]:active   .button-text[_ngcontent-%COMP%]{transform:translateY(2px) scale(.97);transition-duration:.06s}.pill-container[_ngcontent-%COMP%]{display:flex;border-radius:var(--calc-radius-md);overflow:hidden;border:1px solid var(--calc-border-subtle);background:linear-gradient(145deg,color-mix(in oklab,var(--calc-surface-3) 88%,var(--calc-accent) 12%),color-mix(in oklab,var(--calc-surface-raised) 90%,var(--calc-accent) 10%));box-shadow:var(--calc-shadow-sm)}.pill-button[_ngcontent-%COMP%]{cursor:pointer;-webkit-user-select:none;user-select:none;flex:1;min-height:42px;position:relative;overflow:hidden;border:none;background:transparent;color:var(--calc-text-strong);transition:background-color var(--calc-motion-fast) var(--calc-motion-ease)}.pill-button.is-pressed[_ngcontent-%COMP%], .pill-button[_ngcontent-%COMP%]:active{background:color-mix(in oklab,var(--calc-info-bg) 86%,var(--calc-accent) 14%)}.pill-button-first[_ngcontent-%COMP%]{border-right:1px solid var(--calc-border-subtle);border-radius:var(--calc-radius-md) 0 0 var(--calc-radius-md)}.pill-button-last[_ngcontent-%COMP%]{border-radius:0 var(--calc-radius-md) var(--calc-radius-md) 0}.glow-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:radial-gradient(circle,rgba(255,255,255,.36) 0%,rgba(255,255,255,.1) 50%,transparent 100%);border-radius:inherit;pointer-events:none}.collapse-mode[_ngcontent-%COMP%]   .glow-overlay[_ngcontent-%COMP%]{display:none;opacity:0;background:none}.collapse-mode[_ngcontent-%COMP%]   .pill-container[_ngcontent-%COMP%]{box-shadow:none!important;background:linear-gradient(145deg,color-mix(in oklab,var(--calc-surface-3) 88%,var(--calc-accent) 12%),color-mix(in oklab,var(--calc-surface-raised) 90%,var(--calc-accent) 10%))!important;border-color:var(--calc-border-subtle)!important;transition:none!important}.collapse-mode[_ngcontent-%COMP%]   .calc-input-key[_ngcontent-%COMP%]:after{box-shadow:0 1px color-mix(in oklab,white 58%,transparent) inset}.clear-button[_ngcontent-%COMP%]:after{border-color:color-mix(in oklab,var(--calc-danger) 52%,transparent);background:linear-gradient(to bottom,color-mix(in oklab,var(--calc-danger) 32%,var(--calc-surface-3)),color-mix(in oklab,var(--calc-danger) 20%,var(--calc-surface-2)))}.clear-button.is-pressed[_ngcontent-%COMP%]:after, .clear-button[_ngcontent-%COMP%]:active:after{filter:brightness(.88)}.button-text[_ngcontent-%COMP%]{display:inline-block;position:relative;z-index:1;font-size:1rem;font-weight:400;letter-spacing:.01em}.button-text-sm[_ngcontent-%COMP%]{display:inline-block;position:relative;z-index:1;font-size:.8rem;font-weight:400;letter-spacing:.01em}@media (prefers-reduced-motion: reduce){.calc-input-key[_ngcontent-%COMP%]:after{transition:none}.calc-input-key.is-pressed[_ngcontent-%COMP%]:after, .calc-input-key[_ngcontent-%COMP%]:active:after{transform:none}.calc-input-key[_ngcontent-%COMP%]   .button-text[_ngcontent-%COMP%]{transition:none}.calc-input-key.is-pressed[_ngcontent-%COMP%]   .button-text[_ngcontent-%COMP%], .calc-input-key[_ngcontent-%COMP%]:active   .button-text[_ngcontent-%COMP%]{transform:none}}'],data:{animation:[Fe("buttonGlow",[_t("inactive",ue({opacity:0,transform:"scale(0)"})),_t("active",ue({opacity:.18,transform:"scale(1.8)"})),we("inactive => active",ke("85ms ease-out")),we("active => inactive",ke("120ms ease-out"))])]}});let r=l;return r})();function fa(r,l){if(r&1){let i=k();a(0,"div",18)(1,"ion-button",20),u("click",function(){g(i);let t=p();return f(t.onClearAdjustment())}),s(2," Remove "),o(),a(3,"ion-button",21),u("click",function(){g(i);let t=p();return f(t.applyAdjustment())}),s(4," Apply "),o()()}if(r&2){let i=p();d(3),h("disabled",i.applyDisabled())}}function _a(r,l){if(r&1){let i=k();a(0,"div",19)(1,"ion-button",21),u("click",function(){g(i);let t=p();return f(t.applyAdjustment())}),s(2," Apply "),o()()}if(r&2){let i=p();d(),h("disabled",i.applyDisabled())}}var Ei=(()=>{let l=class l{constructor(){this.modalCtrl=A(q),this.toastCtrl=A(Pe),this.store=A(be),this.heatAdjustment=this.store.selectSignal(Vt),this.temperature="",this.dewPoint="",this.temperatureType="c",this.isReverseCalculation=!1,this.applyDisabled=D(!0),this.hasAppliedAdjustment=D(!1),this.hasShownHighHeatToast=!1,this.limits={c:{temperature:{min:-40,max:55},dewPoint:{min:-40,max:35}},f:{temperature:{min:-40,max:130},dewPoint:{min:-40,max:95}}},W({arrowBackOutline:X,openOutline:Tt})}fToC(e){return((e-32)*5/9).toFixed(1).replace(/\.0$/,"")}cToF(e){return(e*9/5+32).toFixed(1).replace(/\.0$/,"")}ngAfterViewInit(){this.temperature=this.normalizeNumericInput(this.heatAdjustment().temperature),this.dewPoint=this.normalizeNumericInput(this.heatAdjustment().dewPoint),this.temperatureType=this.heatAdjustment().temperatureType,this.isReverseCalculation=this.heatAdjustment().direction==="reverse",this.hasAppliedAdjustment.set(this.temperature.trim().length>0&&this.dewPoint.trim().length>0),this.checkInput()}dismiss(){this.modalCtrl.dismiss()}applyAdjustment(){this.modalCtrl.dismiss({temperatureType:this.temperatureType,temperature:this.temperature,dewPoint:this.dewPoint,direction:this.isReverseCalculation?"reverse":"forward"})}onClearAdjustment(){this.modalCtrl.dismiss({temperatureType:this.temperatureType,temperature:"",dewPoint:"",direction:this.isReverseCalculation?"reverse":"forward"})}temperatureTypeChanged(e){this.temperatureType=e.detail.value,this.temperatureType==="f"?(this.temperature=this.convertMetricIfPresent(this.temperature,t=>this.cToF(t)),this.dewPoint=this.convertMetricIfPresent(this.dewPoint,t=>this.cToF(t))):(this.temperature=this.convertMetricIfPresent(this.temperature,t=>this.fToC(t)),this.dewPoint=this.convertMetricIfPresent(this.dewPoint,t=>this.fToC(t))),this.checkInput()}onTemperatureInput(e){let t=this.clampFieldValue(this.readInputValue(e),this.temperatureMin(),this.temperatureMax());this.temperature=t,this.writeInputValue(e,t),this.checkInput()}onDewPointInput(e){let t=this.clampFieldValue(this.readInputValue(e),this.dewPointMin(),this.dewPointMax());this.dewPoint=t,this.writeInputValue(e,t),this.checkInput()}async checkInput(){this.temperature=this.clampFieldValue(this.temperature,this.temperatureMin(),this.temperatureMax()),this.dewPoint=this.clampFieldValue(this.dewPoint,this.dewPointMin(),this.dewPointMax());let e=Number(this.temperature),t=Number(this.dewPoint),n=this.temperature.trim().length>0&&Number.isFinite(e),c=this.dewPoint.trim().length>0&&Number.isFinite(t);if(!n||!c){this.applyDisabled.set(!0),this.hasShownHighHeatToast=!1;return}let m=this.temperatureType==="f"?e:e*9/5+32,_=this.temperatureType==="f"?t:t*9/5+32,P=m+_>180;if(this.applyDisabled.set(P),!P){this.hasShownHighHeatToast=!1;return}this.hasShownHighHeatToast||(this.hasShownHighHeatToast=!0,(await this.toastCtrl.create({message:"Heat Index is too high, running not recommended",duration:5e3,color:"danger",position:"top"})).present())}temperatureMin(){return this.temperatureType==="f"?this.limits.f.temperature.min:this.limits.c.temperature.min}temperatureMax(){return this.temperatureType==="f"?this.limits.f.temperature.max:this.limits.c.temperature.max}dewPointMin(){return this.temperatureType==="f"?this.limits.f.dewPoint.min:this.limits.c.dewPoint.min}dewPointMax(){return this.temperatureType==="f"?this.limits.f.dewPoint.max:this.limits.c.dewPoint.max}convertMetricIfPresent(e,t){let n=this.normalizeNumericInput(e);if(n.length===0)return"";let c=Number(n);return Number.isFinite(c)?t(c):""}clampFieldValue(e,t,n){let c=this.normalizeNumericInput(e);if(c.length===0)return"";let m=Number(c);if(!Number.isFinite(m))return"";let _=Math.min(n,Math.max(t,m));return Number.isInteger(_)?String(_):String(Math.round(_*10)/10)}normalizeNumericInput(e){return typeof e=="number"?Number.isFinite(e)?String(e):"":typeof e=="string"?e.trim():""}readInputValue(e){var n,c;let t=(n=e.detail)==null?void 0:n.value;return t!==void 0?t:(c=e.target)==null?void 0:c.value}writeInputValue(e,t){let n=e.target;n&&(n.value=t)}};l.\u0275fac=function(t){return new(t||l)},l.\u0275cmp=R({type:l,selectors:[["app-heat-adjustment-modal"]],decls:27,vars:9,consts:[[1,"heat-header","safe-area-inline"],[1,"heat-toolbar"],["slot","start"],["aria-label","Back to calculator","fill","clear",1,"heat-back-btn",3,"click"],["slot","icon-only","name","arrow-back-outline"],[1,"ion-padding","safe-area-content"],[1,"mx-auto","flex","max-w-md","flex-col","gap-4","py-4","mobile-bottom-safe"],[1,"calc-surface-card","mx-3","flex","flex-col","gap-4","px-3","py-3"],["href","https://maximumperformancerunning.blogspot.com/2013/07/temperature-dew-point.html","target","_blank","rel","noopener noreferrer",1,"external-link"],["name","open-outline",1,"external-link-icon"],["mode","ios",1,"app-segment",3,"ionChange","value"],["value","c"],["value","f"],["required","","mode","md","label","Temperature","label-placement","stacked","type","number","inputmode","decimal","fill","outline",3,"ngModelChange","ionInput","ngModel","min","max"],["required","","mode","md","label","Dew Point","label-placement","stacked","type","number","inputmode","decimal","fill","outline",3,"ngModelChange","ionInput","ngModel","min","max"],[1,"heat-mode-row","rounded-xl","px-3","py-2"],["mode","md","labelPlacement","end",1,"heat-mode-checkbox",3,"ngModelChange","ngModel"],[1,"calc-muted-copy","mt-1","text-xs"],[1,"heat-actions","mb-1","mt-1","grid","grid-cols-2","gap-3"],[1,"heat-actions","mb-1","mt-1"],["fill","outline",1,"heat-action-btn","heat-remove-btn","w-full",3,"click"],["fill","solid",1,"heat-action-btn","heat-apply-btn","w-full",3,"click","disabled"]],template:function(t,n){t&1&&(a(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-button",3),u("click",function(){return n.dismiss()}),b(4,"ion-icon",4),o()(),a(5,"ion-title"),s(6,"Apply heat adjustment"),o()()(),a(7,"ion-content",5)(8,"div",6)(9,"div",7)(10,"a",8),s(11," How does this work? "),b(12,"ion-icon",9),o(),a(13,"ion-segment",10),u("ionChange",function(m){return n.temperatureTypeChanged(m)}),a(14,"ion-segment-button",11),s(15," Celsius "),o(),a(16,"ion-segment-button",12),s(17," Fahrenheit "),o()(),a(18,"ion-input",13),De("ngModelChange",function(m){return Ee(n.temperature,m)||(n.temperature=m),m}),u("ionInput",function(m){return n.onTemperatureInput(m)}),o(),a(19,"ion-input",14),De("ngModelChange",function(m){return Ee(n.dewPoint,m)||(n.dewPoint=m),m}),u("ionInput",function(m){return n.onDewPointInput(m)}),o(),a(20,"div",15)(21,"ion-checkbox",16),De("ngModelChange",function(m){return Ee(n.isReverseCalculation,m)||(n.isReverseCalculation=m),m}),s(22," Reverse calculation "),o(),a(23,"p",17),s(24," Use this when the time you enter is your actual hot-weather result. "),o()(),x(25,fa,5,1,"div",18)(26,_a,3,1,"div",19),o()()()),t&2&&(d(13),h("value",n.temperatureType),d(5),Ie("ngModel",n.temperature),h("min",n.temperatureMin())("max",n.temperatureMax()),d(),Ie("ngModel",n.dewPoint),h("min",n.dewPointMin())("max",n.dewPointMax()),d(2),Ie("ngModel",n.isReverseCalculation),d(4),C(n.hasAppliedAdjustment()?25:26))},dependencies:[$,re,ce,se,oe,K,Z,Q,ge,$e,kn,Le,Y,fe,H,In],styles:[".heat-header[_ngcontent-%COMP%]{border-bottom:1px solid color-mix(in oklab,var(--calc-border-subtle) 80%,transparent)}.heat-toolbar[_ngcontent-%COMP%]{--background: color-mix(in oklab, var(--calc-surface-raised) 86%, var(--calc-accent) 14%);--color: var(--calc-text-strong)}.heat-back-btn[_ngcontent-%COMP%]{--color: var(--calc-text-strong)}.external-link[_ngcontent-%COMP%]{color:var(--calc-link);display:inline-flex;align-items:center;gap:.35rem;text-decoration:underline;text-underline-offset:2px;width:fit-content}.external-link-icon[_ngcontent-%COMP%]{font-size:.95rem;opacity:.9}ion-input[_ngcontent-%COMP%]{--border-color: color-mix(in oklab, var(--calc-text-muted) 40%, transparent);--highlight-color-focused: var(--calc-accent-strong);--highlight-color-valid: var(--calc-accent-strong);--color: var(--calc-text-strong)}.heat-action-btn[_ngcontent-%COMP%]{--text-transform: none;text-transform:none;min-height:44px}.heat-mode-row[_ngcontent-%COMP%]{border:1px solid color-mix(in oklab,var(--calc-border-subtle) 82%,transparent);background:color-mix(in oklab,var(--calc-surface-raised) 88%,transparent)}.heat-mode-checkbox[_ngcontent-%COMP%]{--size: 1.15rem;--checkmark-width: 2px;--checkbox-background-checked: var(--calc-accent-strong);--border-color-checked: var(--calc-accent-strong);--color: var(--calc-text-strong)}.heat-remove-btn[_ngcontent-%COMP%]{--color: var(--calc-text-strong);--border-color: var(--calc-border-strong);--border-radius: var(--calc-radius-md);--background: transparent}.heat-apply-btn[_ngcontent-%COMP%]{--color: #ffffff;--background: var(--calc-accent-strong);--background-hover: color-mix(in oklab, var(--calc-accent-strong) 88%, black);--background-activated: color-mix(in oklab, var(--calc-accent-strong) 82%, black);--border-radius: var(--calc-radius-md)}.heat-action-btn[_ngcontent-%COMP%]::part(native){text-transform:none;letter-spacing:normal}"]});let r=l;return r})();var Zt=_e("Share",{web:()=>import("./chunk-7RW3IWG3.js").then(r=>new r.ShareWeb)});var st="HAS_SEEN_ONBOARDING_v2";var ba=["scrollContainer"];function xa(r,l){if(r&1&&b(0,"div",24),r&2){let i=l.index,e=p();w("w-6",e.currentSlide===i)("onboarding-dot-active",e.currentSlide===i)("w-2",e.currentSlide!==i)("onboarding-dot-idle",e.currentSlide!==i)}}function Ca(r,l){if(r&1){let i=k();a(0,"div",25)(1,"ion-button",26),u("click",function(){g(i);let t=p();return f(t.dismiss())}),s(2," Skip "),o(),a(3,"ion-button",27),u("click",function(){g(i);let t=p();return f(t.nextSlide())}),s(4," Next "),b(5,"ion-icon",28),o()()}}function va(r,l){if(r&1){let i=k();a(0,"div",29)(1,"ion-button",30),u("click",function(){g(i);let t=p();return f(t.finish())}),s(2," Let's Go "),b(3,"ion-icon",28),o()()}}var Bt=(()=>{let l=class l{get tutorialHeroSrc(){let e=document.documentElement.dataset.theme;return e==="dark"?"assets/tutorial_dark.svg":e==="light"?"assets/tutorial.svg":this.darkModeMediaQuery.matches?"assets/tutorial_dark.svg":"assets/tutorial.svg"}constructor(){this.modalCtrl=A(q),this.darkModeMediaQuery=window.matchMedia("(prefers-color-scheme: dark)"),this.scrollSettleDelayMs=120,this.slides=[0,1,2,3],this.currentSlide=0,W({calculatorOutline:kt,pinOutline:Mt,flameOutline:Nn,shieldCheckmark:St,arrowForwardOutline:Rn})}onScroll(e){let t=e.target;if(!t.clientWidth)return;let n=this.getNearestSlideIndex(t);n!==this.currentSlide&&(this.currentSlide=n),this.scheduleScrollSettle(t)}nextSlide(){if(this.currentSlide<this.slides.length-1){let e=this.scrollContainer.nativeElement,t=(this.currentSlide+1)*e.clientWidth;e.scrollTo({left:t,behavior:"smooth"})}}async finish(){await Te.set({key:st,value:"true"}),this.modalCtrl.dismiss()}async dismiss(){await Te.set({key:st,value:"true"}),this.modalCtrl.dismiss()}ngOnDestroy(){this.clearScrollSettleTimeout()}scheduleScrollSettle(e){this.clearScrollSettleTimeout(),this.scrollSettleTimeout=setTimeout(()=>{this.settleScroll(e)},this.scrollSettleDelayMs)}settleScroll(e){if(!e.clientWidth)return;let t=this.getNearestSlideIndex(e),n=t*e.clientWidth;this.currentSlide=t,Math.abs(e.scrollLeft-n)>1&&e.scrollTo({left:n,behavior:"smooth"})}getNearestSlideIndex(e){return Math.min(Math.max(Math.round(e.scrollLeft/e.clientWidth),0),this.slides.length-1)}clearScrollSettleTimeout(){this.scrollSettleTimeout&&(clearTimeout(this.scrollSettleTimeout),this.scrollSettleTimeout=void 0)}};l.\u0275fac=function(t){return new(t||l)},l.\u0275cmp=R({type:l,selectors:[["app-onboarding-modal"]],viewQuery:function(t,n){if(t&1&&Me(ba,5),t&2){let c;Se(c=Oe())&&(n.scrollContainer=c.first)}},decls:46,vars:4,consts:[["scrollContainer",""],["scroll-y","false",1,"ion-padding","safe-area-content"],[1,"flex","h-full","flex-col"],[1,"hide-scrollbar","flex","min-h-0","flex-1","snap-x","snap-mandatory","overflow-x-auto","scroll-smooth","transition-all",3,"scroll"],[1,"onboarding-slide","onboarding-slide-info","flex","w-full","shrink-0","snap-center","flex-col","items-center","justify-center","px-6"],[1,"onboarding-hero-shell","mb-8","w-full"],["alt","Interactive tutorial preview","loading","eager",1,"onboarding-hero-image",3,"src"],[1,"mb-4","text-center","text-2xl","font-bold","text-[var(--calc-text-strong)]"],[1,"calc-muted-copy","text-center"],[1,"text-[var(--calc-text-strong)]"],[1,"onboarding-slide","onboarding-slide-success","flex","w-full","shrink-0","snap-center","flex-col","items-center","justify-center","px-6"],[1,"onboarding-icon-shell","onboarding-icon-shell-success","mb-10","flex","h-32","w-32","items-center","justify-center","rounded-full"],["name","calculator-outline",1,"onboarding-icon","text-6xl"],[1,"onboarding-slide","onboarding-slide-warning","flex","w-full","shrink-0","snap-center","flex-col","items-center","justify-center","px-6"],[1,"onboarding-icon-shell","onboarding-icon-shell-warning","mb-10","flex","h-32","w-32","items-center","justify-center","rounded-full"],["name","flame-outline",1,"onboarding-icon","text-6xl"],[1,"onboarding-slide","onboarding-slide-privacy","flex","w-full","shrink-0","snap-center","flex-col","items-center","justify-center","px-6"],[1,"onboarding-icon-shell","onboarding-icon-shell-privacy","mb-10","flex","h-32","w-32","items-center","justify-center","rounded-full"],["name","shield-checkmark",1,"onboarding-icon","text-6xl"],[1,"onboarding-controls","mt-auto","px-4","pt-4"],[1,"mb-8","flex","justify-center","gap-2"],["class","onboarding-dot h-2 rounded-full transition-all duration-300",3,"w-6","onboarding-dot-active","w-2","onboarding-dot-idle",4,"ngFor","ngForOf"],["class","flex items-center justify-between max-w-5xl mx-auto",4,"ngIf"],["class","flex w-full items-center justify-center max-w-5xl mx-auto",4,"ngIf"],[1,"onboarding-dot","h-2","rounded-full","transition-all","duration-300"],[1,"flex","items-center","justify-between","max-w-5xl","mx-auto"],["fill","clear","color","medium",3,"click"],["shape","round",1,"app-primary-button",3,"click"],["slot","end","name","arrow-forward-outline"],[1,"flex","w-full","items-center","justify-center","max-w-5xl","mx-auto"],["shape","round",1,"w-full","app-primary-button",3,"click"]],template:function(t,n){if(t&1){let c=k();a(0,"ion-content",1)(1,"div",2)(2,"div",3,0),u("scroll",function(_){return g(c),f(n.onScroll(_))}),a(4,"div",4)(5,"div",5),b(6,"img",6),o(),a(7,"h2",7),s(8,"Pace, Time, Distance"),o(),a(9,"p",8),s(10," Enter any two values. "),a(11,"strong",9),s(12,"Pin"),o(),s(13," the one you want fixed, then edit another value and Stridemate calculates the third instantly. "),o()(),a(14,"div",10)(15,"div",11),b(16,"ion-icon",12),o(),a(17,"h2",7),s(18,"Predict & Strategize"),o(),a(19,"p",8),s(20," Use the "),a(21,"strong",9),s(22,"Race Predictor"),o(),s(23," to estimate finish times for distances up to 100mi, and generate detailed split tables. "),o()(),a(24,"div",13)(25,"div",14),b(26,"ion-icon",15),o(),a(27,"h2",7),s(28,"Advanced Pacing"),o(),a(29,"p",8),s(30," Adjust expected pace based on "),a(31,"strong",9),s(32,"Heat and Humidity"),o(),s(33,", or use the pacing slider to model perfect negative splits. "),o()(),a(34,"div",16)(35,"div",17),b(36,"ion-icon",18),o(),a(37,"h2",7),s(38,"100% Offline & Private"),o(),a(39,"p",8),s(40," No accounts. No ads. No tracking. Your data stays completely on your device. Let's start running. "),o()()(),a(41,"div",19)(42,"div",20),x(43,xa,1,8,"div",21),o(),x(44,Ca,6,0,"div",22)(45,va,4,0,"div",23),o()()()}t&2&&(d(6),h("src",n.tutorialHeroSrc,pt),d(37),h("ngForOf",n.slides),d(),h("ngIf",n.currentSlide<n.slides.length-1),d(),h("ngIf",n.currentSlide===n.slides.length-1))},dependencies:[$,ft,Be,K,Y,H],styles:[".hide-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.hide-scrollbar[_ngcontent-%COMP%]{-ms-overflow-style:none;scrollbar-width:none}.onboarding-icon-shell[_ngcontent-%COMP%]{border:1px solid var(--calc-border-subtle);box-shadow:var(--calc-shadow-sm)}.onboarding-hero-shell[_ngcontent-%COMP%]{max-width:360px;border-radius:18px;padding:.35rem;border:1px solid color-mix(in oklab,var(--calc-border-subtle) 74%,transparent);background:linear-gradient(150deg,color-mix(in oklab,var(--calc-info-bg) 52%,var(--calc-surface-raised)),color-mix(in oklab,var(--calc-surface-1) 86%,white 14%));box-shadow:var(--calc-shadow-sm)}.onboarding-hero-image[_ngcontent-%COMP%]{width:100%;height:auto;display:block;border-radius:14px;border:1px solid color-mix(in oklab,var(--calc-border-subtle) 58%,transparent)}.onboarding-icon[_ngcontent-%COMP%]{color:var(--calc-accent-strong)}.onboarding-slide[_ngcontent-%COMP%]{margin-inline:auto;max-width:420px;border-radius:var(--calc-radius-lg);border:1px solid color-mix(in oklab,var(--calc-border-subtle) 80%,transparent);box-shadow:var(--calc-shadow-sm);padding-top:1.4rem;padding-bottom:1.4rem;scroll-snap-stop:always}@media (min-width: 600px){.onboarding-slide[_ngcontent-%COMP%]{width:100%;min-width:100%;max-width:none;margin-inline:0}}.onboarding-slide-info[_ngcontent-%COMP%]{background:linear-gradient(150deg,color-mix(in oklab,var(--calc-info-bg) 84%,#dbeafe 16%),color-mix(in oklab,var(--calc-surface-1) 90%,white 10%))}.onboarding-slide-success[_ngcontent-%COMP%]{background:linear-gradient(150deg,color-mix(in oklab,var(--calc-success-bg) 84%,#dcfce7 16%),color-mix(in oklab,var(--calc-surface-1) 90%,white 10%))}.onboarding-slide-warning[_ngcontent-%COMP%]{background:linear-gradient(150deg,color-mix(in oklab,var(--calc-warning-bg) 84%,#ffedd5 16%),color-mix(in oklab,var(--calc-surface-1) 90%,white 10%))}.onboarding-slide-privacy[_ngcontent-%COMP%]{background:linear-gradient(150deg,color-mix(in oklab,var(--calc-privacy-bg) 84%,#ede9fe 16%),color-mix(in oklab,var(--calc-surface-1) 90%,white 10%))}.onboarding-icon-shell-info[_ngcontent-%COMP%]{background:linear-gradient(160deg,color-mix(in oklab,var(--calc-info-bg) 76%,#bfdbfe 24%),color-mix(in oklab,var(--calc-surface-raised) 90%,#dbeafe 10%))}.onboarding-icon-shell-success[_ngcontent-%COMP%]{background:linear-gradient(160deg,color-mix(in oklab,var(--calc-success-bg) 78%,#86efac 22%),color-mix(in oklab,var(--calc-surface-raised) 90%,#dcfce7 10%))}.onboarding-icon-shell-warning[_ngcontent-%COMP%]{background:linear-gradient(160deg,color-mix(in oklab,var(--calc-warning-bg) 78%,#fdba74 22%),color-mix(in oklab,var(--calc-surface-raised) 90%,#ffedd5 10%))}.onboarding-icon-shell-privacy[_ngcontent-%COMP%]{background:linear-gradient(160deg,color-mix(in oklab,var(--calc-privacy-bg) 78%,#c4b5fd 22%),color-mix(in oklab,var(--calc-surface-raised) 90%,#ede9fe 10%))}.onboarding-dot-active[_ngcontent-%COMP%]{background:var(--calc-accent)}.onboarding-dot-idle[_ngcontent-%COMP%]{background:color-mix(in oklab,var(--calc-text-muted) 24%,transparent)}.onboarding-controls[_ngcontent-%COMP%]{padding-bottom:calc(2rem + var(--ion-safe-area-bottom, 0px));padding-bottom:calc(2rem + max(var(--ion-safe-area-bottom, 0px),env(safe-area-inset-bottom,0px)))}.dark[_nghost-%COMP%]   .onboarding-hero-shell[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .onboarding-hero-shell[_ngcontent-%COMP%]{border-color:color-mix(in oklab,#60a5fa 34%,transparent);background:linear-gradient(150deg,color-mix(in oklab,var(--calc-info-bg) 72%,#1d4ed8 28%),color-mix(in oklab,var(--calc-surface-2) 86%,#0f172a 14%))}.dark[_nghost-%COMP%]   .onboarding-slide[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .onboarding-slide[_ngcontent-%COMP%]{border-color:color-mix(in oklab,var(--calc-accent) 36%,transparent)}.dark[_nghost-%COMP%]   .onboarding-slide-info[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .onboarding-slide-info[_ngcontent-%COMP%]{background:linear-gradient(150deg,color-mix(in oklab,var(--calc-info-bg) 74%,#1d4ed8 26%),color-mix(in oklab,var(--calc-surface-2) 86%,#0f172a 14%));box-shadow:0 10px 24px color-mix(in oklab,#2563eb 20%,transparent)}.dark[_nghost-%COMP%]   .onboarding-slide-success[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .onboarding-slide-success[_ngcontent-%COMP%]{background:linear-gradient(150deg,color-mix(in oklab,var(--calc-success-bg) 76%,#059669 24%),color-mix(in oklab,var(--calc-surface-2) 86%,#0f172a 14%));box-shadow:0 10px 24px color-mix(in oklab,#059669 20%,transparent)}.dark[_nghost-%COMP%]   .onboarding-slide-warning[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .onboarding-slide-warning[_ngcontent-%COMP%]{background:linear-gradient(150deg,color-mix(in oklab,var(--calc-warning-bg) 76%,#ea580c 24%),color-mix(in oklab,var(--calc-surface-2) 86%,#0f172a 14%));box-shadow:0 10px 24px color-mix(in oklab,#ea580c 20%,transparent)}.dark[_nghost-%COMP%]   .onboarding-slide-privacy[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .onboarding-slide-privacy[_ngcontent-%COMP%]{background:linear-gradient(150deg,color-mix(in oklab,var(--calc-privacy-bg) 76%,#7c3aed 24%),color-mix(in oklab,var(--calc-surface-2) 86%,#0f172a 14%));box-shadow:0 10px 24px color-mix(in oklab,#7c3aed 20%,transparent)}.dark[_nghost-%COMP%]   .onboarding-icon-shell-info[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .onboarding-icon-shell-info[_ngcontent-%COMP%]{border-color:color-mix(in oklab,#60a5fa 48%,transparent);background:linear-gradient(160deg,color-mix(in oklab,var(--calc-info-bg) 74%,#2563eb 26%),color-mix(in oklab,var(--calc-surface-2) 84%,#0f172a 16%))}.dark[_nghost-%COMP%]   .onboarding-icon-shell-success[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .onboarding-icon-shell-success[_ngcontent-%COMP%]{border-color:color-mix(in oklab,#34d399 44%,transparent);background:linear-gradient(160deg,color-mix(in oklab,var(--calc-success-bg) 74%,#059669 26%),color-mix(in oklab,var(--calc-surface-2) 84%,#0f172a 16%))}.dark[_nghost-%COMP%]   .onboarding-icon-shell-warning[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .onboarding-icon-shell-warning[_ngcontent-%COMP%]{border-color:color-mix(in oklab,#fb923c 44%,transparent);background:linear-gradient(160deg,color-mix(in oklab,var(--calc-warning-bg) 74%,#ea580c 26%),color-mix(in oklab,var(--calc-surface-2) 84%,#0f172a 16%))}.dark[_nghost-%COMP%]   .onboarding-icon-shell-privacy[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .onboarding-icon-shell-privacy[_ngcontent-%COMP%]{border-color:color-mix(in oklab,#a78bfa 44%,transparent);background:linear-gradient(160deg,color-mix(in oklab,var(--calc-privacy-bg) 74%,#7c3aed 26%),color-mix(in oklab,var(--calc-surface-2) 84%,#0f172a 16%))}.dark[_nghost-%COMP%]   .onboarding-dot-idle[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .onboarding-dot-idle[_ngcontent-%COMP%]{background:color-mix(in oklab,var(--calc-text-muted) 42%,transparent)}"]});let r=l;return r})();function ya(r,l){if(r&1){let i=k();a(0,"button",40),u("click",function(){let t=g(i).$implicit,n=p();return f(n.onAccentChange(t.id))}),b(1,"span",41),a(2,"span",21),s(3),o()()}if(r&2){let i=l.$implicit,e=p();w("accent-preset-btn-active",e.appAccent()===i.id),d(),ut("background",i.light.accent),d(2),v(i.label)}}function ka(r,l){r&1&&(a(0,"p",37),s(1," On iPhone or iPad in Safari, tap the Share button, then tap Add to Home Screen. "),o())}function wa(r,l){r&1&&(a(0,"p",37),s(1," In Chrome on Android, open the menu (three dots), then tap Install app or Add to Home screen. "),o())}function Pa(r,l){r&1&&(a(0,"p",37),s(1," Open Stridemate on your phone browser, then use the browser menu to install or add it to your home screen. "),o())}function Ta(r,l){if(r&1&&(a(0,"div",11)(1,"ion-label",12),s(2,"Install as App (PWA)"),o(),x(3,ka,2,0,"p",37)(4,wa,2,0,"p",37)(5,Pa,2,0,"p",37),o()),r&2){let i=p();d(3),C(i.pwaInstallPlatform==="ios"?3:i.pwaInstallPlatform==="android"?4:5)}}var Di=(()=>{let l=class l{constructor(){this.store=A(be),this.modalCtrl=A(q),this.isNativePlatform=Ue.isNativePlatform(),this.isAndroid=Ue.getPlatform()==="android",this.websiteUrl="https://shiv19.com/stridemate",this.playStoreUrl="https://play.google.com/store/apps/details?id=com.shiv19.stridemate",this.accentPresets=Xn,this.rateAppUrl=this.isAndroid?this.playStoreUrl:this.websiteUrl,this.shareAppUrl=this.isAndroid?this.playStoreUrl:this.websiteUrl,this.showPwaInstallInstructions=!this.isNativePlatform,this.pwaInstallPlatform=this.detectWebInstallPlatform(),this.appTheme=this.store.selectSignal(Dt),this.appAccent=this.store.selectSignal(Rt),W({heart:wt,shieldCheckmark:St,mailOutline:Un,playCircleOutline:Gn,arrowBackOutline:X,informationCircleOutline:Pt,shareSocialOutline:Qn,starOutline:Zn})}async showLockInfo(){this.dismiss(),await(await this.modalCtrl.create({component:Mi,componentProps:{lockType:"all"},initialBreakpoint:.8,breakpoints:[.8,1]})).present()}async replayTutorial(){this.dismiss(),await(await this.modalCtrl.create({component:Bt,cssClass:"onboarding-fullscreen-modal"})).present()}dismiss(){this.modalCtrl.dismiss()}async shareApp(){let e={title:"Stridemate",text:"Check out Stridemate, a fast offline pace calculator for runners.",url:this.shareAppUrl,dialogTitle:"Share Stridemate"};try{let{value:t}=await Zt.canShare();if(t){await Zt.share(e);return}}catch{}window.open(`mailto:?subject=${encodeURIComponent("Stridemate")}&body=${encodeURIComponent(`Check out Stridemate: ${this.shareAppUrl}`)}`,"_blank")}onThemeChange(e){let t=e.detail.value;t&&this.store.dispatch(M.setAppTheme({appTheme:t}))}onAccentChange(e){this.store.dispatch(M.setAppAccent({appAccent:e}))}trackAccent(e,t){return t.id}detectWebInstallPlatform(){var m,_,P;let e=((m=globalThis.navigator)==null?void 0:m.userAgent)??"",t=((_=globalThis.navigator)==null?void 0:_.platform)??"",n=((P=globalThis.navigator)==null?void 0:P.maxTouchPoints)??0;return/iPad|iPhone|iPod/i.test(e)||t==="MacIntel"&&Number(n)>1?"ios":/Android/i.test(e)?"android":"other"}};l.\u0275fac=function(t){return new(t||l)},l.\u0275cmp=R({type:l,selectors:[["app-about-modal"]],decls:80,vars:5,consts:[[1,"about-header","safe-area-inline"],[1,"about-toolbar"],["slot","start"],["aria-label","Back to calculator","fill","clear",1,"about-back-btn",3,"click"],["slot","icon-only","name","arrow-back-outline"],[1,"ion-padding","safe-area-content"],[1,"mx-auto","flex","max-w-md","flex-col","gap-6","py-4","mobile-bottom-safe"],[1,"text-center"],[1,"text-2xl","font-bold"],[1,"calc-muted-copy","text-sm"],[1,"flex","flex-col","gap-3"],[1,"calc-shell-subtle","mx-4","rounded-lg","p-3"],[1,"calc-muted-copy","mb-2","block","text-sm","font-semibold"],["mode","ios",1,"app-segment",3,"ionChange","value"],["value","system"],["value","light"],["value","dark"],[1,"grid","grid-cols-2","gap-2"],["type","button","class","accent-preset-btn",3,"accent-preset-btn-active","click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"calc-cta-secondary","mx-4","flex","items-center","justify-center","gap-2","p-3","transition-opacity","active:opacity-80",3,"click"],["name","information-circle-outline",1,"text-xl"],[1,"font-semibold"],["name","play-circle-outline",1,"text-xl"],["href","https://ko-fi.com/shiv19","target","_blank","rel","noopener noreferrer",1,"mx-4","flex","items-center","justify-center","gap-2","rounded-lg","bg-[#FF5E5B]","p-3","text-white","transition-opacity","active:opacity-80"],["name","heart"],[1,"mx-4","grid","grid-cols-2","gap-2"],["target","_blank","rel","noopener noreferrer",1,"calc-cta-secondary","flex","items-center","justify-center","gap-2","p-3","text-center","transition-opacity","active:opacity-80",3,"href"],["name","star-outline"],["type","button",1,"calc-cta-secondary","flex","items-center","justify-center","gap-2","p-3","text-center","transition-opacity","active:opacity-80",3,"click"],["name","share-social-outline"],[1,"mx-4","flex","flex-col","gap-2"],["href","mailto:sp@shiv19.com?subject=Stridemate%20Feedback",1,"calc-cta-secondary","flex","items-center","justify-center","gap-2","p-3","transition-opacity","active:opacity-80"],["name","mail-outline"],["href","https://shiv19.com/stridemate/privacy","target","_blank","rel","noopener noreferrer",1,"calc-cta-secondary","flex","items-center","justify-center","gap-2","p-3","transition-opacity","active:opacity-80"],["name","shield-checkmark"],[1,"calc-shell-subtle","mx-4","rounded-lg","p-4"],[1,"mb-3","text-sm","leading-relaxed"],[1,"text-sm","leading-relaxed"],["name","heart",1,"text-red-500"],["href","https://shiv19.com","target","_blank",1,"calc-link-action"],["type","button",1,"accent-preset-btn",3,"click"],[1,"accent-preset-dot"]],template:function(t,n){t&1&&(a(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-button",3),u("click",function(){return n.dismiss()}),b(4,"ion-icon",4),o()(),a(5,"ion-title"),s(6,"About"),o()()(),a(7,"ion-content",5)(8,"div",6)(9,"div",7)(10,"h1",8),s(11,"Stridemate"),o(),a(12,"p",9),s(13,"Version 1.2.3"),o()(),a(14,"div",10)(15,"div",11)(16,"ion-label",12),s(17,"Theme"),o(),a(18,"ion-segment",13),u("ionChange",function(m){return n.onThemeChange(m)}),a(19,"ion-segment-button",14)(20,"ion-label"),s(21,"System"),o()(),a(22,"ion-segment-button",15)(23,"ion-label"),s(24,"Light"),o()(),a(25,"ion-segment-button",16)(26,"ion-label"),s(27,"Dark"),o()()()(),a(28,"div",11)(29,"ion-label",12),s(30,"Accent"),o(),a(31,"div",17),x(32,ya,4,5,"button",18),o()(),a(33,"button",19),u("click",function(){return n.showLockInfo()}),b(34,"ion-icon",20),a(35,"span",21),s(36,"How Pinning Works"),o()(),a(37,"button",19),u("click",function(){return n.replayTutorial()}),b(38,"ion-icon",22),a(39,"span",21),s(40,"Replay Tutorial"),o()(),x(41,Ta,6,1,"div",11),a(42,"a",23),b(43,"ion-icon",24),a(44,"span",21),s(45,"Support on Ko-fi"),o()(),a(46,"div",25)(47,"a",26),b(48,"ion-icon",27),a(49,"span",21),s(50,"Rate App"),o()(),a(51,"button",28),u("click",function(){return n.shareApp()}),b(52,"ion-icon",29),a(53,"span",21),s(54,"Share App"),o()()()(),a(55,"div",30)(56,"a",31),b(57,"ion-icon",32),a(58,"span",21),s(59,"Send Feedback"),o()(),a(60,"a",33),b(61,"ion-icon",34),a(62,"span",21),s(63,"Privacy Policy"),o()()(),a(64,"div",35)(65,"p",36),s(66," I built Stridemate before the era of AI assistants."),b(67,"br"),s(68," As a runner, I was frustrated with existing pace calculators - they all required too many taps to do simple conversions. "),o(),a(69,"p",36),s(70," I wanted something that would let me instantly switch between km and mile paces, calculate splits, and adjust for heat - all without fighting with a tiny keyboard. "),o(),a(71,"p",37),s(72," This app solves my own problem, and I hope it helps you too. It's completely free, works offline, and respects your privacy - no tracking, no ads, no data collection. "),o()(),a(73,"div",7)(74,"p",9),s(75," Made with "),b(76,"ion-icon",38),s(77," by "),a(78,"a",39),s(79," Shiva Prasad "),o()()()()()),t&2&&(d(18),h("value",n.appTheme()),d(14),h("ngForOf",n.accentPresets)("ngForTrackBy",n.trackAccent),d(9),C(n.showPwaInstallInstructions?41:-1),d(6),h("href",n.rateAppUrl,pt))},dependencies:[$,ft,re,ce,se,oe,K,Y,H,le,Z,Q],styles:[".about-header[_ngcontent-%COMP%]{border-bottom:1px solid color-mix(in oklab,var(--calc-border-subtle) 80%,transparent)}.about-toolbar[_ngcontent-%COMP%]{--background: color-mix(in oklab, var(--calc-surface-raised) 86%, var(--calc-accent) 14%);--color: var(--calc-text-strong)}.about-back-btn[_ngcontent-%COMP%]{--color: var(--calc-text-strong)}.accent-preset-btn[_ngcontent-%COMP%]{align-items:center;background:var(--calc-surface-raised);border:1px solid var(--calc-border-subtle);border-radius:var(--calc-radius-md);color:var(--calc-text-strong);display:inline-flex;font-size:.75rem;gap:.5rem;justify-content:flex-start;min-height:40px;padding:.45rem .65rem}.accent-preset-btn-active[_ngcontent-%COMP%]{background:var(--calc-info-bg);border-color:var(--calc-border-strong)}.accent-preset-dot[_ngcontent-%COMP%]{border:1px solid color-mix(in oklab,var(--calc-text-strong) 20%,transparent);border-radius:9999px;height:.9rem;width:.9rem}"]});let r=l;return r})();var Ft=function(r){return r.Dark="DARK",r.Light="LIGHT",r.Default="DEFAULT",r}(Ft||{});var $t=_e("StatusBar");var Ri=_e("EdgeToEdge",{});var Vi=(()=>{let l=class l{constructor(){this.activeTab="splits",this.activeTabChange=new z}onTabChange(e){this.activeTabChange.emit(e.detail.value)}};l.\u0275fac=function(t){return new(t||l)},l.\u0275cmp=R({type:l,selectors:[["app-focused-performance-tabs"]],inputs:{activeTab:"activeTab"},outputs:{activeTabChange:"activeTabChange"},decls:14,vars:1,consts:[[1,"px-2"],["mode","ios",1,"app-segment","p-[2px]",3,"ionChange","value"],["value","splits"],["value","training"],["value","lthr"],["value","blocks"]],template:function(t,n){t&1&&(a(0,"div",0)(1,"ion-segment",1),u("ionChange",function(m){return n.onTabChange(m)}),a(2,"ion-segment-button",2)(3,"ion-label"),s(4,"Splits"),o()(),a(5,"ion-segment-button",3)(6,"ion-label"),s(7,"Paces"),o()(),a(8,"ion-segment-button",4)(9,"ion-label"),s(10,"LTHR"),o()(),a(11,"ion-segment-button",5)(12,"ion-label"),s(13,"Blocks"),o()()()()),t&2&&(d(),h("value",n.activeTab))},dependencies:[Z,Q,le],encapsulation:2});let r=l;return r})();function Ma(r,l){if(r&1){let i=k();a(0,"p",5),s(1," LTHR anchors your zones to your actual physiology instead of age-based formulas. "),o(),a(2,"button",6),u("click",function(){g(i);let t=p();return f(t.openInfo.emit())}),s(3," How to use this "),o()}}function Sa(r,l){if(r&1&&(a(0,"div",7)(1,"p",14)(2,"span",15),s(3,"Z1 Recovery:"),o(),s(4),o(),a(5,"p",14)(6,"span",15),s(7,"Z2 Aerobic:"),o(),s(8),o(),a(9,"p",14)(10,"span",15),s(11,"Z3 Tempo:"),o(),s(12),o(),a(13,"p",14)(14,"span",15),s(15,"Z4 Sub-threshold:"),o(),s(16),o(),a(17,"p",14)(18,"span",15),s(19,"Z5a Threshold:"),o(),s(20),o(),a(21,"p",14)(22,"span",15),s(23,"Z5b VO2max:"),o(),s(24),o(),a(25,"p",14)(26,"span",15),s(27,"Z5c Anaerobic:"),o(),s(28),o()()),r&2){let i=p(2);d(4),T(" ",i.lthrSummary.zones.z1,""),d(4),T(" ",i.lthrSummary.zones.z2,""),d(4),T(" ",i.lthrSummary.zones.z3,""),d(4),T(" ",i.lthrSummary.zones.z4,""),d(4),T(" ",i.lthrSummary.zones.z5a,""),d(4),T(" ",i.lthrSummary.zones.z5b,""),d(4),T(" ",i.lthrSummary.zones.z5c,"")}}function Oa(r,l){r&1&&(a(0,"p",13),s(1," Add LTHR bpm to view heart-rate zones. Threshold pace remains available without heart-rate data. "),o())}function Ia(r,l){if(r&1){let i=k();a(0,"div",7)(1,"div",8)(2,"p",9),s(3,"Threshold Pace /km"),o(),a(4,"p",10),s(5),o()(),a(6,"div",8)(7,"p",9),s(8,"Threshold Pace /mi"),o(),a(9,"p",10),s(10),o()()(),a(11,"div",11)(12,"ion-input",12),u("ionInput",function(t){g(i);let n=p();return f(n.onLthrInput(t))}),o(),x(13,Sa,29,7,"div",7)(14,Oa,2,0,"p",13),o()}if(r&2){let i=p();d(5),v(i.lthrSummary.thresholdPacePerKm),d(5),v(i.lthrSummary.thresholdPacePerMi),d(2),h("value",i.lthrBpm),d(),C(i.lthrSummary.hasLthrBpm&&i.lthrSummary.zones?13:14)}}function Ea(r,l){r&1&&(a(0,"div",4)(1,"p",16),s(2,"No LTHR guidance"),o(),a(3,"p",17),s(4,"Enter a pace and time above 0 to unlock threshold pace guidance."),o()())}var Ai=(()=>{let l=class l{constructor(){this.maxLthrBpm=220,this.lthrSummary=null,this.lthrBpm="",this.lthrBpmChange=new z,this.openInfo=new z}onLthrInput(e){let n=this.readInputValue(e).replace(/[^0-9]/g,"").slice(0,3);if(!n){this.writeInputValue(e,""),this.lthrBpmChange.emit("");return}let c=Math.min(this.maxLthrBpm,Number(n)),m=String(c);this.writeInputValue(e,m),this.lthrBpmChange.emit(m)}readInputValue(e){var c,m;let t=(c=e.detail)==null?void 0:c.value;if(typeof t=="number")return Number.isFinite(t)?String(t):"";if(typeof t=="string")return t;let n=(m=e.target)==null?void 0:m.value;return typeof n=="number"?Number.isFinite(n)?String(n):"":typeof n=="string"?n:""}writeInputValue(e,t){let n=e.target;n&&(n.value=t)}};l.\u0275fac=function(t){return new(t||l)},l.\u0275cmp=R({type:l,selectors:[["app-lthr-panel"]],inputs:{lthrSummary:"lthrSummary",lthrBpm:"lthrBpm"},outputs:{lthrBpmChange:"lthrBpmChange",openInfo:"openInfo"},decls:8,vars:2,consts:[[1,"mx-auto","max-w-5xl","px-2","pt-2","mobile-bottom-safe"],[1,"calc-surface-card","p-4"],[1,"mb-3"],[1,"text-sm","font-bold","uppercase","tracking-[0.08em]","text-[var(--calc-text-muted)]"],[1,"panel-empty-state"],[1,"mt-2","text-xs","text-[var(--calc-text-muted)]"],["type","button",1,"mt-1","text-sm","text-[var(--calc-accent)]","underline",3,"click"],[1,"mt-3","grid","grid-cols-1","gap-2","sm:grid-cols-2"],[1,"calc-shell-subtle","rounded-xl","p-3"],[1,"text-xs","uppercase","tracking-[0.08em]","text-[var(--calc-text-muted)]"],[1,"text-xl","font-extrabold"],[1,"calc-shell-subtle","mt-4","rounded-xl","p-3"],["id","lthr-input","mode","md","type","number","min","0","max","220","label","Your LTHR (bpm)","labelPlacement","stacked","fill","outline","inputmode","numeric",3,"ionInput","value"],[1,"mt-3","text-sm","text-[var(--calc-text-muted)]"],[1,"text-sm"],[1,"font-semibold"],[1,"panel-empty-title"],[1,"panel-empty-copy"]],template:function(t,n){t&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),s(4," LTHR Pace Guidance "),o(),x(5,Ma,4,0),o(),x(6,Ia,15,4)(7,Ea,5,0,"div",4),o()()),t&2&&(d(5),C(n.lthrSummary?5:-1),d(),C(n.lthrSummary?6:7))},dependencies:[$,fe],styles:["ion-input[_ngcontent-%COMP%]{--border-color: color-mix(in oklab, var(--calc-text-muted) 40%, transparent);--highlight-color-focused: var(--calc-accent-strong);--highlight-color-valid: var(--calc-accent-strong);--color: var(--calc-text-strong)}"]});let r=l;return r})();var Da=(r,l)=>l.name,Ra=(r,l)=>l.week;function Va(r,l){r&1&&(a(0,"div",1)(1,"p",3),s(2," Blocks supports 5K and longer. For shorter events, use Splits and Paces. "),o()())}function Aa(r,l){r&1&&(a(0,"div",2)(1,"h2",4),s(2,"Blocks"),o(),a(3,"div",5)(4,"p",6),s(5,"No blocks"),o(),a(6,"p",7),s(7,"Enter a pace and time above 0 before generating and saving blocks."),o()()())}function Ba(r,l){if(r&1&&(b(0,"br"),s(1)),r&2){let i=p().$implicit;d(),T("",i.taperReduction," ")}}function Fa(r,l){if(r&1&&(a(0,"div",35)(1,"p",41),s(2),o(),a(3,"p",42),s(4),x(5,Ba,2,1),o()()),r&2){let i=l.$implicit;d(2),te("",i.name," (",i.weeks,"w)"),d(2),T(" Trend: ",i.volumeTrend," "),d(),C(i.taperReduction?5:-1)}}function $a(r,l){if(r&1&&(a(0,"ion-row",43)(1,"ion-col")(2,"p",47),s(3),o()()()),r&2){let i=p().$implicit;d(3),T(" ",i.phaseTag," ")}}function La(r,l){if(r&1&&(x(0,$a,4,1,"ion-row",43),a(1,"ion-row",44)(2,"ion-col",38)(3,"p",45),s(4),o()(),a(5,"ion-col")(6,"p",46),s(7),o()(),a(8,"ion-col")(9,"p",45),s(10),o()(),a(11,"ion-col")(12,"p",45),s(13),o()(),a(14,"ion-col")(15,"p",45),s(16),o()()()),r&2){let i=l.$implicit,e=l.$index;C(i.isNewPhase?0:-1),d(),w("blocks-row-accent",e%2===0),d(3),v(i.week),d(3),v(i.targetVolume),d(3),v(i.easyRun),d(3),v(i.qualityLoad),d(3),v(i.longRun)}}function Na(r,l){if(r&1){let i=k();a(0,"div",8)(1,"div",9)(2,"h2",10),s(3,"Blocks"),o(),a(4,"p",11),s(5,"Training block structure"),o()(),a(6,"div",12)(7,"div",13)(8,"div",14)(9,"div")(10,"div",15),s(11,"Unit"),o(),a(12,"ion-segment",16),u("ionChange",function(t){g(i);let n=p();return f(n.onDistanceUnitChange(t))}),a(13,"ion-segment-button",17)(14,"ion-label"),s(15,"Km"),o()(),a(16,"ion-segment-button",18)(17,"ion-label"),s(18,"Mi"),o()()()(),a(19,"div")(20,"div",15),s(21,"Model"),o(),a(22,"ion-segment",16),u("ionChange",function(t){g(i);let n=p();return f(n.onModelChange(t))}),a(23,"ion-segment-button",19)(24,"ion-label"),s(25,"4-Phase"),o()(),a(26,"ion-segment-button",20)(27,"ion-label"),s(28,"3-Phase"),o()()()()(),a(29,"div",21)(30,"div")(31,"ion-input",22),u("ionInput",function(t){g(i);let n=p();return f(n.onWeeksToRaceInput(t))}),o()(),a(32,"div")(33,"ion-input",23),u("ionInput",function(t){g(i);let n=p();return f(n.onCurrentWeeklyVolumeInput(t))}),o()(),a(34,"div")(35,"ion-input",24),u("ionInput",function(t){g(i);let n=p();return f(n.onPeakWeeklyVolumeCapInput(t))}),o()(),a(36,"div")(37,"div",15),s(38),o(),a(39,"ion-range",25),u("ionInput",function(t){g(i);let n=p();return f(n.onLongRunPercentChange(t))})("ionChange",function(t){g(i);let n=p();return f(n.onLongRunPercentChange(t))}),o()()(),a(40,"div",26)(41,"div",27),s(42,"Step-back (Reduce volume every 3-4 wks)"),o(),a(43,"ion-toggle",28),u("ionChange",function(t){g(i);let n=p();return f(n.onStepBackToggleChange(t))}),o()()()(),a(44,"div",29)(45,"button",30),u("click",function(){g(i);let t=p();return f(t.toggleTopControlsCollapse())}),b(46,"ion-icon",31),o()()(),a(47,"div",32)(48,"h3",33),s(49," Phase Overview "),o(),a(50,"div",34),S(51,Fa,6,4,"div",35,Da),o()(),a(53,"ion-grid",36)(54,"ion-row",37)(55,"ion-col",38)(56,"p",39),s(57,"Wk"),o()(),a(58,"ion-col")(59,"p",39),s(60,"Total"),o()(),a(61,"ion-col")(62,"p",39),s(63,"Easy"),o()(),a(64,"ion-col")(65,"p",39),s(66,"Quality"),o()(),a(67,"ion-col")(68,"p",39),s(69,"Long Run"),o()()(),a(70,"div",40),S(71,La,17,8,null,null,Ra),o()()}if(r&2){let i=p();w("blocks-controls-card-collapsed",i.topControlsCollapsed()),d(6),w("blocks-controls-body-collapsed",i.topControlsCollapsed()),d(6),h("value",i.distanceUnit()),d(10),h("value",i.modelSelector()),d(9),h("value",i.weeksToRace),d(2),h("label","Current weekly volume ("+i.distanceUnit()+")")("max",i.distanceUnit()==="mi"?186.4:300)("value",i.currentWeeklyVolume),d(2),h("label","Peak weekly cap ("+i.distanceUnit()+")")("max",i.distanceUnit()==="mi"?186.4:300)("value",i.peakWeeklyVolumeCap),d(3),T(" Long run % of weekly volume: ",i.longRunPercent(),"% "),d(),h("min",20)("max",35)("step",1)("value",i.longRunPercent()),d(4),h("checked",i.stepBackToggle()),d(),w("blocks-collapse-slot-collapsed",i.topControlsCollapsed()),d(),L("aria-label",i.topControlsCollapsed()?"Expand block controls":"Collapse block controls"),d(),h("name",i.topControlsCollapsed()?"chevron-down-outline":"chevron-up-outline"),d(5),O(i.phases()),d(20),O(i.weeklyBlocks())}}var Bi=(()=>{let l=class l{constructor(){this.hasValidBaseline=!0,this.distanceType="km",this.focusId=null,this.navigateToTab=new z,this.weeksToRace=12,this.currentWeeklyVolume=null,this.peakWeeklyVolumeCap=null,this.longRunPercent=D(28),this.modelSelector=D("4-Phase"),this.distanceUnit=D("km"),this.stepBackToggle=D(!1),this.topControlsCollapsed=D(!1),this.phases=D([]),this.weeklyBlocks=D([]),this.kmToMi=.621371,this.minWeeksToRace=4,this.maxWeeksToRace=30,this.maxWeeklyVolumeKm=300,W({chevronDownOutline:Ge,chevronUpOutline:Ye})}get categoryKey(){return this.focusId===-1||this.focusId===null?null:`dist_${this.focusId}`}ngOnInit(){this.distanceUnit.set(this.distanceType),this.setDefaultLongRunPercent(),this.loadPreferences(),this.updateCalculation()}ngOnChanges(e){e.distanceType&&!e.distanceType.firstChange&&this.distanceUnit.set(this.distanceType),(e.distanceMeters||e.focusId)&&(this.setDefaultLongRunPercent(),this.loadPreferences()),this.updateCalculation()}loadPreferences(){let e=this.categoryKey;if(!e){this.currentWeeklyVolume=null,this.peakWeeklyVolumeCap=null,this.weeksToRace=12,this.modelSelector.set("4-Phase"),this.stepBackToggle.set(!1);return}let t=localStorage.getItem(`stridemate_blocks_prefs_${e}`);if(t)try{let n=JSON.parse(t);(n.distanceUnit==="km"||n.distanceUnit==="mi")&&this.distanceUnit.set(n.distanceUnit),this.weeksToRace=this.clampWeeksToRace(this.toNullableNumber(n.weeksToRace)),this.currentWeeklyVolume=this.clampWeeklyVolume(this.toNullableNumber(n.currentWeeklyVolume)),this.peakWeeklyVolumeCap=this.clampWeeklyVolume(this.toNullableNumber(n.peakWeeklyVolumeCap)),this.longRunPercent.set(this.clampLongRunPercent(this.toNullableNumber(n.longRunPercent))),(n.modelSelector==="3-Phase"||n.modelSelector==="4-Phase")&&this.modelSelector.set(n.modelSelector),n.stepBackToggle!==void 0&&this.stepBackToggle.set(!!n.stepBackToggle)}catch(n){console.error("Failed to parse blocks preferences",n)}else this.currentWeeklyVolume=null,this.peakWeeklyVolumeCap=null,this.weeksToRace=12,this.modelSelector.set("4-Phase"),this.stepBackToggle.set(!1)}savePreferences(){let e=this.categoryKey;if(!e)return;let t={weeksToRace:this.weeksToRace,currentWeeklyVolume:this.currentWeeklyVolume,peakWeeklyVolumeCap:this.peakWeeklyVolumeCap,longRunPercent:this.longRunPercent(),modelSelector:this.modelSelector(),distanceUnit:this.distanceUnit(),stepBackToggle:this.stepBackToggle()};localStorage.setItem(`stridemate_blocks_prefs_${e}`,JSON.stringify(t))}setDefaultLongRunPercent(){this.distanceMeters<1e4?this.longRunPercent.set(24):this.distanceMeters<21e3?this.longRunPercent.set(26):this.distanceMeters<42e3?this.longRunPercent.set(30):this.longRunPercent.set(32)}onLongRunPercentChange(e){var n;let t=this.toNullableNumber((n=e==null?void 0:e.detail)==null?void 0:n.value);t!==null&&(this.longRunPercent.set(this.clampLongRunPercent(t)),this.updateCalculation())}onWeeksToRaceChange(e){this.weeksToRace=this.clampWeeksToRace(this.toNullableNumber(e)),this.updateCalculation()}onWeeksToRaceInput(e){let t=this.clampWeeksToRace(this.toNullableNumber(this.readInputValue(e)));this.weeksToRace=t,this.writeInputValue(e,String(t)),this.updateCalculation()}onCurrentWeeklyVolumeChange(e){this.currentWeeklyVolume=this.clampWeeklyVolume(this.toNullableNumber(e)),this.updateCalculation()}onCurrentWeeklyVolumeInput(e){let t=this.clampWeeklyVolume(this.toNullableNumber(this.readInputValue(e)));this.currentWeeklyVolume=t,this.writeInputValue(e,this.formatNullableNumber(t)),this.updateCalculation()}onPeakWeeklyVolumeCapChange(e){this.peakWeeklyVolumeCap=this.clampWeeklyVolume(this.toNullableNumber(e)),this.updateCalculation()}onPeakWeeklyVolumeCapInput(e){let t=this.clampWeeklyVolume(this.toNullableNumber(this.readInputValue(e)));this.peakWeeklyVolumeCap=t,this.writeInputValue(e,this.formatNullableNumber(t)),this.updateCalculation()}onModelChange(e){var n;let t=(n=e==null?void 0:e.detail)==null?void 0:n.value;t&&(this.modelSelector.set(t),this.updateCalculation())}onDistanceUnitChange(e){var c;let t=(c=e==null?void 0:e.detail)==null?void 0:c.value;if(!t)return;let n=this.distanceUnit();if(t===n){this.updateCalculation();return}this.currentWeeklyVolume!==null&&(this.currentWeeklyVolume=this.clampWeeklyVolume(this.convertDistanceValue(this.currentWeeklyVolume,n,t))),this.peakWeeklyVolumeCap!==null&&(this.peakWeeklyVolumeCap=this.clampWeeklyVolume(this.convertDistanceValue(this.peakWeeklyVolumeCap,n,t))),this.distanceUnit.set(t),this.updateCalculation()}onStepBackToggleChange(e){this.stepBackToggle.set(e.detail.checked),this.updateCalculation()}toggleTopControlsCollapse(){this.topControlsCollapsed.update(e=>!e)}toNullableNumber(e){if(e===""||e===null||e===void 0||typeof e=="string"&&e.trim().length===0)return null;let t=typeof e=="number"?e:Number(e);return Number.isFinite(t)?t:null}formatNullableNumber(e){return e===null?"":(Number.isInteger(e),String(e))}readInputValue(e){var c,m;let t=(c=e.detail)==null?void 0:c.value;if(typeof t=="number"||typeof t=="string"||t===null)return t;let n=(m=e.target)==null?void 0:m.value;if(typeof n=="number"||typeof n=="string"||n===null)return n}writeInputValue(e,t){let n=e.target;n&&(n.value=t)}convertDistanceValue(e,t,n){if(t===n)return e;let c=t==="km"?e*this.kmToMi:e/this.kmToMi;return Math.round(c*10)/10}getMaxWeeklyVolumeForUnit(e){let t=e==="mi"?this.maxWeeklyVolumeKm*this.kmToMi:this.maxWeeklyVolumeKm;return Math.round(t*10)/10}clampWeeksToRace(e){return e===null?12:Math.max(this.minWeeksToRace,Math.min(this.maxWeeksToRace,Math.round(e)))}clampWeeklyVolume(e){if(e===null)return null;let t=this.getMaxWeeklyVolumeForUnit(this.distanceUnit()),n=Math.max(0,Math.min(t,e));return Math.round(n*10)/10}clampLongRunPercent(e){return e===null?this.longRunPercent():Math.max(20,Math.min(35,Math.round(e)))}updateCalculation(){if(this.distanceMeters<5e3||!this.hasValidBaseline){this.phases.set([]),this.weeklyBlocks.set([]);return}this.savePreferences();let e=.4,t=.35,n=.15,c=.1,m=1.03,_=1.05,P=1.04,y=1.06,B=.85,V=.7,F=12,ve=16,Xe=18,Je=12;this.distanceMeters<1e4?(e=.35,t=.4,n=.15,c=.1,m=1.03,_=1.05,P=1.04,y=1.06,B=.85,V=.7,F=12,ve=16,Xe=18,Je=12):this.distanceMeters<21e3?(e=.4,t=.35,n=.15,c=.1,m=1.04,_=1.06,P=1.05,y=1.07,B=.8,V=.65,F=11,ve=15,Xe=17,Je=11):this.distanceMeters<42e3?(e=.4,t=.35,n=.1,c=.15,m=1.05,_=1.07,P=1.06,y=1.08,B=.8,V=.6,F=10,ve=14,Xe=16,Je=10):(e=.45,t=.3,n=.1,c=.15,m=1.05,_=1.08,P=1.06,y=1.09,B=.75,V=.6,F=10,ve=12,Xe=14,Je=10);let de=this.clampWeeksToRace(this.weeksToRace),Nt=this.modelSelector()==="4-Phase",xe=Math.max(1,Math.round(de*(Nt?c:c+.05)));de<=6&&(xe=1);let J=0,ae=0,he=0;if(de<=6){let G=de-xe;J=Math.ceil(G/2),ae=G-J}else J=Math.max(3,Math.round(de*e)),Nt?(ae=Math.round(de*t),he=Math.max(1,de-J-ae-xe)):ae=de-J-xe;let ct=J+ae+he+xe;for(;ct<de;)Nt&&he<Math.round(de*n)?he++:ae<Math.round(de*t)?ae++:J++,ct++;for(;ct>de;)he>1?he--:ae>1?ae--:J>3?J--:xe--,ct--;let et=this.currentWeeklyVolume;if(!et){let G=55;this.distanceMeters<1e4?G=30:this.distanceMeters<21e3&&(G=42.5),et=this.convertDistanceValue(G,"km",this.distanceUnit())}let ea=this.peakWeeklyVolumeCap??et*1.4,zt=Math.min(ea,et*1.4),ta=((m+_)/2-1)*100,na=((P+y)/2-1)*100,an=G=>"+"+G.toFixed(1)+"%",on="-"+((1-B)*100).toFixed(0)+"%",ia="-"+((1-V)*100).toFixed(0)+"%",tt=[];J>0&&tt.push({name:"Base",weeks:J,volumeTrend:"\u2197 "+an(ta)}),ae>0&&tt.push({name:"Build",weeks:ae,volumeTrend:"\u2197 "+an(na)}),he>0&&tt.push({name:"Peak",weeks:he,volumeTrend:"\u2192 Hold"}),xe>0&&tt.push({name:"Taper",weeks:xe,volumeTrend:"\u2198",taperReduction:xe>1?on+" / "+ia:on}),this.phases.set(tt);let ye=et,dt=[],Ht=0;for(let G=1;G<=de;G++){let ee;G<=J?ee="Base":G<=J+ae?ee="Build":G<=J+ae+he?ee="Peak":ee="Taper",Ht++;let nt=!1;this.stepBackToggle()&&ee!=="Taper"&&ee!=="Peak"&&Ht>=4&&(nt=!0,Ht=0);let Ce=ye;if(G>1&&!nt&&ee!=="Taper"){let it=1;ee==="Base"?it=_:ee==="Build"?it=y:ee==="Peak"&&(it=1.01),ye=ye*it,Ce=ye}ee==="Taper"?G-(J+ae+he)===1?Ce=ye*B:Ce=ye*V:nt&&(Ce=ye*.85),Ce>zt&&(Ce=zt,ye=zt);let aa=nt||ee==="Base"?F:ee==="Build"?ve:ee==="Peak"?Xe:Je,rn=Math.round(Ce*10)/10,ln=Math.round(Ce*(this.longRunPercent()/100)*10)/10,sn=Math.round(Ce*(aa/100)*10)/10,oa=Math.round((rn-ln-sn)*10)/10,cn=nt?"Step-back":ee,ra=G===1||dt[dt.length-1].phaseTag!==cn;dt.push({week:G,targetVolume:rn,easyRun:oa,longRun:ln,qualityLoad:sn,phaseTag:cn,isNewPhase:ra})}this.weeklyBlocks.set(dt)}};l.\u0275fac=function(t){return new(t||l)},l.\u0275cmp=R({type:l,selectors:[["app-blocks-panel"]],inputs:{distanceMeters:"distanceMeters",hasValidBaseline:"hasValidBaseline",distanceType:"distanceType",focusId:"focusId"},outputs:{navigateToTab:"navigateToTab"},features:[Ve],decls:4,vars:1,consts:[[1,"mx-auto","max-w-5xl","px-2","pb-4","pt-2"],[1,"calc-surface-card","p-6","text-center"],[1,"calc-surface-card","p-4","text-center"],[1,"mb-4","text-sm","text-[var(--calc-text-muted)]"],[1,"mb-3","text-sm","font-bold","uppercase","tracking-[0.08em]","text-[var(--calc-text-muted)]","text-left"],[1,"panel-empty-state"],[1,"panel-empty-title"],[1,"panel-empty-copy"],[1,"calc-surface-card","blocks-controls-card","mb-4","p-4"],[1,"mb-3"],[1,"text-sm","font-bold","uppercase","tracking-[0.08em]","text-[var(--calc-text-muted)]"],[1,"mt-2","text-sm","text-[var(--calc-text-muted)]"],[1,"blocks-controls-body"],[1,"blocks-controls-body-inner"],[1,"mt-4","grid","grid-cols-1","gap-4","sm:grid-cols-2"],[1,"mb-1","text-xs","text-[var(--calc-text-muted)]"],["mode","ios",1,"app-segment",3,"ionChange","value"],["value","km"],["value","mi"],["value","4-Phase"],["value","3-Phase"],[1,"mt-5","grid","grid-cols-1","gap-4","sm:grid-cols-2"],["mode","md","label","Weeks to race","labelPlacement","stacked","type","number","min","4","max","30","fill","outline",3,"ionInput","value"],["mode","md","labelPlacement","stacked","type","number","min","0","fill","outline",3,"ionInput","label","max","value"],["labelPlacement","stacked","type","number","min","0","fill","outline",3,"ionInput","label","max","value"],[1,"calc-range",3,"ionInput","ionChange","min","max","step","value"],[1,"mt-4","flex","items-center","justify-between"],[1,"text-sm"],[3,"ionChange","checked"],[1,"blocks-collapse-slot"],["type","button",1,"blocks-collapse-toggle",3,"click"],[3,"name"],[1,"calc-surface-card","mb-4","p-4"],[1,"mb-3","text-sm","font-bold","uppercase","tracking-[0.08em]","text-[var(--calc-text-muted)]"],[1,"grid","grid-cols-2","gap-2","sm:grid-cols-4"],[1,"calc-shell-subtle","rounded-xl","p-2"],[1,"calc-table-shell","p-0"],[1,"calc-table-head","calc-divider-subtle","bg-[var(--calc-surface-1)]/95","sticky","top-0","z-10","border-b","px-2","py-1"],["size","2"],[1,"text-center"],[1,"px-2","pb-2","pt-1"],[1,"text-sm","font-semibold"],[1,"text-xs","text-[var(--calc-text-muted)]"],[1,"mb-1","mt-2"],[1,"blocks-row","items-center","py-0.5"],[1,"text-center","text-sm"],[1,"text-center","text-sm","font-medium"],[1,"pl-2","text-[11px]","font-bold","uppercase","tracking-wider","text-[var(--calc-text-muted)]"]],template:function(t,n){t&1&&(a(0,"div",0),x(1,Va,3,0,"div",1)(2,Aa,8,0,"div",2)(3,Na,73,23),o()),t&2&&(d(),C(n.distanceMeters<5e3?1:n.hasValidBaseline?3:2))},dependencies:[$,ge,fe,vt,Z,Q,yt,le,We,je,ze,H],styles:[".calc-table-head[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--calc-text-muted);font-size:.75rem;font-weight:600}ion-input[_ngcontent-%COMP%]{--border-color: color-mix(in oklab, var(--calc-text-muted) 40%, transparent);--highlight-color-focused: var(--calc-accent-strong);--highlight-color-valid: var(--calc-accent-strong);--color: var(--calc-text-strong)}ion-toggle[_ngcontent-%COMP%]{--track-background: color-mix(in oklab, var(--calc-surface-2) 74%, var(--calc-surface-1));--track-background-checked: color-mix(in oklab, var(--calc-accent) 48%, var(--calc-surface-2));--handle-background: var(--calc-surface-raised);--handle-background-checked: #f8fafc;--handle-box-shadow: 0 0 0 1px color-mix(in oklab, var(--calc-border-subtle) 70%, transparent)}.blocks-row-accent[_ngcontent-%COMP%]{background:color-mix(in oklab,var(--calc-surface-2) 70%,transparent);border-radius:.75rem}.blocks-controls-body[_ngcontent-%COMP%]{max-height:900px;overflow:hidden;transition:max-height var(--calc-motion-normal) var(--calc-motion-ease),opacity var(--calc-motion-normal) var(--calc-motion-ease),margin var(--calc-motion-normal) var(--calc-motion-ease);opacity:1}.blocks-controls-body-inner[_ngcontent-%COMP%]{overflow:hidden}.blocks-controls-body-collapsed[_ngcontent-%COMP%]{max-height:0;opacity:0;margin-top:0;pointer-events:none}.blocks-controls-card[_ngcontent-%COMP%]{transition:padding-bottom var(--calc-motion-normal) var(--calc-motion-ease)}.blocks-controls-card-collapsed[_ngcontent-%COMP%]{padding-bottom:.5rem}.blocks-collapse-toggle[_ngcontent-%COMP%]{width:40px;height:40px;border:1px solid color-mix(in oklab,var(--calc-border-subtle) 70%,transparent);border-radius:9999px;background:color-mix(in oklab,var(--calc-surface-2) 76%,var(--calc-surface-1));color:var(--calc-text-muted);display:flex;align-items:center;justify-content:center;position:absolute;top:0;left:50%;transform:translate(-50%);transition:left var(--calc-motion-normal) var(--calc-motion-ease),transform var(--calc-motion-normal) var(--calc-motion-ease)}.blocks-collapse-toggle[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.15rem}.blocks-collapse-slot[_ngcontent-%COMP%]{position:relative;margin-top:.5rem;height:40px;transition:height var(--calc-motion-normal) var(--calc-motion-ease),margin var(--calc-motion-normal) var(--calc-motion-ease)}.blocks-collapse-slot-collapsed[_ngcontent-%COMP%]   .blocks-collapse-toggle[_ngcontent-%COMP%]{left:calc(100% - 8px);transform:translate(-100%,-54px)}.blocks-collapse-slot-collapsed[_ngcontent-%COMP%]{height:0;margin-top:0}@media (prefers-reduced-motion: reduce){.blocks-controls-body[_ngcontent-%COMP%], .blocks-controls-card[_ngcontent-%COMP%], .blocks-collapse-slot[_ngcontent-%COMP%], .blocks-collapse-toggle[_ngcontent-%COMP%]{transition:none}}"]});let r=l;return r})();var Fi=(()=>{let l=class l{constructor(e,t){this.el=e,this._zone=t,this.updateChange=new z(!0),this.chartInstance=new z}ngOnChanges(e){var n;let t=(n=e.update)==null?void 0:n.currentValue;(e.options||t)&&(this.wrappedUpdateOrCreateChart(),t&&this.updateChange.emit(!1))}wrappedUpdateOrCreateChart(){this.runOutsideAngular?this._zone.runOutsideAngular(()=>{this.updateOrCreateChart()}):this.updateOrCreateChart()}updateOrCreateChart(){var e;(e=this.chart)!=null&&e.update?this.chart.update(this.options,!0,this.oneToOne||!1):(this.chart=this.Highcharts[this.constructorType||"chart"](this.el.nativeElement,this.options,this.callbackFunction||null),this.chartInstance.emit(this.chart))}ngOnDestroy(){this.chart&&(this.chart.destroy(),this.chart=null,this.chartInstance.emit(this.chart))}};l.\u0275fac=function(t){return new(t||l)(at(mt),at(mn))},l.\u0275cmp=R({type:l,selectors:[["highcharts-chart"]],inputs:{Highcharts:"Highcharts",constructorType:"constructorType",callbackFunction:"callbackFunction",oneToOne:"oneToOne",runOutsideAngular:"runOutsideAngular",options:"options",update:"update"},outputs:{updateChange:"updateChange",chartInstance:"chartInstance"},standalone:!1,features:[Ve],decls:0,vars:0,template:function(t,n){},encapsulation:2});let r=l;return r})(),$i=(()=>{let l=class l{};l.\u0275fac=function(t){return new(t||l)},l.\u0275mod=un({type:l}),l.\u0275inj=dn({});let r=l;return r})();function Ha(r,l){if(r&1){let i=k();a(0,"button",29),u("click",function(){g(i);let t=p(3);return f(t.onResetHalfDelta())}),b(1,"ion-icon",30),o()}}function Wa(r,l){if(r&1){let i=k();a(0,"ion-segment",18),u("ionChange",function(t){g(i);let n=p(2);return f(n.onStrategyProfileChange(t))}),a(1,"ion-segment-button",19)(2,"ion-label"),s(3,"Progressive"),o()(),a(4,"ion-segment-button",20)(5,"ion-label"),s(6,"Late Kick"),o()(),a(7,"ion-segment-button",21)(8,"ion-label"),s(9,"Step"),o()()(),a(10,"div",22)(11,"p",23),s(12),o(),x(13,Ha,2,0,"button",24),o(),a(14,"ion-range",25),u("ionChange",function(t){g(i);let n=p(2);return f(n.onHalfDeltaChange(t))}),a(15,"ion-label",26),s(16,"Faster 2nd"),o(),a(17,"ion-label",27),s(18,"Slower 2nd"),o()(),a(19,"p",28),s(20),o()}if(r&2){let i=p(2);h("value",i.currentStrategyProfile),d(12),T("2nd half vs 1st half: ",i.splitDeltaLabel,""),d(),C(i.hasNonZeroHalfDelta?13:-1),d(),h("ticks",!0)("snaps",!0)("disabled",i.isSingleLap)("min",-i.halfDeltaCap)("max",i.halfDeltaCap)("step",i.halfDeltaStep)("value",i.currentHalfDelta),d(5),w("calc-warning-slot-visible",!!(i.splitPlan!=null&&i.splitPlan.warning)),d(),T(" ",(i.splitPlan==null?null:i.splitPlan.warning)||"Adjusted to realistic range for this distance."," ")}}function ja(r,l){r&1&&(a(0,"p",12),s(1," Strategy controls are shown for distances above 5K. "),o())}function Ua(r,l){r&1&&(a(0,"p",31),s(1," Set a non-zero half delta to activate split point. "),o())}function Ka(r,l){if(r&1){let i=k();a(0,"div",22)(1,"p",23),s(2),o()(),a(3,"ion-range",25),u("ionChange",function(t){g(i);let n=p(2);return f(n.onTransitionPointChange(t))}),a(4,"ion-label",26),s(5,"Earlier"),o(),a(6,"ion-label",27),s(7,"Later"),o()(),x(8,Ua,2,0,"p",31)}if(r&2){let i=p(2);d(2),T("Shift point: ",i.transitionPointLabel,""),d(),h("ticks",!0)("snaps",!0)("disabled",!i.isTransitionPointAdjustable)("min",35)("max",85)("step",5)("value",i.currentTransitionPointPercent),d(5),C(i.hasNonZeroHalfDelta?-1:8)}}function Ga(r,l){r&1&&(a(0,"p",13),s(1,"Tip: You can mark your effort per lap in the table below."),o())}function Ya(r,l){r&1&&(ht(0),a(1,"div",32),b(2,"ion-spinner",33),o(),gt())}function qa(r,l){if(r&1&&b(0,"highcharts-chart",34),r&2){let i=p(2);h("Highcharts",i.highcharts)("options",i.splitsChartOptions)}}function Qa(r,l){if(r&1){let i=k();a(0,"div",1)(1,"div",4)(2,"div",5)(3,"h2",6),s(4,"Splits Planner"),o(),a(5,"p",7),s(6,"Race pacing strategy"),o()(),a(7,"div",8)(8,"div",9)(9,"ion-grid")(10,"ion-row")(11,"ion-col")(12,"div",10)(13,"p",11),s(14,"Strategy"),o(),x(15,Wa,21,13)(16,ja,2,0,"p",12)(17,Ka,9,9)(18,Ga,2,0,"p",13),o(),x(19,Ya,3,0,"ng-container",14)(20,qa,1,2,"ng-template",null,0,xn),o()()()()(),a(22,"div",15)(23,"button",16),u("click",function(){g(i);let t=p();return f(t.togglePlanner())}),b(24,"ion-icon",17),o()()()()}if(r&2){let i=Ae(21),e=p();d(),w("planner-controls-card-collapsed",e.isPlannerCollapsed),d(6),w("planner-body-collapsed",e.isPlannerCollapsed),d(8),C(e.isStrategyAvailable?15:16),d(2),C(e.isStrategyAvailable&&e.currentStrategyProfile!=="step"?17:-1),d(),C(e.isStrategyAvailable?18:-1),d(),h("ngIf",!e.plannerChartMounted||!e.splitsChartReady||!e.splitsChartOptions)("ngIfElse",i),d(3),w("planner-collapse-slot-collapsed",e.isPlannerCollapsed),d(),L("aria-label",e.isPlannerCollapsed?"Expand splits planner":"Collapse splits planner"),d(),h("name",e.isPlannerCollapsed?"chevron-down-outline":"chevron-up-outline")}}function Za(r,l){if(r&1){let i=k();a(0,"button",42),u("click",function(){g(i);let t=p(3);return f(t.onResetLapTags())}),b(1,"ion-icon",30),o()}}function Xa(r,l){if(r&1&&(a(0,"div",38)(1,"p",37),s(2,"Effort"),o(),x(3,Za,2,0,"button",41),o()),r&2){let i=p(2);d(3),C(!i.isSingleLap&&i.hasCustomLapTags?3:-1)}}function Ja(r,l){if(r&1){let i=k();a(0,"div",47)(1,"button",50),u("click",function(){g(i);let t=p().$index,n=p(2);return f(n.onLapTagChange(t))}),s(2),o()()}if(r&2){let i=p().$index,e=p(2);d(),w("lap-tag-uphill",e.lapTag(i)==="uphill")("lap-tag-downhill",e.lapTag(i)==="downhill"),h("disabled",e.isSingleLap),d(),T(" ",e.lapTagLabel(i)," ")}}function eo(r,l){if(r&1&&(a(0,"div",43)(1,"p",44),s(2),o(),a(3,"p",45),s(4),o(),a(5,"p",46),s(6),o(),x(7,Ja,3,6,"div",47),a(8,"p",48),s(9),o(),a(10,"p",49),s(11),o()()),r&2){let i=l.$implicit,e=p(2);w("splits-grid-no-effort",!e.isStrategyAvailable),d(2),v(i.split),d(2),v(i.splitDistance),d(2),v(i.splitPace),d(),C(e.isStrategyAvailable?7:-1),d(2),v(i.splitTime),d(2),v(i.totalDistance)}}function to(r,l){if(r&1&&(a(0,"div",2)(1,"div",35)(2,"div",36)(3,"p",37),s(4,"Lap"),o(),a(5,"p",37),s(6,"Distance"),o(),a(7,"p",37),s(8,"Pace"),o(),x(9,Xa,4,1,"div",38),a(10,"p",37),s(11,"Time"),o(),a(12,"p",37),s(13,"Rolling"),o()(),a(14,"div",39),S(15,eo,12,8,"div",40,pe),o()()()),r&2){let i=p();d(),w("mt-3",!i.splits.length),d(),w("splits-grid-no-effort",!i.isStrategyAvailable),d(7),C(i.isStrategyAvailable?9:-1),d(6),O(i.splits)}}function no(r,l){r&1&&(a(0,"div",3)(1,"div",51)(2,"h2",52),s(3,"Splits"),o(),a(4,"div",53)(5,"p",54),s(6,"No splits"),o(),a(7,"p",55),s(8,"Set distance, then enter a pace and time above 0."),o()()()())}W({refreshOutline:Yn,chevronDownOutline:Ge,chevronUpOutline:Ye});var Li=(()=>{let l=class l{constructor(e){this.store=e,this.lapTagCycle=["flat","uphill","downhill"],this.plannerExpandDelayMs=240,this.chartMountTimer=null,this.isPlannerCollapsed=!1,this.plannerChartMounted=!0,this.splitsChartReady=!1,this.splitsChartOptions=null,this.splitPlan=null,this.splits=[],this.splitHalfDeltaChange=new z,this.splitHalfDeltaReset=new z,this.splitStrategyProfileChange=new z,this.splitTransitionPointChange=new z,this.splitLapTagChange=new z,this.splitLapTagsReset=new z}get currentHalfDelta(){var e;return((e=this.splitPlan)==null?void 0:e.halfDeltaSeconds)??0}get currentStrategyProfile(){var e;return((e=this.splitPlan)==null?void 0:e.strategyProfile)??"progressive"}get currentTransitionPointPercent(){var e;return((e=this.splitPlan)==null?void 0:e.transitionPointPercent)??50}get hasNonZeroHalfDelta(){return this.currentHalfDelta!==0}get hasCustomLapTags(){var e;return(((e=this.splitPlan)==null?void 0:e.lapTags)??[]).some(t=>t!=="flat")}get isSingleLap(){return this.splits.length<=1}get isStrategyAvailable(){return this.getRaceDistanceMeters()>5e3}get isTransitionPointAdjustable(){return!this.isSingleLap&&this.hasNonZeroHalfDelta}get halfDeltaCap(){return ii(this.getRaceDistanceMeters())}get halfDeltaStep(){return this.getRaceDistanceMeters()<=5e3?10:5}get splitDeltaLabel(){let e=this.currentHalfDelta;return`${e>0?"+":""}${e}s`}get transitionPointLabel(){return`${this.currentTransitionPointPercent}%`}togglePlanner(){if(this.isPlannerCollapsed=!this.isPlannerCollapsed,this.store.dispatch(M.togglePlanner()),this.chartMountTimer!==null&&(window.clearTimeout(this.chartMountTimer),this.chartMountTimer=null),this.isPlannerCollapsed){this.plannerChartMounted=!1;return}this.plannerChartMounted=!1,this.chartMountTimer=window.setTimeout(()=>{this.plannerChartMounted=!0,this.store.dispatch(M.updateSplitsChart()),this.chartMountTimer=null},this.plannerExpandDelayMs)}onHalfDeltaChange(e){this.splitHalfDeltaChange.emit(e.detail.value)}onStrategyProfileChange(e){this.splitStrategyProfileChange.emit(e.detail.value)}onTransitionPointChange(e){this.splitTransitionPointChange.emit(Number(e.detail.value))}onResetHalfDelta(){this.splitHalfDeltaReset.emit()}onLapTagChange(e){var m,_;let t=((_=(m=this.splitPlan)==null?void 0:m.lapTags)==null?void 0:_[e])??"flat",n=this.lapTagCycle.indexOf(t),c=this.lapTagCycle[(n+1)%this.lapTagCycle.length];this.splitLapTagChange.emit({lapIndex:e,tag:c})}onResetLapTags(){this.splitLapTagsReset.emit()}lapTagLabel(e){let t=this.lapTag(e);return t==="uphill"?"\u25B2 Hill":t==="downhill"?"\u25BC Hill":"Flat"}lapTag(e){var t,n;return((n=(t=this.splitPlan)==null?void 0:t.lapTags)==null?void 0:n[e])??"flat"}getRaceDistanceMeters(){var n;let e=((n=this.splits[this.splits.length-1])==null?void 0:n.totalDistance)??"",t=Number(e.replace(/[^0-9.]/g,""));return!Number.isFinite(t)||t<=0?0:e.includes("mi")?t*1609.344:e.includes("km")?t*1e3:e.includes("m")?t:0}ngOnDestroy(){this.chartMountTimer!==null&&(window.clearTimeout(this.chartMountTimer),this.chartMountTimer=null)}};l.\u0275fac=function(t){return new(t||l)(at(be))},l.\u0275cmp=R({type:l,selectors:[["app-splits-panel"]],inputs:{highcharts:"highcharts",splitsChartReady:"splitsChartReady",splitsChartOptions:"splitsChartOptions",splitPlan:"splitPlan",splits:"splits"},outputs:{splitHalfDeltaChange:"splitHalfDeltaChange",splitHalfDeltaReset:"splitHalfDeltaReset",splitStrategyProfileChange:"splitStrategyProfileChange",splitTransitionPointChange:"splitTransitionPointChange",splitLapTagChange:"splitLapTagChange",splitLapTagsReset:"splitLapTagsReset"},decls:3,vars:2,consts:[["splitsChart",""],[1,"mx-auto","max-w-5xl","px-2","pb-2","pt-1"],[1,"mx-auto","max-w-5xl","px-2","pb-4"],[1,"mx-auto","max-w-5xl","px-2","pb-4","pt-2","mobile-bottom-safe"],[1,"calc-surface-card","planner-controls-card","mb-4","overflow-hidden","pb-4"],[1,"mb-3","px-3","pt-2"],[1,"text-sm","font-bold","uppercase","tracking-[0.08em]","text-[var(--calc-text-muted)]"],[1,"mt-2","text-sm","text-[var(--calc-text-muted)]"],[1,"planner-body"],[1,"planner-body-inner"],[1,"calc-shell-subtle","mb-2","rounded-[0.75rem]","px-3","py-2"],[1,"text-xs","uppercase","tracking-[0.08em]","text-[var(--calc-text-muted)]"],[1,"mt-2","text-xs","text-[var(--calc-text-muted)]"],[1,"planner-tip"],[4,"ngIf","ngIfElse"],[1,"planner-collapse-slot"],["type","button",1,"planner-collapse-toggle",3,"click"],[3,"name"],["mode","ios",1,"app-segment","mt-2","p-[2px]",3,"ionChange","value"],["value","progressive"],["value","lateKick"],["value","step"],[1,"mt-2","flex","items-center","justify-between"],[1,"text-sm","font-semibold"],["type","button","title","Reset to even splits",1,"reset-btn","subtle"],["mode","ios",1,"calc-range",3,"ionChange","ticks","snaps","disabled","min","max","step","value"],["slot","start"],["slot","end"],[1,"calc-warning-copy","calc-warning-slot","mt-1","text-xs"],["type","button","title","Reset to even splits",1,"reset-btn","subtle",3,"click"],["name","refresh-outline"],[1,"mt-1","text-xs","text-[var(--calc-text-muted)]"],[1,"flex","h-[280px]","items-center","justify-center"],["name","crescent",1,"text-center"],[2,"width","100%","height","280px","display","block",3,"Highcharts","options"],[1,"calc-table-shell","splits-table-shell","p-0"],[1,"splits-table-head","splits-grid","calc-table-head","calc-divider-subtle","bg-[var(--calc-surface-1)]/95","sticky","top-0","z-20","border-b","px-2","py-1"],[1,"text-center"],[1,"splits-effort-head"],[1,"px-2","pb-2","pt-1"],[1,"splits-row","splits-grid","py-0.5",3,"splits-grid-no-effort"],["type","button","title","Reset all lap efforts to flat",1,"reset-btn","subtle"],["type","button","title","Reset all lap efforts to flat",1,"reset-btn","subtle",3,"click"],[1,"splits-row","splits-grid","py-0.5"],[1,"splits-cell","splits-cell-lap"],[1,"splits-cell","splits-cell-distance"],[1,"splits-cell","splits-cell-pace"],[1,"splits-cell","splits-cell-effort"],[1,"splits-cell","splits-cell-time"],[1,"splits-cell","splits-cell-cumulative"],["type","button",1,"lap-tag-btn","text-xs",3,"click","disabled"],[1,"calc-surface-card","p-4","text-center"],[1,"mb-3","text-left","text-sm","font-bold","uppercase","tracking-[0.08em]","text-[var(--calc-text-muted)]"],[1,"panel-empty-state"],[1,"panel-empty-title"],[1,"panel-empty-copy"]],template:function(t,n){t&1&&x(0,Qa,25,13,"div",1)(1,to,17,5,"div",2)(2,no,9,0,"div",3),t&2&&(C(n.splits.length?0:-1),d(),C(n.splits.length?1:2))},dependencies:[$,Be,ze,We,H,le,vt,je,Z,Q,On,$i,Fi],styles:[".calc-table-head[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--calc-text-muted);font-size:.75rem;font-weight:600}.planner-body[_ngcontent-%COMP%]{max-height:900px;opacity:1;overflow:hidden;transition:max-height var(--calc-motion-normal) var(--calc-motion-ease),opacity var(--calc-motion-normal) var(--calc-motion-ease),margin var(--calc-motion-normal) var(--calc-motion-ease)}.planner-body-inner[_ngcontent-%COMP%]{overflow:hidden}.planner-body-collapsed[_ngcontent-%COMP%]{max-height:0;opacity:0;margin-top:0;pointer-events:none}.planner-controls-card[_ngcontent-%COMP%]{transition:padding-bottom var(--calc-motion-normal) var(--calc-motion-ease)}.planner-controls-card-collapsed[_ngcontent-%COMP%]{padding-bottom:.5rem}.planner-collapse-toggle[_ngcontent-%COMP%]{width:40px;height:40px;border:1px solid color-mix(in oklab,var(--calc-border-subtle) 70%,transparent);border-radius:9999px;background:color-mix(in oklab,var(--calc-surface-2) 76%,var(--calc-surface-1));color:var(--calc-text-muted);display:flex;align-items:center;justify-content:center;position:absolute;top:0;left:50%;transform:translate(-50%);transition:left var(--calc-motion-normal) var(--calc-motion-ease),transform var(--calc-motion-normal) var(--calc-motion-ease)}.planner-collapse-toggle[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.15rem}.planner-collapse-slot[_ngcontent-%COMP%]{position:relative;margin-top:.5rem;height:40px;transition:height var(--calc-motion-normal) var(--calc-motion-ease),margin var(--calc-motion-normal) var(--calc-motion-ease)}.planner-collapse-slot-collapsed[_ngcontent-%COMP%]   .planner-collapse-toggle[_ngcontent-%COMP%]{left:calc(100% - 8px);transform:translate(-100%,-54px)}.planner-collapse-slot-collapsed[_ngcontent-%COMP%]{height:0;margin-top:0}.reset-btn[_ngcontent-%COMP%]{align-items:center;border-radius:9999px;display:inline-flex;justify-content:center;padding:.15rem;font-size:.85rem}.reset-btn.subtle[_ngcontent-%COMP%]{background:var(--calc-surface-stripe);border:1px solid var(--calc-border-subtle);color:var(--calc-text-muted);transition:all .15s ease}.reset-btn.subtle[_ngcontent-%COMP%]:hover{background:var(--calc-info-bg);border-color:var(--calc-border-strong);color:var(--calc-accent)}.lap-tag-btn[_ngcontent-%COMP%]{align-items:center;border-radius:9999px;border:1px solid var(--calc-border-subtle);display:inline-flex;justify-content:center;min-width:4.2rem;padding:.18rem .45rem;font-weight:600}.lap-tag-btn[disabled][_ngcontent-%COMP%]{opacity:.5}.lap-tag-uphill[_ngcontent-%COMP%]{border-color:color-mix(in oklab,#ef4444 35%,transparent);color:#b91c1c}.lap-tag-downhill[_ngcontent-%COMP%]{border-color:color-mix(in oklab,#2563eb 35%,transparent);color:#1d4ed8}.dark[_nghost-%COMP%]   .lap-tag-uphill[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .lap-tag-uphill[_ngcontent-%COMP%]{border-color:color-mix(in oklab,#f87171 45%,transparent);color:#fca5a5}.dark[_nghost-%COMP%]   .lap-tag-downhill[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .lap-tag-downhill[_ngcontent-%COMP%]{border-color:color-mix(in oklab,#60a5fa 45%,transparent);color:#93c5fd}.splits-row[_ngcontent-%COMP%]:nth-child(odd){background:var(--calc-surface-stripe);border-radius:.75rem}.splits-grid[_ngcontent-%COMP%]{display:grid;align-items:center;column-gap:.28rem;grid-template-columns:2rem minmax(3.2rem,.95fr) minmax(3.2rem,.85fr) minmax(5rem,1.25fr) minmax(4.5rem,1fr) minmax(4.6rem,1fr)}.splits-grid.splits-grid-no-effort[_ngcontent-%COMP%]{grid-template-columns:2rem minmax(3.2rem,1fr) minmax(3.2rem,.9fr) minmax(4.5rem,1fr) minmax(4.6rem,1fr)}.splits-table-head[_ngcontent-%COMP%]{padding-top:.3rem;padding-bottom:.3rem}.splits-table-head[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.splits-effort-head[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:.35rem;min-width:0}.splits-cell[_ngcontent-%COMP%]{margin:0;font-size:.875rem;text-align:center}.splits-cell-lap[_ngcontent-%COMP%], .splits-cell-pace[_ngcontent-%COMP%], .splits-cell-time[_ngcontent-%COMP%], .splits-cell-cumulative[_ngcontent-%COMP%]{font-variant-numeric:tabular-nums}.splits-cell-distance[_ngcontent-%COMP%]{white-space:pre-line;line-height:1.15}.splits-cell-effort[_ngcontent-%COMP%]{display:flex;justify-content:center}.splits-cell-cumulative[_ngcontent-%COMP%]{white-space:nowrap}.planner-tip[_ngcontent-%COMP%]{margin-top:.5rem;padding:.32rem .55rem;border-radius:9999px;border:1px solid color-mix(in oklab,var(--calc-border-subtle) 68%,transparent);background:color-mix(in oklab,var(--calc-surface-2) 64%,var(--calc-surface-1));color:var(--calc-text-muted);font-size:.64rem;font-weight:600;letter-spacing:.01em;line-height:1;text-align:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.splits-empty-table[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;gap:.35rem;text-align:center;border:1px dashed color-mix(in oklab,var(--calc-border-subtle) 75%,transparent);border-radius:.75rem;background:color-mix(in oklab,var(--calc-surface-stripe) 66%,transparent);min-height:7.5rem}.splits-empty-title[_ngcontent-%COMP%]{margin:0;font-size:.82rem;font-weight:700;color:var(--calc-text-strong)}.splits-empty-copy[_ngcontent-%COMP%]{margin:0;font-size:.74rem;color:var(--calc-text-muted)}.calc-warning-slot[_ngcontent-%COMP%]{visibility:hidden;opacity:0;min-height:1rem;transition:opacity var(--calc-motion-fast) var(--calc-motion-ease)}.calc-warning-slot-visible[_ngcontent-%COMP%]{visibility:visible;opacity:1}@media (max-width: 430px){.splits-grid[_ngcontent-%COMP%]{column-gap:.2rem;grid-template-columns:1.7rem minmax(2.8rem,.95fr) minmax(2.8rem,.85fr) minmax(4.3rem,1.2fr) minmax(3.9rem,1fr) minmax(4rem,1fr)}.splits-grid.splits-grid-no-effort[_ngcontent-%COMP%]{grid-template-columns:1.7rem minmax(2.8rem,1fr) minmax(2.8rem,.9fr) minmax(3.9rem,1fr) minmax(4rem,1fr)}.splits-table-head[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.68rem}.splits-cell[_ngcontent-%COMP%]{font-size:.8rem}.lap-tag-btn[_ngcontent-%COMP%]{min-width:3.9rem;padding:.16rem .35rem}}@media (prefers-reduced-motion: reduce){.planner-body[_ngcontent-%COMP%], .planner-controls-card[_ngcontent-%COMP%], .planner-collapse-slot[_ngcontent-%COMP%], .planner-collapse-toggle[_ngcontent-%COMP%]{transition:none}}"]});let r=l;return r})();var io=["roadPane"],ao=["trackPane"],Xt=(r,l)=>l.type;function oo(r,l){r&1&&(a(0,"p",7),s(1,"Tap on each pace type to learn more"),o())}function ro(r,l){r&1&&(a(0,"div",8)(1,"p",10),s(2,"No training paces"),o(),a(3,"p",11),s(4,"Enter a pace and time above 0 to generate training guidance."),o()())}function lo(r,l){if(r&1){let i=k();a(0,"tr",18)(1,"td",20)(2,"button",21),u("click",function(){let t=g(i).$implicit,n=p(2);return f(n.onRoadTypeInfo(t))}),s(3),o()(),a(4,"td",22),s(5),o(),a(6,"td",22),s(7),o()()}if(r&2){let i=l.$implicit,e=p(2);d(3),T(" ",i.label," "),d(2),T(" ",e.formatCell(i.pacePerMi)," "),d(2),T(" ",e.formatCell(i.pacePerKm)," ")}}function so(r,l){if(r&1&&(a(0,"th",17),s(1),o()),r&2){let i=l.$implicit;d(),v(i)}}function co(r,l){if(r&1&&(a(0,"td",22),s(1),o()),r&2){let i=l.$implicit,e=p().$implicit;d(),v(e.times[i])}}function mo(r,l){if(r&1){let i=k();a(0,"tr",18)(1,"td",20)(2,"button",21),u("click",function(){let t=g(i).$implicit,n=p(2);return f(n.onTrackTypeInfo(t,n.primaryHeaders))}),s(3),o()(),S(4,co,2,1,"td",22,ot),o()}if(r&2){let i=l.$implicit,e=p(2);d(3),T(" ",i.label," "),d(),O(e.primaryHeaders)}}function po(r,l){if(r&1&&(a(0,"th",17),s(1),o()),r&2){let i=l.$implicit;d(),v(i)}}function uo(r,l){if(r&1&&(a(0,"td",22),s(1),o()),r&2){let i=l.$implicit,e=p().$implicit;d(),v(e.times[i])}}function ho(r,l){if(r&1){let i=k();a(0,"tr",18)(1,"td",20)(2,"button",21),u("click",function(){let t=g(i).$implicit,n=p(2);return f(n.onTrackTypeInfo(t,n.secondaryHeaders))}),s(3),o()(),S(4,uo,2,1,"td",22,ot),o()}if(r&2){let i=l.$implicit,e=p(2);d(3),T(" ",i.label," "),d(),O(e.secondaryHeaders)}}function go(r,l){if(r&1&&(a(0,"div",12)(1,"div",13,0)(3,"div",14)(4,"table",15)(5,"thead",16)(6,"tr")(7,"th",17),s(8,"Type"),o(),a(9,"th",17),s(10,"1 Mi"),o(),a(11,"th",17),s(12,"1 Km"),o()()(),a(13,"tbody"),S(14,lo,8,3,"tr",18,Xt),o()()()(),a(16,"div",13,1)(18,"div",14)(19,"table",15)(20,"thead",16)(21,"tr")(22,"th",17),s(23,"Type"),o(),S(24,so,2,1,"th",17,ot),o()(),a(26,"tbody"),S(27,mo,6,1,"tr",18,Xt),o()()(),a(29,"div",19)(30,"table",15)(31,"thead",16)(32,"tr")(33,"th",17),s(34,"Type"),o(),S(35,po,2,1,"th",17,ot),o()(),a(37,"tbody"),S(38,ho,6,1,"tr",18,Xt),o()()()()()),r&2){let i=p();ut("height",i.tableStackHeightPx,"px"),d(),w("table-mode-pane-active",i.tableMode==="road"),L("aria-hidden",i.tableMode==="road"?"false":"true")("inert",i.tableMode==="road"?null:""),d(13),O(i.trainingRows),d(2),w("table-mode-pane-active",i.tableMode==="track"),L("aria-hidden",i.tableMode==="track"?"false":"true")("inert",i.tableMode==="track"?null:""),d(8),O(i.primaryHeaders),d(3),O(i.repRowsPrimary),d(8),O(i.secondaryHeaders),d(3),O(i.repRowsSecondary)}}var Ni=(()=>{let l=class l{constructor(){this.tableMode="road",this.trainingRows=[],this.repRowsPrimary=[],this.repRowsSecondary=[],this.openTypeInfo=new z,this.primaryHeaders=["1200m","800m","600m"],this.secondaryHeaders=["400m","300m","200m"],this.tableStackHeightPx=null,this.isViewReady=!1,this.resizeRafId=null}ngAfterViewInit(){this.isViewReady=!0,this.syncTableStackHeight(!1)}ngOnChanges(e){this.isViewReady&&this.syncTableStackHeight(!0)}ngOnDestroy(){this.resizeRafId!==null&&(cancelAnimationFrame(this.resizeRafId),this.resizeRafId=null)}formatCell(e){return typeof e=="string"?e:`${e.min} ~ ${e.max}`}onRoadTypeInfo(e){this.openTypeInfo.emit({type:e.type,suggestedPaces:[{label:"1 Mi",value:this.formatCell(e.pacePerMi)},{label:"1 Km",value:this.formatCell(e.pacePerKm)}]})}onTrackTypeInfo(e,t){let n=[];for(let c of t){let m=e.times[c];m&&n.push({label:c,value:m})}this.openTypeInfo.emit({type:e.type,suggestedPaces:n})}syncTableStackHeight(e){let t=this.getActivePaneHeight();if(t<=0)return;if(!e||this.tableStackHeightPx===null){this.tableStackHeightPx=t;return}let n=this.tableStackHeightPx;n!==t&&(this.resizeRafId!==null&&(cancelAnimationFrame(this.resizeRafId),this.resizeRafId=null),this.tableStackHeightPx=n,this.resizeRafId=requestAnimationFrame(()=>{this.tableStackHeightPx=t,this.resizeRafId=null}))}getActivePaneHeight(){var t,n;let e=this.tableMode==="track"?(t=this.trackPane)==null?void 0:t.nativeElement:(n=this.roadPane)==null?void 0:n.nativeElement;return e?e.offsetHeight+1:0}get hasTrainingData(){return this.trainingRows.length>0}};l.\u0275fac=function(t){return new(t||l)},l.\u0275cmp=R({type:l,selectors:[["app-training-paces-panel"]],viewQuery:function(t,n){if(t&1&&(Me(io,5),Me(ao,5)),t&2){let c;Se(c=Oe())&&(n.roadPane=c.first),Se(c=Oe())&&(n.trackPane=c.first)}},inputs:{tableMode:"tableMode",trainingRows:"trainingRows",repRowsPrimary:"repRowsPrimary",repRowsSecondary:"repRowsSecondary"},outputs:{openTypeInfo:"openTypeInfo"},features:[Ve],decls:9,vars:2,consts:[["roadPane",""],["trackPane",""],[1,"mx-auto","max-w-5xl","px-2","pt-2","mobile-bottom-safe"],[1,"calc-surface-card","p-4"],[1,"mb-3"],[1,"flex","items-center","justify-between","gap-3"],[1,"text-sm","font-bold","uppercase","tracking-[0.08em]","text-[var(--calc-text-muted)]"],[1,"mt-2","text-xs","text-[var(--calc-text-muted)]"],[1,"panel-empty-state"],[1,"table-mode-stack",3,"height"],[1,"panel-empty-title"],[1,"panel-empty-copy"],[1,"table-mode-stack"],[1,"table-mode-pane"],[1,"calc-shell-subtle","overflow-hidden","rounded-xl"],[1,"w-full","text-sm"],[1,"bg-[var(--calc-surface-2)]","text-[var(--calc-text-muted)]"],[1,"px-3","py-2","text-left","text-xs","font-semibold","uppercase","tracking-[0.08em]"],[1,"calc-divider-subtle","border-t"],[1,"calc-shell-subtle","mt-4","overflow-hidden","rounded-xl"],[1,"px-3","py-2"],["type","button",1,"result-link",3,"click"],[1,"px-3","py-2","font-semibold","text-[var(--calc-text-strong)]"]],template:function(t,n){t&1&&(a(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"h2",6),s(5,"Paces"),o()(),x(6,oo,2,0,"p",7),o(),x(7,ro,5,0,"div",8)(8,go,40,10,"div",9),o()()),t&2&&(d(6),C(n.hasTrainingData?6:-1),d(),C(n.hasTrainingData?8:7))},dependencies:[$],styles:[".table-mode-stack[_ngcontent-%COMP%]{position:relative;overflow:hidden;transition:height var(--calc-motion-normal) var(--calc-motion-ease)}.table-mode-pane[_ngcontent-%COMP%]{transition:opacity var(--calc-motion-normal) var(--calc-motion-ease)}.table-mode-pane[_ngcontent-%COMP%]:not(.table-mode-pane-active){position:absolute;top:0;left:0;right:0;opacity:0;pointer-events:none}.table-mode-pane-active[_ngcontent-%COMP%]{position:relative;opacity:1}.result-link[_ngcontent-%COMP%]{min-height:26px;display:inline-flex;justify-content:center;align-items:center;font-size:.75rem;font-weight:600;color:var(--calc-text-strong);background:color-mix(in oklab,var(--calc-surface-2) 68%,var(--calc-surface-1));border:1px solid var(--calc-border-strong);border-radius:9999px;padding:0 .6rem;white-space:nowrap;transition:transform var(--calc-motion-fast) var(--calc-motion-ease),background-color var(--calc-motion-fast) var(--calc-motion-ease)}.result-link[_ngcontent-%COMP%]:active{transform:scale(.96);background:color-mix(in oklab,var(--calc-surface-3) 88%,var(--calc-surface-2))}@media (prefers-reduced-motion: reduce){.table-mode-stack[_ngcontent-%COMP%], .table-mode-pane[_ngcontent-%COMP%]{transition:none}}"]});let r=l;return r})();var zi={easy:{title:"Easy Pace",variety:"Easy pace running refers to warm-ups, cool-downs, recovery runs, recovery running within a workout, and generally long runs.",intensity:"Generally in the range of 59-74% VO2max or 65-79% of LTHR effort. This is a comfortable conversational pace that may vary by heat, terrain, and fatigue.",purpose:"Builds aerobic base and durability so higher-intensity training can be absorbed. Supports recovery while adding useful low-stress volume.",sampleWorkout:"30-45 minutes easy, or easy long run with relaxed finish."},marathon:{title:"Marathon Pace",variety:"Used in sustained marathon-specific tempo runs and long runs with marathon-effort blocks.",intensity:"Steady and controlled effort, typically around 75-84% VO2max for well-trained runners. Feels strong but sustainable for a long duration.",purpose:"Improves fuel efficiency, rhythm, and muscular endurance needed for long race pacing without crossing threshold effort.",sampleWorkout:"2 x 20 minutes at marathon pace with 5 minutes easy between blocks."},threshold:{title:"Threshold Pace",variety:"Used for tempo runs and cruise intervals where recovery is short and rhythm remains controlled.",intensity:"Comfortably hard effort close to one-hour race pace. Speech is limited to short phrases and breathing is deep but controlled.",purpose:"Raises lactate threshold so a faster pace can be sustained aerobically for longer race efforts.",sampleWorkout:"4 x 8 minutes at threshold pace with 2 minutes easy jog recoveries."},interval:{title:"Interval Pace",variety:"VO2max-focused repeats of roughly 3-5 minutes with equal or slightly shorter recoveries.",intensity:"Hard effort near VO2max. Breathing is heavy and the final reps are challenging while still keeping split consistency.",purpose:"Improves oxygen uptake and aerobic power so race pace feels more economical.",sampleWorkout:"5 x 1000m at interval pace with 2:30-3:00 jog recovery."},repetition:{title:"Repetition Pace",variety:"Short fast reps with full recovery, often on track, focused on quality over fatigue.",intensity:"Very hard but not all-out. Reps should feel smooth and precise with complete reset before the next repeat.",purpose:"Develops running economy, mechanics, and neuromuscular speed without deep metabolic stress.",sampleWorkout:"8 x 200m at repetition pace with full walk/jog recovery."},fastReps:{title:"Fast Reps",variety:"Very short repetition work used for top-end turnover and sharpeners near race phases.",intensity:"Fast, relaxed, and technically clean. Effort is high, but total session stress stays controlled through long recoveries.",purpose:"Improves leg speed, coordination, and running economy at high cadence.",sampleWorkout:"10 x 200m fast reps with full recovery and smooth form focus."}};var fo=(r,l)=>l.label;function _o(r,l){if(r&1&&(a(0,"div",13)(1,"p",14),s(2),o(),a(3,"p",15),s(4),o()()),r&2){let i=l.$implicit;d(2),T(" ",i.label," "),d(2),v(i.value)}}function bo(r,l){if(r&1&&(a(0,"div",7)(1,"p",11),s(2," Suggested Pace for your Goal Time "),o(),a(3,"div",12),S(4,_o,5,2,"div",13,fo),o()()),r&2){let i=p();d(4),O(i.suggestedPaces)}}var Hi=(()=>{let l=class l{constructor(){this.modalCtrl=A(q),this.suggestedPaces=[],W({arrowBackOutline:X})}dismiss(){this.modalCtrl.dismiss()}};l.\u0275fac=function(t){return new(t||l)},l.\u0275cmp=R({type:l,selectors:[["app-training-pace-info-modal"]],inputs:{typeInfo:"typeInfo",suggestedPaces:"suggestedPaces"},decls:31,vars:6,consts:[[1,"training-info-header","safe-area-inline"],[1,"training-info-toolbar"],["slot","start"],["aria-label","Back","fill","clear",1,"training-info-back-btn",3,"click"],["slot","icon-only","name","arrow-back-outline"],[1,"ion-padding","safe-area-content"],[1,"mx-auto","flex","max-w-md","flex-col","gap-4","py-4","mobile-bottom-safe"],[1,"calc-shell-subtle","training-suggested-card","mx-3","rounded-xl","p-3"],[1,"calc-surface-card","mx-3","mb-5","flex","flex-col","gap-5","px-4","py-4"],[1,"text-primary","mb-1","text-xs","font-bold","uppercase","tracking-wider"],[1,"text-[15px]","leading-relaxed","text-[var(--calc-text-strong)]"],[1,"calc-muted-copy","text-xs","font-semibold","uppercase","tracking-[0.08em]"],[1,"mt-2","grid","grid-cols-2","gap-2"],[1,"training-suggested-metric","rounded-lg","px-2","py-2"],[1,"calc-muted-copy","text-[10px]","font-semibold","uppercase","tracking-[0.08em]"],[1,"text-sm","font-bold","text-[var(--calc-text-strong)]"]],template:function(t,n){t&1&&(a(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-button",3),u("click",function(){return n.dismiss()}),b(4,"ion-icon",4),o()(),a(5,"ion-title"),s(6),o()()(),a(7,"ion-content",5)(8,"div",6),x(9,bo,6,0,"div",7),a(10,"div",8)(11,"div")(12,"div",9),s(13,"Variety"),o(),a(14,"div",10),s(15),o()(),a(16,"div")(17,"div",9),s(18,"Intensity"),o(),a(19,"div",10),s(20),o()(),a(21,"div")(22,"div",9),s(23,"Purpose"),o(),a(24,"div",10),s(25),o()(),a(26,"div")(27,"div",9),s(28,"Sample Workout"),o(),a(29,"div",10),s(30),o()()()()()),t&2&&(d(6),v(n.typeInfo.title||"Training Pace"),d(3),C(n.suggestedPaces.length>0?9:-1),d(6),v(n.typeInfo.variety),d(5),v(n.typeInfo.intensity),d(5),v(n.typeInfo.purpose),d(5),v(n.typeInfo.sampleWorkout))},dependencies:[$,re,ce,se,oe,K,Y,H],styles:[".training-info-header[_ngcontent-%COMP%]{border-bottom:1px solid color-mix(in oklab,var(--calc-border-subtle) 80%,transparent)}.training-info-toolbar[_ngcontent-%COMP%]{--background: color-mix(in oklab, var(--calc-surface-raised) 86%, var(--calc-accent) 14%);--color: var(--calc-text-strong)}.training-info-back-btn[_ngcontent-%COMP%]{--color: var(--calc-text-strong)}.training-suggested-card[_ngcontent-%COMP%]{border-color:color-mix(in oklab,var(--calc-border-subtle) 86%,transparent);background:color-mix(in oklab,var(--calc-surface-raised) 82%,var(--calc-info-bg) 18%)}.training-suggested-metric[_ngcontent-%COMP%]{border:1px solid color-mix(in oklab,var(--calc-border-subtle) 86%,transparent);background:color-mix(in oklab,var(--calc-surface-raised) 88%,var(--calc-surface-1))}"]});let r=l;return r})();W({arrowBackOutline:X,openOutline:Tt});var Wi=(()=>{let l=class l{constructor(){this.modalCtrl=A(q)}dismiss(){this.modalCtrl.dismiss()}};l.\u0275fac=function(t){return new(t||l)},l.\u0275cmp=R({type:l,selectors:[["app-lthr-info-modal"]],decls:34,vars:0,consts:[[1,"lthr-header","safe-area-inline"],[1,"lthr-toolbar"],["slot","start"],["aria-label","Back","fill","clear",1,"lthr-back-btn",3,"click"],["slot","icon-only","name","arrow-back-outline"],[1,"ion-padding","safe-area-content"],[1,"mx-auto","flex","max-w-md","flex-col","gap-4","py-4","mobile-bottom-safe"],[1,"calc-surface-card","mx-3","mb-5","flex","flex-col","gap-5","px-4","py-4"],[1,"text-primary","mb-1","text-xs","font-bold","uppercase","tracking-wider"],[1,"text-[15px]","leading-relaxed","text-[var(--calc-text-strong)]"],[1,"pt-2"],["href","https://www.runnersworld.com/uk/training/a41865710/lactate-threshold/","target","_blank","rel","noopener noreferrer",1,"external-link"],["name","open-outline",1,"external-link-icon"]],template:function(t,n){t&1&&(a(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-button",3),u("click",function(){return n.dismiss()}),b(4,"ion-icon",4),o()(),a(5,"ion-title"),s(6,"How to use this"),o()()(),a(7,"ion-content",5)(8,"div",6)(9,"div",7)(10,"div")(11,"div",8),s(12,"What is LTHR?"),o(),a(13,"div",9),s(14," Lactate Threshold Heart Rate (LTHR) is the heart rate at which lactate begins to accumulate rapidly in your blood. Training at or near this threshold improves your body's ability to sustain faster paces for longer periods. "),o()(),a(15,"div")(16,"div",8),s(17,"How to find your LTHR"),o(),a(18,"div",9),s(19," The most accurate method is a lab test with blood lactate analysis. Alternatively, you can estimate it by running a 30-minute time trial all-out, then use your average heart rate from the last 20 minutes as your LTHR. Many modern running watches can also estimate this value. "),o()(),a(20,"div")(21,"div",8),s(22,"Benefits of LTHR training"),o(),a(23,"div",9),s(24," Training at threshold intensity raises your lactate threshold, allowing you to run faster before fatigue sets in. This is one of the most effective ways to improve race times from 5K to marathon distances. "),o()(),a(25,"div")(26,"div",8),s(27,"Using heart rate zones"),o(),a(28,"div",9),s(29," Enter your LTHR in bpm to see personalized heart rate zones. These zones help you train at the right intensity - easy runs stay aerobic (Z1-Z2), tempo runs target threshold (Z3-Z4), and intervals push into VO2max (Z5b) and anaerobic (Z5c) zones. "),o()(),a(30,"div",10)(31,"a",11),s(32," Learn more about lactate threshold training "),b(33,"ion-icon",12),o()()()()())},dependencies:[$,re,ce,se,oe,K,Y,H],styles:[".lthr-header[_ngcontent-%COMP%]{border-bottom:1px solid color-mix(in oklab,var(--calc-border-subtle) 80%,transparent)}.lthr-toolbar[_ngcontent-%COMP%]{--background: color-mix(in oklab, var(--calc-surface-raised) 86%, var(--calc-accent) 14%);--color: var(--calc-text-strong)}.lthr-back-btn[_ngcontent-%COMP%]{--color: var(--calc-text-strong)}.external-link[_ngcontent-%COMP%]{color:var(--calc-link);display:inline-flex;align-items:center;gap:.35rem;text-decoration:underline;text-underline-offset:2px;width:fit-content}.external-link-icon[_ngcontent-%COMP%]{font-size:.95rem;opacity:.9}"]});let r=l;return r})();var ji=(r,l)=>l.id;function xo(r,l){if(r&1&&(a(0,"p",16),s(1),o()),r&2){let i=p();d(),v(i.validationMessage())}}function Co(r,l){r&1&&(a(0,"ion-badge",35),s(1,"Built-in"),o())}function vo(r,l){if(r&1){let i=k();a(0,"ion-button",38),u("click",function(){g(i);let t=p().$implicit,n=p();return f(n.onRemoveCustomDistance(t.id))}),b(1,"ion-icon",39),o()}if(r&2){let i=p().$implicit,e=p();w("distance-manager-delete-btn-armed",e.isDeleteArmed(i.id)),h("disabled",e.isRowRemoving(i.id)),L("aria-label",e.isDeleteArmed(i.id)?"Tap again to delete "+i.type:"Tap to arm deletion for "+i.type),d(),h("name",e.isDeleteArmed(i.id)?"warning-outline":"trash-outline")}}function yo(r,l){if(r&1){let i=k();a(0,"ion-item",32),b(1,"ion-reorder",2),a(2,"ion-label")(3,"h3",33),s(4),o(),a(5,"p",34),s(6),o()(),x(7,Co,2,0,"ion-badge",35)(8,vo,2,5,"ion-button",36),a(9,"ion-toggle",37),u("ionChange",function(t){let n=g(i).$implicit,c=p();return f(c.setVisibility(n.id,t.detail.checked))}),o()()}if(r&2){let i=l.$implicit,e=p();w("distance-manager-item-hiding",e.rowTransitionState(i.id)==="hiding")("distance-manager-item-removing",e.isRowRemoving(i.id)),d(4),v(i.type),d(2),v(e.formatDistanceDetail(i.distanceInMeters)),d(),C(i.isCustom?-1:7),d(),C(i.isCustom?8:-1),d(),h("checked",i.isVisible)("disabled",e.isRowTransitionActive(i.id)),L("aria-label","Toggle visibility for "+i.type)}}function ko(r,l){if(r&1){let i=k();a(0,"ion-button",38),u("click",function(){g(i);let t=p().$implicit,n=p(3);return f(n.onRemoveCustomDistance(t.id))}),b(1,"ion-icon",39),o()}if(r&2){let i=p().$implicit,e=p(3);w("distance-manager-delete-btn-armed",e.isDeleteArmed(i.id)),h("disabled",e.isRowRemoving(i.id)),L("aria-label",e.isDeleteArmed(i.id)?"Tap again to delete "+i.type:"Tap to arm deletion for "+i.type),d(),h("name",e.isDeleteArmed(i.id)?"warning-outline":"trash-outline")}}function wo(r,l){if(r&1){let i=k();a(0,"ion-item",43)(1,"ion-label")(2,"h3",33),s(3),o(),a(4,"p",34),s(5),o()(),x(6,ko,2,5,"ion-button",36),a(7,"ion-toggle",37),u("ionChange",function(t){let n=g(i).$implicit,c=p(3);return f(c.setVisibility(n.id,t.detail.checked))}),o()()}if(r&2){let i=l.$implicit,e=p(3);w("distance-manager-item-showing",e.rowTransitionState(i.id)==="showing")("distance-manager-item-removing",e.isRowRemoving(i.id)),d(3),v(i.type),d(2),v(e.formatDistanceDetail(i.distanceInMeters)),d(),C(i.isCustom?6:-1),d(),h("checked",i.isVisible)("disabled",e.isRowTransitionActive(i.id)),L("aria-label","Toggle visibility for "+i.type)}}function Po(r,l){if(r&1&&(a(0,"div",41),S(1,wo,8,10,"ion-item",42,ji),o()),r&2){let i=p(2);d(),O(i.hiddenResults())}}function To(r,l){if(r&1){let i=k();a(0,"div",27)(1,"ion-button",40),u("click",function(){g(i);let t=p();return f(t.hiddenExpanded.set(!t.hiddenExpanded()))}),s(2),o(),x(3,Po,3,0,"div",41),o()}if(r&2){let i=p();d(2),te(" ",i.hiddenExpanded()?"Hide":"Show"," Hidden (",i.hiddenResults().length,") "),d(),C(i.hiddenExpanded()?3:-1)}}var Mo=20,So=170,Oo=170,Io=2500,Ui=(()=>{let l=class l{constructor(){this.results=[],this.alertCtrl=A(Ct),this.modalCtrl=A(q),this.platform=A(Ne),this.toastCtrl=A(Pe),this.initialStateSnapshot="",this.rowTransitionTimers=new Map,this.rowRemovalTimers=new Map,this.pendingRowRemovals=new Map,this.editableResults=D([]),this.rowVisibilityTransitions=D({}),this.rowRemovalTransitions=D({}),this.deleteArmedRowId=D(null),this.validationMessage=D(""),this.hiddenExpanded=D(!1),this.hasActiveVisibilityTransitions=U(()=>Object.keys(this.rowVisibilityTransitions()).length>0),this.visibleResults=U(()=>{let e=this.rowVisibilityTransitions();return this.editableResults().filter(t=>{let n=e[t.id];return n==="hiding"?!0:n==="showing"?!1:t.isVisible})}),this.hiddenResults=U(()=>{let e=this.rowVisibilityTransitions();return this.editableResults().filter(t=>{let n=e[t.id];return n==="showing"?!0:n==="hiding"?!1:!t.isVisible})}),this.maxCustomLabelLength=Mo,this.draftType="",this.draftDistanceValue="",this.draftDistanceUnit="km",W({arrowBackOutline:X,addOutline:Ke,trashOutline:Ot,warningOutline:It})}ngOnInit(){this.editableResults.set(this.normalizeVisibilityOrdering(this.results.map((e,t)=>this.toEditableResult(e,t)))),this.initialStateSnapshot=this.serializeResults(this.editableResults()),this.backButtonSubscription=this.platform.backButton.subscribeWithPriority(2e3,()=>{this.requestDismiss()})}ngOnDestroy(){var e,t;(e=this.backButtonSubscription)==null||e.unsubscribe(),this.clearAllVisibilityTransitions(),this.clearAllRowRemovals(),this.clearDeleteArm(),(t=this.activeUndoToast)==null||t.dismiss()}async dismiss(){await this.requestDismiss()}save(){this.clearDeleteArm(),this.finalizeVisibilityTransitions(),this.finalizeRowRemovals();let e=this.editableResults().map(t=>j(N({},t),{isVisible:t.isVisible,isCustom:t.isCustom}));this.modalCtrl.dismiss({results:e},"save")}async confirmReset(){await(await this.alertCtrl.create({header:"Reset distances?",message:"This restores default order/visibility and removes all custom distances.",buttons:[{text:"Cancel",role:"cancel"},{text:"Reset",role:"destructive",handler:()=>{this.resetToDefaults()}}]})).present()}resetToDefaults(){this.clearDeleteArm(),this.clearAllVisibilityTransitions(),this.clearAllRowRemovals();let e=new Map(this.editableResults().map(n=>[n.id,n])),t=li().map(n=>{let c=e.get(n.id);return j(N({},n),{pace:(c==null?void 0:c.pace)??n.pace,time:(c==null?void 0:c.time)??n.time,isVisible:!0,isCustom:!1})});this.editableResults.set(this.normalizeVisibilityOrdering(t)),this.hiddenExpanded.set(!1),this.validationMessage.set("")}onReorder(e){if(this.clearDeleteArm(),this.hasActiveVisibilityTransitions()||this.hasActiveRowRemovals()){e.detail.complete(!1);return}let t=[...this.editableResults()],n=t.splice(e.detail.from,1)[0];t.splice(e.detail.to,0,n),this.editableResults.set(this.normalizeVisibilityOrdering(t)),e.detail.complete()}setVisibility(e,t){this.clearDeleteArm(e);let n=this.editableResults().find(c=>c.id===e);!n||n.isVisible===t||(this.editableResults.update(c=>c.map(m=>m.id===e?j(N({},m),{isVisible:t}):m)),this.startVisibilityTransition(e,t?"showing":"hiding"))}onRemoveCustomDistance(e){if(!this.isRowRemoving(e)){if(this.deleteArmedRowId()!==e){this.armDelete(e);return}this.clearDeleteArm(e),this.startCustomRowRemoval(e)}}onDraftDistanceUnitChange(e){let t=e.detail.value;this.draftDistanceUnit=t==="mi"?"mi":"km"}addDistance(){this.clearDeleteArm(),this.validationMessage.set("");let e=Number(this.draftDistanceValue);if(!Number.isFinite(e)||e<=0){this.validationMessage.set("Distance must be a positive number.");return}let t=this.draftDistanceUnit==="km"?e*1e3:e*1609.344;if(t>5e5){this.validationMessage.set("Distance must be 500 km or less.");return}let n=Number(t.toFixed(3)),c=this.draftType.trim().length?this.draftType.trim().slice(0,this.maxCustomLabelLength):`${this.normalizeDistanceInputValue(e)}${this.draftDistanceUnit}`;if(this.editableResults().some(B=>B.type.toLowerCase()===c.toLowerCase())){this.validationMessage.set("That label already exists.");return}let _=this.getNextCustomId(),P=this.getDefaultSplitDistanceByForDistance(n),y={id:_,type:c,distanceInMeters:n,splitDistanceBy:P,pace:"00:00",time:"00:00:00",isVisible:!0,isCustom:!0};this.editableResults.update(B=>this.normalizeVisibilityOrdering([...B,y])),this.draftType="",this.draftDistanceValue="",this.draftDistanceUnit="km"}canAddDistance(){if(typeof this.draftDistanceValue=="number")return Number.isFinite(this.draftDistanceValue)&&this.draftDistanceValue>0;if(typeof this.draftDistanceValue=="string"){let e=this.draftDistanceValue.trim();if(!e.length)return!1;let t=Number(e);return Number.isFinite(t)&&t>0}return!1}labelCharacterCount(){return this.draftType.length}rowTransitionState(e){return this.rowVisibilityTransitions()[e]??null}isRowRemoving(e){return this.rowRemovalTransitions()[e]===!0}isRowTransitionActive(e){return this.rowTransitionState(e)!==null||this.isRowRemoving(e)}isDeleteArmed(e){return this.deleteArmedRowId()===e}formatDistanceDetail(e){if(e<1e3)return`${Math.round(e)}m`;let t=e/1e3,n=e/1609.344,c=Number.isInteger(t)?`${t.toFixed(0)} km`:`${t.toFixed(2).replace(/\.?0+$/,"")} km`,m=Number.isInteger(n)?`${n.toFixed(0)} mi`:`${n.toFixed(2).replace(/\.?0+$/,"")} mi`;return`${c} \u2022 ${m}`}toEditableResult(e,t){let n=typeof e.id=="number"?e.id:1e3+t,c=Number(e.distanceInMeters),m=Number.isFinite(c)&&c>0?c:1e3,_=this.getDefaultSplitDistanceByForDistance(m),P=this.normalizeSplitDistanceBy(e.splitDistanceBy,_),y=typeof e.type=="string"&&e.type.trim().length>0?e.type.trim():this.formatDistanceTypeFromMeters(m);return j(N({},e),{id:n,type:y,distanceInMeters:m,pace:typeof e.pace=="string"?e.pace:"00:00",time:typeof e.time=="string"?e.time:"00:00:00",splitDistanceBy:P,isVisible:e.isVisible!==!1,isCustom:e.isCustom===!0||n>=1e3})}normalizeDistanceInputValue(e){return Number.isInteger(e)?e.toFixed(0):e.toFixed(2).replace(/\.?0+$/,"")}getDefaultSplitDistanceByForDistance(e){return e<=2e3?"400m":e<=7500?"800m":e<=3e4?"1km":e<=12e4?"5km":"10km"}normalizeSplitDistanceBy(e,t){return e==="400m"||e==="800m"||e==="1km"||e==="1mi"||e==="5km"||e==="10km"?e:t}formatDistanceTypeFromMeters(e){if(e<1e3)return`${Math.round(e)}m`;let t=e/1e3;return Number.isInteger(t)?`${t.toFixed(0)}km`:`${t.toFixed(2)}km`}getNextCustomId(){let e=new Set(this.editableResults().map(n=>n.id)),t=1e3;for(;e.has(t);)t+=1;return t}normalizeVisibilityOrdering(e){let t=e.filter(c=>c.isVisible),n=e.filter(c=>!c.isVisible);return[...t,...n]}startVisibilityTransition(e,t){this.clearTransitionTimer(e),this.rowVisibilityTransitions.update(c=>j(N({},c),{[e]:t}));let n=setTimeout(()=>{this.completeVisibilityTransition(e)},So);this.rowTransitionTimers.set(e,n)}completeVisibilityTransition(e){this.clearTransitionTimer(e),this.rowVisibilityTransitions.update(t=>{if(!(e in t))return t;let n=N({},t);return delete n[e],n}),!this.hasActiveVisibilityTransitions()&&this.editableResults.update(t=>this.normalizeVisibilityOrdering(t))}hasActiveRowRemovals(){return Object.keys(this.rowRemovalTransitions()).length>0}armDelete(e){this.clearDeleteArm(),this.deleteArmedRowId.set(e),this.deleteArmTimer=setTimeout(()=>{this.deleteArmedRowId.set(null),this.deleteArmTimer=void 0},Io)}clearDeleteArm(e){let t=this.deleteArmedRowId();e!==void 0&&t!==e||(this.deleteArmTimer&&(clearTimeout(this.deleteArmTimer),this.deleteArmTimer=void 0),this.deleteArmedRowId.set(null))}startCustomRowRemoval(e){let t=this.editableResults(),n=t.findIndex(_=>_.id===e&&_.isCustom);if(n<0)return;let c=t[n];this.clearTransitionForRow(e),this.rowRemovalTransitions.update(_=>j(N({},_),{[e]:!0})),this.pendingRowRemovals.set(e,{row:c,index:n});let m=setTimeout(()=>{this.completeCustomRowRemoval(e)},Oo);this.rowRemovalTimers.set(e,m)}async completeCustomRowRemoval(e){this.clearRowRemovalTimer(e);let t=this.pendingRowRemovals.get(e);t&&(this.pendingRowRemovals.delete(e),this.rowRemovalTransitions.update(n=>{if(!(e in n))return n;let c=N({},n);return delete c[e],c}),this.editableResults.update(n=>this.normalizeVisibilityOrdering(n.filter(c=>c.id!==e))),await this.presentUndoDeleteToast(t.row,t.index))}finalizeRowRemovals(){if(!this.pendingRowRemovals.size)return;let e=[...this.pendingRowRemovals.keys()];for(let t of e)this.pendingRowRemovals.delete(t),this.clearRowRemovalTimer(t);this.rowRemovalTransitions.set({}),this.editableResults.update(t=>this.normalizeVisibilityOrdering(t.filter(n=>!e.includes(n.id))))}clearAllRowRemovals(){for(let e of this.rowRemovalTimers.values())clearTimeout(e);this.rowRemovalTimers.clear(),this.pendingRowRemovals.clear(),this.rowRemovalTransitions.set({})}clearRowRemovalTimer(e){let t=this.rowRemovalTimers.get(e);t&&(clearTimeout(t),this.rowRemovalTimers.delete(e))}async presentUndoDeleteToast(e,t){this.activeUndoToast&&(await this.activeUndoToast.dismiss(),this.activeUndoToast=void 0);let n=await this.toastCtrl.create({message:`${e.type} removed`,duration:3e3,position:"bottom",positionAnchor:"distance-manager-done-footer",buttons:[{text:"Undo",role:"cancel",handler:()=>{this.undoRowRemoval(e,t)}}]});this.activeUndoToast=n,await n.present()}undoRowRemoval(e,t){this.clearDeleteArm(),this.editableResults.update(n=>{let c=Math.min(Math.max(t,0),n.length),m=[...n];return m.splice(c,0,e),this.normalizeVisibilityOrdering(m)})}finalizeVisibilityTransitions(){this.hasActiveVisibilityTransitions()&&(this.clearAllVisibilityTransitions(),this.editableResults.update(e=>this.normalizeVisibilityOrdering(e)))}clearTransitionForRow(e){this.clearTransitionTimer(e),this.rowVisibilityTransitions.update(t=>{if(!(e in t))return t;let n=N({},t);return delete n[e],n})}clearAllVisibilityTransitions(){for(let e of this.rowTransitionTimers.values())clearTimeout(e);this.rowTransitionTimers.clear(),this.rowVisibilityTransitions.set({})}clearTransitionTimer(e){let t=this.rowTransitionTimers.get(e);t&&(clearTimeout(t),this.rowTransitionTimers.delete(e))}serializeResults(e){return JSON.stringify(e.map(t=>({id:t.id,type:t.type,distanceInMeters:t.distanceInMeters,splitDistanceBy:t.splitDistanceBy,pace:t.pace,time:t.time,isVisible:t.isVisible,isCustom:t.isCustom})))}hasUnsavedChanges(){return this.serializeResults(this.editableResults())!==this.initialStateSnapshot}async requestDismiss(){if(!this.hasUnsavedChanges()){await this.modalCtrl.dismiss(void 0,"discard");return}await(await this.alertCtrl.create({header:"Discard changes?",message:"You have unsaved distance changes.",buttons:[{text:"Stay",role:"cancel"},{text:"Discard",role:"destructive",handler:()=>{this.modalCtrl.dismiss(void 0,"discard")}}]})).present()}};l.\u0275fac=function(t){return new(t||l)},l.\u0275cmp=R({type:l,selectors:[["app-distance-manager-modal"]],inputs:{results:"results"},decls:46,vars:10,consts:[[1,"distance-manager-header","safe-area-inline"],[1,"distance-manager-toolbar"],["slot","start"],["aria-label","Back to calculator","fill","clear",1,"distance-manager-back-btn",3,"click"],["slot","icon-only","name","arrow-back-outline"],[1,"safe-area-content","distance-manager-content"],[1,"mx-auto","flex","max-w-xl","flex-col","gap-4","py-3","mobile-bottom-safe"],[1,"calc-surface-card","flex","flex-col","gap-3","px-3","py-3"],[1,"distance-manager-section-title"],["mode","md","label","Label","label-placement","stacked","placeholder","e.g. Park Loop","fill","outline","clear-input","true",3,"ngModelChange","ngModel","maxlength"],[1,"distance-manager-label-counter"],[1,"distance-manager-add-row"],["mode","md","label","Distance","label-placement","stacked","type","number","min","0","step","0.01","inputmode","decimal","fill","outline",3,"ngModelChange","ngModel"],["mode","ios",1,"app-segment",3,"ionChange","value"],["value","km"],["value","mi"],[1,"distance-manager-error"],["fill","solid",1,"distance-manager-add-btn",3,"click","disabled"],["slot","start","name","add-outline"],[1,"calc-surface-card","flex","flex-col","gap-2","px-2","py-2"],[1,"distance-manager-list-head"],[1,"distance-manager-list-copy"],[1,"distance-manager-list-title"],[1,"distance-manager-list-subtitle"],["fill","clear","size","small",1,"distance-manager-reset-btn",3,"click"],[3,"ionItemReorder","disabled"],["lines","full",1,"distance-manager-item",3,"distance-manager-item-hiding","distance-manager-item-removing"],[1,"distance-manager-hidden-wrap"],["id","distance-manager-done-footer",1,"distance-manager-footer","safe-area-inline"],[1,"distance-manager-footer-toolbar"],[1,"distance-manager-footer-inner"],["expand","block",1,"distance-manager-done-btn",3,"click"],["lines","full",1,"distance-manager-item"],[1,"distance-manager-item-title"],[1,"distance-manager-item-detail"],[1,"distance-manager-badge"],["slot","end","fill","solid",1,"distance-manager-delete-btn",3,"distance-manager-delete-btn-armed","disabled"],["slot","end",1,"distance-manager-toggle",3,"ionChange","checked","disabled"],["slot","end","fill","solid",1,"distance-manager-delete-btn",3,"click","disabled"],["slot","icon-only",3,"name"],["fill","clear","size","small",1,"distance-manager-hidden-toggle",3,"click"],[1,"distance-manager-hidden-list"],["lines","none",1,"distance-manager-item","distance-manager-item-hidden",3,"distance-manager-item-showing","distance-manager-item-removing"],["lines","none",1,"distance-manager-item","distance-manager-item-hidden"]],template:function(t,n){t&1&&(a(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-button",3),u("click",function(){return n.dismiss()}),b(4,"ion-icon",4),o()(),a(5,"ion-title"),s(6,"Manage Distances"),o()()(),a(7,"ion-content",5)(8,"div",6)(9,"section",7)(10,"h2",8),s(11,"Add Custom Distance"),o(),a(12,"ion-input",9),De("ngModelChange",function(m){return Ee(n.draftType,m)||(n.draftType=m),m}),o(),a(13,"p",10),s(14),o(),a(15,"div",11)(16,"ion-input",12),De("ngModelChange",function(m){return Ee(n.draftDistanceValue,m)||(n.draftDistanceValue=m),m}),o(),a(17,"ion-segment",13),u("ionChange",function(m){return n.onDraftDistanceUnitChange(m)}),a(18,"ion-segment-button",14)(19,"ion-label"),s(20,"km"),o()(),a(21,"ion-segment-button",15)(22,"ion-label"),s(23,"mi"),o()()()(),x(24,xo,2,1,"p",16),a(25,"ion-button",17),u("click",function(){return n.addDistance()}),b(26,"ion-icon",18),s(27," Add Distance "),o()(),a(28,"section",19)(29,"div",20)(30,"div",21)(31,"h2",22),s(32,"Distance List"),o(),a(33,"p",23),s(34,"Drag to reorder and toggle visibility on calculator."),o()(),a(35,"ion-button",24),u("click",function(){return n.confirmReset()}),s(36," Reset "),o()(),a(37,"ion-reorder-group",25),u("ionItemReorder",function(m){return n.onReorder(m)}),S(38,yo,10,11,"ion-item",26,ji),o(),x(40,To,4,3,"div",27),o()()(),a(41,"ion-footer",28)(42,"ion-toolbar",29)(43,"div",30)(44,"ion-button",31),u("click",function(){return n.save()}),s(45,"Done"),o()()()()),t&2&&(d(12),Ie("ngModel",n.draftType),h("maxlength",n.maxCustomLabelLength),d(2),te("",n.labelCharacterCount(),"/",n.maxCustomLabelLength,""),d(2),Ie("ngModel",n.draftDistanceValue),d(),h("value",n.draftDistanceUnit),d(7),C(n.validationMessage()?24:-1),d(),h("disabled",!n.canAddDistance()),d(12),h("disabled",!1),d(),O(n.visibleResults()),d(2),C(n.hiddenResults().length?40:-1))},dependencies:[$,ge,$e,bt,Le,re,He,ce,se,oe,Y,H,K,fe,Z,Q,le,Sn,Mn,xt,Pn,yt],styles:[".distance-manager-header[_ngcontent-%COMP%]{border-bottom:1px solid color-mix(in oklab,var(--calc-border-subtle) 80%,transparent)}.distance-manager-toolbar[_ngcontent-%COMP%]{--background: color-mix(in oklab, var(--calc-surface-raised) 88%, var(--calc-accent) 12%);--color: var(--calc-text-strong)}.distance-manager-content[_ngcontent-%COMP%]{--padding-top: .85rem;--padding-bottom: calc(.85rem + max(var(--ion-safe-area-bottom, 0px), env(safe-area-inset-bottom, 0px))) ;--padding-start: calc(.85rem + max(var(--ion-safe-area-left, 0px), env(safe-area-inset-left, 0px))) ;--padding-end: calc(.85rem + max(var(--ion-safe-area-right, 0px), env(safe-area-inset-right, 0px))) }.distance-manager-back-btn[_ngcontent-%COMP%]{--color: var(--calc-text-strong)}.distance-manager-section-title[_ngcontent-%COMP%]{font-size:.95rem;font-weight:700;color:var(--calc-text-strong)}.distance-manager-add-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:minmax(0,1fr) 140px;gap:.65rem;align-items:end}.distance-manager-add-row[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]{align-self:end}.distance-manager-add-btn[_ngcontent-%COMP%]{--color: #ffffff;--background: var(--calc-accent-strong);--background-hover: color-mix(in oklab, var(--calc-accent-strong) 88%, black);--background-activated: color-mix(in oklab, var(--calc-accent-strong) 82%, black);--border-radius: var(--calc-radius-md);min-height:44px}.distance-manager-error[_ngcontent-%COMP%]{color:color-mix(in oklab,#dc2626 70%,var(--calc-text-strong));font-size:.82rem;margin:0}.distance-manager-label-counter[_ngcontent-%COMP%]{color:var(--calc-text-muted);font-size:.74rem;margin:-.35rem 0 0;text-align:right}.distance-manager-list-head[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:space-between;gap:.65rem;padding:.25rem .5rem .35rem}.distance-manager-list-copy[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.16rem;min-width:0}.distance-manager-list-title[_ngcontent-%COMP%]{color:var(--calc-text-strong);font-size:.86rem;font-weight:700;line-height:1.2;margin:0}.distance-manager-list-subtitle[_ngcontent-%COMP%]{color:var(--calc-text-muted);font-size:.76rem;line-height:1.32;margin:0}.distance-manager-reset-btn[_ngcontent-%COMP%]{--color: var(--calc-accent-strong);--padding-start: .35rem;--padding-end: .35rem;--background: transparent;margin-top:-.08rem;min-height:32px;text-transform:none}.distance-manager-item[_ngcontent-%COMP%]{--background: transparent;--inner-padding-end: 6px}.distance-manager-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%], .distance-manager-item[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%], .distance-manager-item[_ngcontent-%COMP%]   ion-toggle[_ngcontent-%COMP%], .distance-manager-item[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{transition:opacity .17s var(--calc-motion-ease),transform .17s var(--calc-motion-ease)}.distance-manager-item-hiding[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%], .distance-manager-item-hiding[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%], .distance-manager-item-hiding[_ngcontent-%COMP%]   ion-toggle[_ngcontent-%COMP%], .distance-manager-item-hiding[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%], .distance-manager-item-removing[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%], .distance-manager-item-removing[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%], .distance-manager-item-removing[_ngcontent-%COMP%]   ion-toggle[_ngcontent-%COMP%], .distance-manager-item-removing[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%], .distance-manager-item-showing[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%], .distance-manager-item-showing[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%], .distance-manager-item-showing[_ngcontent-%COMP%]   ion-toggle[_ngcontent-%COMP%], .distance-manager-item-showing[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{opacity:0;transform:translateY(-4px) scale(.99)}.distance-manager-item-hidden[_ngcontent-%COMP%]{opacity:.92}.distance-manager-hidden-wrap[_ngcontent-%COMP%]{border-top:1px dashed color-mix(in oklab,var(--calc-border-subtle) 72%,transparent);margin-top:.2rem;padding:.25rem .5rem .2rem}.distance-manager-hidden-toggle[_ngcontent-%COMP%]{--color: var(--calc-accent-strong);--padding-start: .2rem;--padding-end: .2rem;text-transform:none}.distance-manager-hidden-list[_ngcontent-%COMP%]{border-radius:var(--calc-radius-md);background:color-mix(in oklab,var(--calc-surface-1) 82%,transparent);margin-top:.15rem;padding:.2rem}.distance-manager-item-title[_ngcontent-%COMP%]{color:var(--calc-text-strong);font-size:.9rem;font-weight:600}.distance-manager-item-detail[_ngcontent-%COMP%]{color:var(--calc-text-muted);font-size:.76rem}.distance-manager-badge[_ngcontent-%COMP%]{margin-right:.45rem;--background: color-mix(in oklab, var(--calc-surface-2) 80%, var(--calc-accent) 20%);--color: var(--calc-text-strong);border:1px solid color-mix(in oklab,var(--calc-border-strong) 75%,transparent);border-radius:9999px;font-size:.68rem;font-weight:600;letter-spacing:.01em}.distance-manager-toggle[_ngcontent-%COMP%]{--track-background: color-mix(in oklab, var(--calc-surface-3) 70%, var(--calc-surface-1));--track-background-checked: color-mix(in oklab, var(--calc-accent-strong) 76%, var(--calc-surface-2));--handle-background: var(--calc-surface-raised);--handle-background-checked: #ffffff;--handle-box-shadow: 0 0 0 1px color-mix(in oklab, var(--calc-border-strong) 68%, transparent)}.distance-manager-delete-btn[_ngcontent-%COMP%]{--color: color-mix(in oklab, #ef4444 72%, var(--calc-text-strong));--background: color-mix(in oklab, #ef4444 12%, var(--calc-surface-2));--background-hover: color-mix(in oklab, #ef4444 18%, var(--calc-surface-2));--background-activated: color-mix(in oklab, #ef4444 24%, var(--calc-surface-2));--border-radius: 9999px;min-height:34px;min-width:34px;margin-right:.45rem}.distance-manager-delete-btn-armed[_ngcontent-%COMP%]{--color: #ffffff;--background: color-mix(in oklab, #dc2626 80%, var(--calc-accent));--background-hover: color-mix(in oklab, #b91c1c 82%, var(--calc-accent));--background-activated: color-mix(in oklab, #991b1b 85%, var(--calc-accent))}ion-input[_ngcontent-%COMP%]{--border-color: color-mix(in oklab, var(--calc-text-muted) 40%, transparent);--highlight-color-focused: var(--calc-accent-strong);--highlight-color-valid: var(--calc-accent-strong);--color: var(--calc-text-strong)}.distance-manager-footer[_ngcontent-%COMP%]{border-top:1px solid color-mix(in oklab,var(--calc-border-subtle) 75%,transparent)}.distance-manager-footer-toolbar[_ngcontent-%COMP%]{--background: color-mix(in oklab, var(--calc-surface-raised) 88%, var(--calc-accent) 12%)}.distance-manager-footer-inner[_ngcontent-%COMP%]{padding:.5rem}.distance-manager-done-btn[_ngcontent-%COMP%]{--color: #ffffff;--background: var(--calc-accent-strong);--background-hover: color-mix(in oklab, var(--calc-accent-strong) 88%, black);--background-activated: color-mix(in oklab, var(--calc-accent-strong) 82%, black);--border-radius: var(--calc-radius-md);--ion-toolbar-background: #ffffff;color:var(--calc-text-strong);min-height:44px;width:100%;max-width:32rem;margin-inline:auto}"]});let r=l;return r})();var Eo=(r,l)=>l.offset;function Do(r,l){if(r&1&&(a(0,"div",9)(1,"div")(2,"p",24),s(3),o(),a(4,"p",25),s(5),o()(),a(6,"p",26),s(7,"Current"),o()()),r&2){let i=l,e=p();d(3),v(i.time),d(2),te("",i.pace,"/",e.paceUnitLabel(),"")}}function Ro(r,l){if(r&1){let i=k();a(0,"tr",27),u("click",function(){let t=g(i).$implicit,n=p();return f(n.selectRow(t))})("keydown",function(t){let n=g(i).$implicit,c=p();return f(c.onRowKeydown(t,n))}),a(1,"td",28),s(2),o(),a(3,"td"),s(4),o(),a(5,"td"),s(6),o()()}if(r&2){let i=l.$implicit,e=p();w("pace-chart-row-center",i.isCenter),L("aria-label","Use pace "+i.pace+" and finish time "+i.time)("aria-selected",i.isCenter),d(2),v(e.formatDelta(i.offset)),d(2),te("",i.pace,"/",e.paceUnitLabel(),""),d(2),v(i.time)}}var Vo=1,Ao=120,Ki=(()=>{let l=class l{constructor(){this.modalCtrl=A(q),this.platform=A(Ne),this.store=A(be),this.paceChart=this.store.selectSignal(_i),this.rows=this.store.selectSignal(wi),this.stepSeconds=this.store.selectSignal(Pi),this.paceType=this.store.selectSignal(lt),this.centerRow=U(()=>this.rows().find(e=>e.isCenter)??null),this.paceUnitLabel=U(()=>this.paceType()==="m400"?"400m":this.paceType()),this.minStepSeconds=Vo,this.maxStepSeconds=Ao,W({arrowBackOutline:X,addOutline:Ke,removeOutline:qn})}ngOnInit(){this.backButtonSubscription=this.platform.backButton.subscribeWithPriority(2e3,()=>{this.dismiss()})}ngOnDestroy(){var e;(e=this.backButtonSubscription)==null||e.unsubscribe()}dismiss(){this.modalCtrl.dismiss()}adjustStep(e){this.store.dispatch(M.setPaceChartStep({stepSeconds:this.stepSeconds()+e}))}selectRow(e){e.isCenter||this.store.dispatch(M.setPaceChartCenterPace({paceInSeconds:e.paceInSeconds}))}onRowKeydown(e,t){e.key!=="Enter"&&e.key!==" "||(e.preventDefault(),this.selectRow(t))}formatDelta(e){if(e===0)return"Current";let t=Math.abs(e)*this.stepSeconds();return`${e>0?"Slower":"Faster"} ${t}s`}};l.\u0275fac=function(t){return new(t||l)},l.\u0275cmp=R({type:l,selectors:[["app-pace-chart-modal"]],decls:41,vars:6,consts:[[1,"pace-chart-header","safe-area-inline"],[1,"pace-chart-toolbar"],["slot","start"],["aria-label","Back to calculator","fill","clear",1,"pace-chart-back-btn",3,"click"],["slot","icon-only","name","arrow-back-outline"],[1,"safe-area-content","pace-chart-content"],[1,"mobile-bottom-safe","mx-auto","flex","max-w-md","flex-col","gap-3","px-3","py-3"],[1,"calc-surface-card","px-3","py-3"],[1,"calc-muted-copy","text-[14px]","font-semibold","uppercase","tracking-[0.08em]"],[1,"mt-2","flex","items-center","justify-between","gap-3"],[1,"calc-shell-subtle","pace-chart-step-card","flex","items-center","justify-between","gap-2","rounded-2xl","px-3","py-2"],[1,"text-sm","font-semibold"],[1,"calc-muted-copy","text-xs"],[1,"pace-chart-stepper"],["fill","clear","shape","round","aria-label","Decrease pace chart step",3,"click","disabled"],["slot","icon-only","name","remove-outline"],[1,"pace-chart-step-value"],["fill","clear","shape","round","aria-label","Increase pace chart step",3,"click","disabled"],["slot","icon-only","name","add-outline"],[1,"calc-table-shell","pace-chart-table-shell"],[1,"calc-muted-copy","pace-chart-helper-copy"],["aria-label","Nearby pace and finish time calculations",1,"pace-chart-table"],["scope","col"],["role","button","tabindex","0",1,"pace-chart-row",3,"pace-chart-row-center"],[1,"text-xl","font-extrabold","leading-tight"],[1,"calc-muted-copy","text-sm"],[1,"pace-chart-current-pill"],["role","button","tabindex","0",1,"pace-chart-row",3,"click","keydown"],[1,"pace-chart-col-delta"]],template:function(t,n){if(t&1&&(a(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-button",3),u("click",function(){return n.dismiss()}),b(4,"ion-icon",4),o()(),a(5,"ion-title"),s(6,"View pace chart"),o()()(),a(7,"ion-content",5)(8,"div",6)(9,"section",7)(10,"p",8),s(11),o(),x(12,Do,8,3,"div",9),o(),a(13,"section",10)(14,"div")(15,"p",11),s(16,"Step"),o(),a(17,"p",12),s(18,"Seconds per pace row"),o()(),a(19,"div",13)(20,"ion-button",14),u("click",function(){return n.adjustStep(-1)}),b(21,"ion-icon",15),o(),a(22,"p",16),s(23),o(),a(24,"ion-button",17),u("click",function(){return n.adjustStep(1)}),b(25,"ion-icon",18),o()()(),a(26,"section",19)(27,"p",20),s(28,"Tap a row to set it as current."),o(),a(29,"table",21)(30,"thead")(31,"tr")(32,"th",22),s(33,"Delta"),o(),a(34,"th",22),s(35,"Pace"),o(),a(36,"th",22),s(37,"Time"),o()()(),a(38,"tbody"),S(39,Ro,7,8,"tr",23,Eo),o()()()()()),t&2){let c;d(11),te(" ",n.paceChart().distance,"",n.paceChart().distanceType," "),d(),C((c=n.centerRow())?12:-1,c),d(8),h("disabled",n.stepSeconds()<=n.minStepSeconds),d(3),T("",n.stepSeconds(),"s"),d(),h("disabled",n.stepSeconds()>=n.maxStepSeconds),d(15),O(n.rows())}},dependencies:[$,re,ce,se,oe,Y,H,K],styles:[".pace-chart-header[_ngcontent-%COMP%]{border-bottom:1px solid color-mix(in oklab,var(--calc-border-subtle) 80%,transparent)}.pace-chart-toolbar[_ngcontent-%COMP%]{--background: color-mix(in oklab, var(--calc-surface-raised) 86%, var(--calc-accent) 14%);--color: var(--calc-text-strong)}.pace-chart-back-btn[_ngcontent-%COMP%]{--color: var(--calc-text-strong)}.pace-chart-content[_ngcontent-%COMP%]{--background: color-mix(in oklab, var(--calc-surface-0) 86%, transparent)}.pace-chart-current-pill[_ngcontent-%COMP%]{border:1px solid color-mix(in oklab,var(--calc-accent-strong) 40%,transparent);background:color-mix(in oklab,var(--calc-accent) 20%,transparent);border-radius:999px;color:var(--calc-text-strong);font-size:.7rem;font-weight:700;letter-spacing:.04em;padding:.2rem .6rem;text-transform:uppercase}.pace-chart-step-card[_ngcontent-%COMP%]{min-height:56px}.pace-chart-stepper[_ngcontent-%COMP%]{align-items:center;display:flex;gap:.2rem}.pace-chart-stepper[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--color: var(--calc-text-strong);--background: color-mix(in oklab, var(--calc-surface-raised) 80%, transparent);--background-hover: color-mix(in oklab, var(--calc-surface-raised) 90%, white 10%);min-height:44px;min-width:44px}.pace-chart-step-value[_ngcontent-%COMP%]{font-size:1rem;font-weight:700;min-width:3.2rem;text-align:center}.pace-chart-table-shell[_ngcontent-%COMP%]{overflow:hidden}.pace-chart-helper-copy[_ngcontent-%COMP%]{border-bottom:1px solid color-mix(in oklab,var(--calc-border-subtle) 58%,transparent);font-size:.75rem;margin:0;padding:.65rem .75rem .55rem}.pace-chart-table[_ngcontent-%COMP%]{border-collapse:collapse;width:100%}.pace-chart-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .pace-chart-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.7rem .75rem;text-align:left}.pace-chart-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{color:var(--calc-text-muted);font-size:.67rem;font-weight:700;letter-spacing:.08em;text-transform:uppercase}.pace-chart-row[_ngcontent-%COMP%]{border-top:1px solid color-mix(in oklab,var(--calc-border-subtle) 58%,transparent);cursor:pointer;transition:background-color var(--calc-motion-fast) var(--calc-motion-ease),color var(--calc-motion-fast) var(--calc-motion-ease)}.pace-chart-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:var(--calc-text-strong);font-size:.92rem}.pace-chart-row[_ngcontent-%COMP%]:focus-visible{outline:2px solid color-mix(in oklab,var(--calc-accent-strong) 58%,transparent);outline-offset:-2px}.pace-chart-row.pace-chart-row-center[_ngcontent-%COMP%]{background:color-mix(in oklab,var(--calc-accent) 16%,var(--calc-surface-raised))}.pace-chart-row.pace-chart-row-center[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-weight:700}.pace-chart-col-delta[_ngcontent-%COMP%]{color:var(--calc-text-muted);font-variant-numeric:tabular-nums;width:26%}"]});let r=l;return r})();var Lt=class extends En{async write(l){if(typeof navigator>"u"||!navigator.clipboard)throw this.unavailable("Clipboard API not available in this browser");if(l.string!==void 0)await this.writeText(l.string);else if(l.url)await this.writeText(l.url);else if(l.image)if(typeof ClipboardItem<"u")try{let i=await(await fetch(l.image)).blob(),e=new ClipboardItem({[i.type]:i});await navigator.clipboard.write([e])}catch{throw new Error("Failed to write image")}else throw this.unavailable("Writing images to the clipboard is not supported in this browser");else throw new Error("Nothing to write")}async read(){if(typeof navigator>"u"||!navigator.clipboard)throw this.unavailable("Clipboard API not available in this browser");if(typeof ClipboardItem<"u")try{let l=await navigator.clipboard.read(),i=l[0].types[0],e=await l[0].getType(i);return{value:await this._getBlobData(e,i),type:i}}catch{return this.readText()}else return this.readText()}async readText(){if(typeof navigator>"u"||!navigator.clipboard||!navigator.clipboard.readText)throw this.unavailable("Reading from clipboard not supported in this browser");return{value:await navigator.clipboard.readText(),type:"text/plain"}}async writeText(l){if(typeof navigator>"u"||!navigator.clipboard||!navigator.clipboard.writeText)throw this.unavailable("Writting to clipboard not supported in this browser");await navigator.clipboard.writeText(l)}_getBlobData(l,i){return new Promise((e,t)=>{let n=new FileReader;i.includes("image")?n.readAsDataURL(l):n.readAsText(l),n.onloadend=()=>{let c=n.result;e(c)},n.onerror=c=>{t(c)}})}};var Gi=_e("Clipboard",{web:()=>new Lt});var Qi=(r,l)=>l.id;function Bo(r,l){if(r&1&&(a(0,"p",36),s(1),o(),a(2,"p",37),s(3),o()),r&2){let i=p().$implicit,e=p();d(),v(e.getCollapsedBlockMeta(i)),d(2),v(e.getCollapsedBlockDuration(i))}}function Fo(r,l){r&1&&(a(0,"p",65),s(1),o()),r&2&&(d(),T("Effective pace: ",l,""))}function $o(r,l){if(r&1){let i=k();a(0,"article",42)(1,"div",51)(2,"p",52),s(3),o(),a(4,"ion-button",34),u("click",function(){let t=g(i).$implicit,n=p(2).$implicit,c=p();return f(c.onRemoveStep(n.id,t.id))}),b(5,"ion-icon",33),o()(),a(6,"div",53)(7,"div",54)(8,"ion-input",55),u("ngModelChange",function(t){let n=g(i).$implicit,c=p(2).$implicit,m=p();return f(m.onRowPaceChange(c.id,n.id,t))}),o(),a(9,"ion-segment",56),u("ionChange",function(t){let n=g(i).$implicit,c=p(2).$implicit,m=p();return f(m.onRowPaceUnitChange(c.id,n.id,t))}),a(10,"ion-segment-button",57)(11,"ion-label"),s(12,"/km"),o()(),a(13,"ion-segment-button",58)(14,"ion-label"),s(15,"/mi"),o()()()(),a(16,"ion-input",59),u("ngModelChange",function(t){let n=g(i).$implicit,c=p(2).$implicit,m=p();return f(m.onRowDurationChange(c.id,n.id,t))}),o()(),a(17,"div",53)(18,"div",54)(19,"ion-input",60),u("ngModelChange",function(t){let n=g(i).$implicit,c=p(2).$implicit,m=p();return f(m.onRowKnownDistanceChange(c.id,n.id,t))}),o(),a(20,"ion-segment",56),u("ionChange",function(t){let n=g(i).$implicit,c=p(2).$implicit,m=p();return f(m.onRowKnownDistanceUnitChange(c.id,n.id,t))}),a(21,"ion-segment-button",61)(22,"ion-label"),s(23,"m"),o()(),a(24,"ion-segment-button",57)(25,"ion-label"),s(26,"km"),o()(),a(27,"ion-segment-button",58)(28,"ion-label"),s(29,"mi"),o()()()(),a(30,"div",62)(31,"p",63),s(32,"Estimated step distance"),o(),a(33,"p",64),s(34),o(),a(35,"p",65),s(36),o(),x(37,Fo,2,1,"p",65),o()()()}if(r&2){let i,e=l.$implicit,t=l.$index,n=p(2).$implicit,c=p();d(3),T("Step ",t+1,""),d(),w("estimate-delete-btn-armed",c.isStepDeleteArmed(n.id,e.id)),h("disabled",n.rows.length<=1),L("aria-label",c.isStepDeleteArmed(n.id,e.id)?"Tap again to delete step "+(t+1):"Tap to arm deletion for step "+(t+1)),d(),h("name",c.isStepDeleteArmed(n.id,e.id)?"warning-outline":"trash-outline"),d(3),h("ngModel",e.pace),d(),h("value",e.paceUnit),d(7),h("ngModel",e.duration),d(3),h("ngModel",e.knownDistance),d(),h("value",e.knownDistanceUnit),d(14),v(c.formatMeters(c.getRowDistanceMeters(e))),d(2),T(" Duration: ",c.getRowDurationLabel(e)," "),d(),C((i=c.getEffectivePaceLabel(e))?37:-1,i)}}function Lo(r,l){if(r&1){let i=k();a(0,"div",35)(1,"div",38)(2,"ion-input",39),u("ngModelChange",function(t){g(i);let n=p().$implicit,c=p();return f(c.onBlockNameChange(n.id,t))}),o(),a(3,"ion-input",40),u("ngModelChange",function(t){g(i);let n=p().$implicit,c=p();return f(c.onBlockRepeatsChange(n.id,t))}),o()(),a(4,"div",41),S(5,$o,38,14,"article",42,Qi),o(),a(7,"div",43)(8,"div",44)(9,"ion-button",45),u("click",function(){g(i);let t=p().$implicit,n=p();return f(n.addRow(t.id))}),b(10,"ion-icon",12),s(11," Add step "),o(),a(12,"ion-button",46),u("click",function(){g(i);let t=p().$implicit,n=p();return f(n.toggleBlockCollapse(t.id))}),b(13,"ion-icon",47),o()(),a(14,"div",48)(15,"p",49),s(16,"Block estimate"),o(),a(17,"p",50),s(18),o()()()()}if(r&2){let i=p().$implicit,e=p();d(2),h("maxlength",e.maxBlockNameLength)("ngModel",i.name),d(),h("ngModel",i.repeats),d(2),O(i.rows),d(13),v(e.getBlockDistanceLabel(i))}}function No(r,l){if(r&1){let i=k();a(0,"section",10)(1,"div",27)(2,"div",28)(3,"p",29),s(4),o(),a(5,"p",30),s(6),o(),x(7,Bo,4,2),o(),a(8,"div",31)(9,"ion-button",32),u("click",function(){let t=g(i).$implicit,n=p();return f(n.toggleBlockCollapse(t.id))}),b(10,"ion-icon",33),o(),a(11,"ion-button",34),u("click",function(){let t=g(i).$implicit,n=p();return f(n.onRemoveBlock(t.id))}),b(12,"ion-icon",33),o()()(),x(13,Lo,19,4,"div",35),o()}if(r&2){let i=l.$implicit,e=l.$index,t=p();d(4),T("Block ",e+1,""),d(2),v(t.getBlockName(i,e)),d(),C(t.isBlockCollapsed(i.id)?7:-1),d(2),L("aria-label",t.isBlockCollapsed(i.id)?"Expand block":"Collapse block"),d(),h("name",t.isBlockCollapsed(i.id)?"chevron-down-outline":"chevron-up-outline"),d(),w("estimate-delete-btn-armed",t.isBlockDeleteArmed(i.id)),h("disabled",t.blocks().length<=1),L("aria-label",t.isBlockDeleteArmed(i.id)?"Tap again to delete block "+(e+1):"Tap to arm deletion for block "+(e+1)),d(),h("name",t.isBlockDeleteArmed(i.id)?"warning-outline":"trash-outline"),d(),C(t.isBlockCollapsed(i.id)?-1:13)}}function zo(r,l){r&1&&(a(0,"p",24),s(1),o()),r&2&&(d(),T("Estimated duration: ",l,""))}function Ho(r,l){r&1&&(a(0,"p",25),s(1," Add pace or duration for every distance step to estimate total duration. "),o())}var Re=1e3,Qe=1609.344,Jt=40,Yi=40,Wo=999,Ze=40,qi=100,jo=2500,Zi=(()=>{let l=class l{constructor(){this.alertCtrl=A(Ct),this.modalCtrl=A(q),this.toastCtrl=A(Pe),this.platform=A(Ne),this.idSeed=0,this.plan=null,this.defaultPaceUnit="km",this.preferredDistanceUnit="km",this.maxBlocks=Jt,this.maxBlockNameLength=Ze,this.blocks=D([]),this.savedWorkouts=D([]),this.collapsedBlockIds=D(new Set),this.deleteArmedTarget=D(null),this.summary=U(()=>this.buildSummary(this.blocks())),this.hasInputBlocks=U(()=>this.blocks().some(e=>e.rows.some(t=>!!t.pace.trim()||!!t.duration.trim()||!!t.knownDistance.trim()))),this.canSaveWorkout=U(()=>this.summary().totalDistanceMeters>0),this.canCopyWorkout=U(()=>this.hasInputBlocks()&&this.summary().totalDistanceMeters>0),W({arrowBackOutline:X,addOutline:Ke,chevronDownOutline:Ge,chevronUpOutline:Ye,copyOutline:$n,folderOpenOutline:zn,trashOutline:Ot,warningOutline:It})}ngOnInit(){let e=this.normalizePlan(this.plan);this.blocks.set(e.blocks),this.savedWorkouts.set(e.savedWorkouts),this.backButtonSubscription=this.platform.backButton.subscribeWithPriority(2e3,()=>{this.dismiss()})}ngOnDestroy(){var e;(e=this.backButtonSubscription)==null||e.unsubscribe(),this.clearDeleteArm()}dismiss(){this.clearDeleteArm();let e={blocks:this.blocks(),savedWorkouts:this.savedWorkouts(),updatedAt:new Date().toISOString()};this.modalCtrl.dismiss({plan:e})}async promptSaveWorkout(){if(this.clearDeleteArm(),!this.canSaveWorkout()){await this.presentToast("Cannot save a 0 km workout. Add pace/duration or distance first.");return}let e=P=>{this.saveWorkout(P)},t=await this.alertCtrl.create({header:"Save workout",message:"Name this workout so you can load it later.",inputs:[{name:"name",type:"text",attributes:{autocapitalize:"words",enterkeyhint:"go",maxlength:Ze},placeholder:"Workout name"}],buttons:[{text:"Cancel",role:"cancel"},{text:"Save",handler:P=>{e(P==null?void 0:P.name)}}]});await t.present();let n=t,m=(typeof n.querySelector=="function"?n.querySelector("input.alert-input"):null)??document.querySelector("ion-alert input.alert-input");if(!m)return;let _=P=>{P.key==="Enter"&&(P.preventDefault(),P.stopPropagation(),e(m.value),t.dismiss(void 0,"save"))};m.addEventListener("keydown",_),t.onDidDismiss().then(()=>{m.removeEventListener("keydown",_)})}async openLoadWorkoutPicker(){let e=this.savedWorkouts();if(!e.length){await this.presentToast("No saved workouts yet. Save one first.");return}await(await this.alertCtrl.create({header:"Load workout",message:"Choose a saved workout preset.",cssClass:"estimate-load-workout-alert",inputs:e.map(n=>({type:"radio",label:n.name,value:n.id})),buttons:[{text:"Delete",role:"destructive",handler:n=>{this.deleteSelectedWorkout(n)}},{text:"Cancel",role:"cancel"},{text:"Load",handler:n=>{typeof n!="string"||!n.trim()||this.loadSavedWorkout(n)}}]})).present()}async deleteSelectedWorkout(e){if(typeof e!="string"||!e.trim()){await this.presentToast("Select a saved workout to delete.");return}let t=this.savedWorkouts().find(c=>c.id===e);if(!t)return;await(await this.alertCtrl.create({header:"Delete workout?",message:`"${t.name}" will be removed from saved workouts.`,buttons:[{text:"Cancel",role:"cancel"},{text:"Delete",role:"destructive",handler:()=>{this.savedWorkouts.update(c=>c.filter(m=>m.id!==t.id)),this.presentToast("Workout deleted.")}}]})).present()}async saveWorkout(e){if(!this.canSaveWorkout()){await this.presentToast("Cannot save a 0 km workout. Add pace/duration or distance first.");return}let t=this.normalizeWorkoutName(e);if(!t){await this.presentToast("Enter a workout name to save.");return}let n=t.toLocaleLowerCase();if(this.savedWorkouts().some(_=>_.name.toLocaleLowerCase()===n)){await this.presentToast("Workout name already exists. Choose a different name.");return}let m=[...this.savedWorkouts(),{id:this.createSavedWorkoutId(),name:t,blocks:this.cloneBlocks(this.blocks()),updatedAt:new Date().toISOString()}].slice(-qi);this.savedWorkouts.set(m),await this.presentToast("Workout saved.")}loadSavedWorkout(e){let t=this.savedWorkouts().find(c=>c.id===e);if(!t)return;let n=this.normalizePlan({blocks:t.blocks,savedWorkouts:this.savedWorkouts(),updatedAt:null});this.blocks.set(n.blocks),this.collapsedBlockIds.set(new Set),this.clearDeleteArm()}async copyWorkout(){if(!this.canCopyWorkout())return;let e=this.buildWorkoutCopyText(this.blocks(),this.summary()),t=await this.writeTextToClipboard(e);await(await this.toastCtrl.create({message:t?"Workout copied to clipboard.":"Unable to copy workout. Try again.",duration:1800,position:"top",cssClass:"toast-message"})).present()}addBlock(){this.clearDeleteArm(),this.blocks.update(e=>{if(e.length>=Jt)return e;let t=e.length+1,n={id:this.createId("block"),name:`Block ${t}`,repeats:1,rows:[this.createDefaultRow()]};return[...e,n]})}removeBlock(e){this.clearDeleteArm(this.getBlockDeleteArmKey(e)),this.collapsedBlockIds.update(t=>{let n=new Set(t);return n.delete(e),n}),this.blocks.update(t=>t.length<=1?t:t.filter(n=>n.id!==e))}toggleBlockCollapse(e){this.clearDeleteArm(),this.collapsedBlockIds.update(t=>{let n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})}isBlockCollapsed(e){return this.collapsedBlockIds().has(e)}getBlockName(e,t){return e.name.trim()||`Block ${t+1}`}onRemoveBlock(e){if(this.isBlockDeleteArmed(e)){this.removeBlock(e);return}this.armDelete(this.getBlockDeleteArmKey(e))}onRemoveStep(e,t){if(this.isStepDeleteArmed(e,t)){this.removeRow(e,t);return}this.armDelete(this.getStepDeleteArmKey(e,t))}isBlockDeleteArmed(e){return this.deleteArmedTarget()===this.getBlockDeleteArmKey(e)}isStepDeleteArmed(e,t){return this.deleteArmedTarget()===this.getStepDeleteArmKey(e,t)}getCollapsedBlockMeta(e){let t=this.getBlockEstimate(e),n=`${t.rowCount} ${t.rowCount===1?"step":"steps"}`,c=`${t.repeats} ${t.repeats===1?"repeat":"repeats"}`;return`${n} x ${c} \u2022 ${this.formatMeters(t.totalDistanceMeters)}`}getCollapsedBlockDuration(e){let t=this.getBlockEstimate(e);return t.hasDistance?!t.hasCompleteDuration||t.totalDurationSeconds<=0?"Duration: incomplete":`Duration: ${rt(t.totalDurationSeconds)}`:"Duration: --"}addRow(e){this.clearDeleteArm(),this.blocks.update(t=>t.map(n=>n.id!==e||n.rows.length>=Yi?n:j(N({},n),{rows:[...n.rows,this.createDefaultRow()]})))}removeRow(e,t){this.clearDeleteArm(this.getStepDeleteArmKey(e,t)),this.blocks.update(n=>n.map(c=>c.id!==e||c.rows.length<=1?c:j(N({},c),{rows:c.rows.filter(m=>m.id!==t)})))}onBlockNameChange(e,t){let n=String(t??"").slice(0,Ze);this.blocks.update(c=>c.map(m=>m.id===e?j(N({},m),{name:n}):m))}onBlockRepeatsChange(e,t){let n=this.normalizeRepeats(t);this.blocks.update(c=>c.map(m=>m.id===e?j(N({},m),{repeats:n}):m))}onRowPaceChange(e,t,n){this.updateRow(e,t,c=>j(N({},c),{pace:this.sanitizePaceInput(n)}))}onRowPaceUnitChange(e,t,n){let c=n.detail.value==="mi"?"mi":"km";this.updateRow(e,t,m=>j(N({},m),{paceUnit:c}))}onRowDurationChange(e,t,n){this.updateRow(e,t,c=>j(N({},c),{duration:this.sanitizeDurationInput(n)}))}onRowKnownDistanceChange(e,t,n){this.updateRow(e,t,c=>j(N({},c),{knownDistance:this.sanitizeKnownDistanceInput(n)}))}onRowKnownDistanceUnitChange(e,t,n){let c=n.detail.value,m=c==="km"||c==="mi"?c:"m";this.updateRow(e,t,_=>j(N({},_),{knownDistanceUnit:m}))}getRowDistanceMeters(e){let t=this.getKnownDistanceMeters(e);if(t>0)return t;let n=this.getDurationSeconds(e.duration),c=this.getPaceSeconds(e.pace);if(n<=0||c<=0)return 0;let m=e.paceUnit==="mi"?Qe:Re;return n/c*m}getRowDurationSeconds(e){let t=this.getDurationSeconds(e.duration);if(t>0)return t;let n=this.getKnownDistanceMeters(e),c=this.getPaceSeconds(e.pace);if(n<=0||c<=0)return 0;let m=e.paceUnit==="mi"?Qe:Re;return n/m*c}getRowDurationLabel(e){let t=this.getRowDurationSeconds(e);return t<=0?"--":rt(t)}getEffectivePaceLabel(e){let t=this.getKnownDistanceMeters(e),n=this.getDurationSeconds(e.duration);if(t<=0||n<=0)return null;let c=e.paceUnit==="mi"?Qe:Re,m=n/t*c;return!Number.isFinite(m)||m<=0?null:`${si(m)}/${e.paceUnit}`}getBlockDistanceLabel(e){return this.formatMeters(this.getBlockEstimate(e).totalDistanceMeters)}formatMeters(e){return e<=0?"0.00 km":e<Re?`${Math.round(e)} m`:`${(e/Re).toFixed(2)} km`}updateRow(e,t,n){this.blocks.update(c=>c.map(m=>m.id!==e?m:j(N({},m),{rows:m.rows.map(_=>_.id===t?n(_):_)})))}buildSummary(e){let t=0,n=0,c=!1,m=!0;for(let y of e){let B=this.normalizeRepeats(y.repeats);for(let V of y.rows){let F=this.getRowDistanceMeters(V);if(F<=0)continue;c=!0,t+=F*B;let ve=this.getRowDurationSeconds(V);ve>0?n+=ve*B:m=!1}}let _=this.preferredDistanceUnit==="mi"?`${(t/Qe).toFixed(2)} mi`:this.formatMeters(t),P=this.preferredDistanceUnit==="mi"?`${(t/Re).toFixed(2)} km`:`${(t/Qe).toFixed(2)} mi`;return{totalDistanceMeters:t,totalDurationSeconds:n,hasDistance:c,hasCompleteDuration:m,primaryDistance:_,secondaryDistance:P,durationDisplay:c&&m&&n>0?rt(n):null}}buildWorkoutCopyText(e,t){let n=[];return n.push("Workout Plan"),n.push(`Estimated Distance: ${t.primaryDistance} (${t.secondaryDistance})`),t.durationDisplay&&n.push(`Estimated Duration: ${t.durationDisplay}`),n.push(""),e.forEach((c,m)=>{let _=this.getBlockEstimate(c),P=this.getBlockName(c,m);n.push(`Block ${m+1}: ${P} x${_.repeats}`),n.push(`Distance: ${this.formatMeters(_.totalDistanceMeters)}`),_.hasDistance&&_.hasCompleteDuration&&_.totalDurationSeconds>0&&n.push(`Duration: ${rt(_.totalDurationSeconds)}`),c.rows.forEach((y,B)=>{let V=[];y.pace.trim()&&V.push(`${y.pace}/${y.paceUnit}`),y.duration.trim()&&V.push(`for ${y.duration}`),y.knownDistance.trim()?V.push(`${y.knownDistance}${y.knownDistanceUnit}`):V.push(this.formatMeters(this.getRowDistanceMeters(y)));let F=this.getEffectivePaceLabel(y);F&&V.push(`effective ${F}`),n.push(`- Step ${B+1}: ${V.join(" | ")}`)}),n.push("")}),n.join(`
`).trim()}async writeTextToClipboard(e){var t;try{return await Gi.write({string:e}),!0}catch{}try{if((t=navigator==null?void 0:navigator.clipboard)!=null&&t.writeText)return await navigator.clipboard.writeText(e),!0}catch{}try{let n=document.createElement("textarea");n.value=e,n.setAttribute("readonly","true"),n.style.position="fixed",n.style.opacity="0",document.body.appendChild(n),n.select();let c=document.execCommand("copy");return document.body.removeChild(n),c}catch{return!1}}armDelete(e){this.clearDeleteArm(),this.deleteArmedTarget.set(e),this.deleteArmTimer=setTimeout(()=>{this.deleteArmedTarget.set(null),this.deleteArmTimer=void 0},jo)}clearDeleteArm(e){let t=this.deleteArmedTarget();e!==void 0&&t!==e||(this.deleteArmTimer&&(clearTimeout(this.deleteArmTimer),this.deleteArmTimer=void 0),this.deleteArmedTarget.set(null))}getBlockDeleteArmKey(e){return`block:${e}`}getStepDeleteArmKey(e,t){return`step:${e}:${t}`}getBlockEstimate(e){let t=this.normalizeRepeats(e.repeats),n=0,c=0,m=!1,_=!0;for(let P of e.rows){let y=this.getRowDistanceMeters(P);if(y<=0)continue;m=!0,n+=y*t;let B=this.getRowDurationSeconds(P);B>0?c+=B*t:_=!1}return{totalDistanceMeters:n,totalDurationSeconds:c,hasDistance:m,hasCompleteDuration:_,rowCount:e.rows.length,repeats:t}}createSavedWorkoutId(){return this.idSeed+=1,`saved-workout-${this.idSeed}`}cloneBlocks(e){return e.map(t=>({id:t.id,name:t.name,repeats:t.repeats,rows:t.rows.map(n=>({id:n.id,pace:n.pace,paceUnit:n.paceUnit,duration:n.duration,knownDistance:n.knownDistance,knownDistanceUnit:n.knownDistanceUnit}))}))}normalizeWorkoutName(e){return String(e??"").trim().slice(0,Ze)}async presentToast(e){await(await this.toastCtrl.create({message:e,duration:1800,position:"top",cssClass:"toast-message"})).present()}normalizePlan(e){let t=Array.isArray(e==null?void 0:e.blocks)?e.blocks:[],n=new Set,c=(y,B)=>{let V=this.trackExistingId(B);if(V&&!n.has(V))return n.add(V),V;let F=this.createId(y);for(;n.has(F);)F=this.createId(y);return n.add(F),F},m=[];for(let y of t){if(!y||typeof y!="object")continue;if(m.length>=Jt)break;let B=Array.isArray(y.rows)?y.rows:[],V=[];for(let F of B)if(!(!F||typeof F!="object")){if(V.length>=Yi)break;V.push({id:c("row",F.id),pace:this.sanitizePaceInput(F.pace),paceUnit:F.paceUnit==="mi"?"mi":this.defaultPaceUnit,duration:this.sanitizeDurationInput(F.duration),knownDistance:this.sanitizeKnownDistanceInput(F.knownDistance),knownDistanceUnit:F.knownDistanceUnit==="km"||F.knownDistanceUnit==="mi"||F.knownDistanceUnit==="m"?F.knownDistanceUnit:"m"})}V.length||V.push(this.createDefaultRow()),m.push({id:c("block",y.id),name:String(y.name||"").slice(0,Ze)||`Block ${m.length+1}`,repeats:this.normalizeRepeats(y.repeats),rows:V})}let P=(Array.isArray(e==null?void 0:e.savedWorkouts)?e.savedWorkouts:[]).filter(y=>!y||typeof y!="object"?!1:typeof y.name=="string"&&y.name.trim().length>0).slice(0,qi).map((y,B)=>({id:typeof y.id=="string"&&y.id.trim().length>0?y.id:`saved-workout-${B+1}`,name:y.name.trim().slice(0,Ze),blocks:this.cloneBlocks(Array.isArray(y.blocks)?y.blocks:[]),updatedAt:typeof y.updatedAt=="string"?y.updatedAt:new Date(0).toISOString()})).filter(y=>y.blocks.length>0);return m.length?{blocks:m,savedWorkouts:P,updatedAt:(e==null?void 0:e.updatedAt)??null}:{blocks:[{id:this.createId("block"),name:"Block 1",repeats:1,rows:[this.createDefaultRow()]}],savedWorkouts:P,updatedAt:null}}createDefaultRow(){return{id:this.createId("row"),pace:"",paceUnit:this.defaultPaceUnit,duration:"",knownDistance:"",knownDistanceUnit:"m"}}createId(e){return this.idSeed+=1,`${e}-${this.idSeed}`}trackExistingId(e){if(typeof e!="string"||!e.trim())return null;let t=e.trim(),n=t.match(/-(\d+)$/);if(n){let c=Number(n[1]);Number.isFinite(c)&&(this.idSeed=Math.max(this.idSeed,c))}return t}normalizeRepeats(e){let t=Number(e);return Number.isFinite(t)?Math.min(Wo,Math.max(1,Math.floor(t))):1}sanitizePaceInput(e){let t=String(e??"").replace(/\D/g,"").slice(-4);return t?this.formatDigitsRightToLeft(t,[2,2]):""}sanitizeDurationInput(e){let t=String(e??"").replace(/\D/g,"").slice(-6);return t?this.formatDigitsRightToLeft(t,[2,2,2]):""}formatDigitsRightToLeft(e,t){let n=e.replace(/\D/g,"");if(!n)return"";let c=t.reduce((B,V)=>B+V,0),_=n.slice(-c).padStart(c,"0"),P=0;return t.map(B=>{let V=_.slice(P,P+B);return P+=B,V}).join(":")}sanitizeKnownDistanceInput(e){let t=String(e??"").replace(/[^0-9.]/g,"");if(!t)return"";let n=t.indexOf(".");if(n<0)return t.slice(0,8);let c=t.slice(0,n).slice(0,6),m=t.slice(n+1).replace(/\./g,"").slice(0,3);return m?`${c}.${m}`:c}getPaceSeconds(e){return!e||!e.includes(":")?0:Et(e)}getDurationSeconds(e){return!e||!e.includes(":")?0:qe(e)}getKnownDistanceMeters(e){let t=Number(e.knownDistance);return!Number.isFinite(t)||t<=0?0:e.knownDistanceUnit==="km"?t*Re:e.knownDistanceUnit==="mi"?t*Qe:t}};l.\u0275fac=function(t){return new(t||l)},l.\u0275cmp=R({type:l,selectors:[["app-distance-estimator-modal"]],inputs:{plan:"plan",defaultPaceUnit:"defaultPaceUnit",preferredDistanceUnit:"preferredDistanceUnit"},decls:38,vars:6,consts:[[1,"estimate-header","safe-area-inline"],[1,"estimate-toolbar"],["slot","start"],["aria-label","Back to calculator","fill","clear",1,"estimate-back-btn",3,"click"],["slot","icon-only","name","arrow-back-outline"],[1,"safe-area-content","estimate-content"],[1,"mobile-bottom-safe","mx-auto","flex","w-full","max-w-3xl","flex-col","gap-3","px-3","py-3"],[1,"calc-surface-card","px-3","py-3"],[1,"estimate-section-title"],[1,"calc-muted-copy","mt-1","text-sm"],[1,"calc-surface-card","estimate-block-card","px-3","py-3"],["fill","outline",1,"estimate-add-block-btn",3,"click","disabled"],["slot","start","name","add-outline"],["fill","outline",1,"estimate-copy-workout-btn",3,"click","disabled"],["slot","start","name","copy-outline"],[1,"estimate-footer","safe-area-inline"],[1,"estimate-footer-toolbar"],[1,"estimate-footer-inner"],[1,"estimate-footer-actions"],["aria-label","Load saved workout","fill","clear",1,"estimate-footer-load-btn",3,"click"],["slot","icon-only","name","folder-open-outline"],[1,"estimate-footer-kicker"],[1,"estimate-footer-total"],[1,"estimate-footer-secondary"],[1,"estimate-footer-duration"],[1,"estimate-footer-duration","estimate-footer-duration-muted"],[1,"estimate-save-btn",3,"click","disabled"],[1,"estimate-block-head"],[1,"estimate-block-head-copy"],[1,"estimate-block-kicker"],[1,"estimate-block-title"],[1,"estimate-block-head-actions"],["fill","clear",1,"estimate-collapse-btn",3,"click"],["slot","icon-only",3,"name"],["fill","clear",1,"estimate-delete-btn",3,"click","disabled"],[1,"estimate-block-body"],[1,"estimate-block-collapsed-meta"],[1,"estimate-block-collapsed-duration"],[1,"estimate-block-controls"],["mode","md","label","Name","label-placement","stacked","autocapitalize","words","fill","outline",3,"ngModelChange","maxlength","ngModel"],["mode","md","label","Repeats","label-placement","stacked","type","number","min","1","max","999","fill","outline",3,"ngModelChange","ngModel"],[1,"estimate-row-list"],[1,"calc-shell-subtle","estimate-row-card","rounded-xl","px-3","py-3"],[1,"estimate-block-actions"],[1,"estimate-block-actions-left"],["fill","outline",1,"estimate-action-btn",3,"click"],["fill","outline","aria-label","Collapse block",1,"estimate-action-btn","estimate-collapse-shortcut-btn",3,"click"],["slot","icon-only","name","chevron-up-outline"],[1,"estimate-block-summary"],[1,"estimate-block-summary-title"],[1,"estimate-block-summary-value"],[1,"estimate-row-head"],[1,"estimate-row-label"],[1,"estimate-row-grid"],[1,"estimate-input-with-segment"],["mode","md","label","Pace","label-placement","stacked","placeholder","00:00","inputmode","numeric","fill","outline",3,"ngModelChange","ngModel"],["mode","ios",1,"app-segment","estimate-mini-segment",3,"ionChange","value"],["value","km"],["value","mi"],["mode","md","label","Duration","label-placement","stacked","placeholder","00:00:00","inputmode","numeric","fill","outline",3,"ngModelChange","ngModel"],["mode","md","label","Known interval distance (optional)","label-placement","stacked","placeholder","400","inputmode","decimal","fill","outline",3,"ngModelChange","ngModel"],["value","m"],[1,"estimate-row-readout"],[1,"estimate-row-readout-title"],[1,"estimate-row-readout-value"],[1,"estimate-row-readout-subtle"]],template:function(t,n){if(t&1&&(a(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-button",3),u("click",function(){return n.dismiss()}),b(4,"ion-icon",4),o()(),a(5,"ion-title"),s(6,"Estimate distance"),o()()(),a(7,"ion-content",5)(8,"div",6)(9,"section",7)(10,"h2",8),s(11,"Workout blocks"),o(),a(12,"p",9),s(13," Build your workout using pace + duration steps. Add known interval distance when you already know a rep distance. "),o()(),S(14,No,14,11,"section",10,Qi),a(16,"ion-button",11),u("click",function(){return n.addBlock()}),b(17,"ion-icon",12),s(18," Add block "),o(),a(19,"ion-button",13),u("click",function(){return n.copyWorkout()}),b(20,"ion-icon",14),s(21," Copy Workout "),o()()(),a(22,"ion-footer",15)(23,"ion-toolbar",16)(24,"div",17)(25,"div",18)(26,"ion-button",19),u("click",function(){return n.openLoadWorkoutPicker()}),b(27,"ion-icon",20),o()(),a(28,"p",21),s(29,"Estimated distance"),o(),a(30,"p",22),s(31),o(),a(32,"p",23),s(33),o(),x(34,zo,2,1,"p",24)(35,Ho,2,0,"p",25),a(36,"ion-button",26),u("click",function(){return n.promptSaveWorkout()}),s(37," Save Workout "),o()()()()),t&2){let c;d(14),O(n.blocks()),d(2),h("disabled",n.blocks().length>=n.maxBlocks),d(3),h("disabled",!n.canCopyWorkout()),d(12),v(n.summary().primaryDistance),d(2),v(n.summary().secondaryDistance),d(),C((c=n.summary().durationDisplay)?34:35,c),d(2),h("disabled",!n.canSaveWorkout())}},dependencies:[$,ge,$e,bt,Le,re,ce,oe,Y,se,H,K,He,fe,Z,Q,le],styles:[".estimate-header[_ngcontent-%COMP%]{border-bottom:1px solid color-mix(in oklab,var(--calc-border-subtle) 78%,transparent)}.estimate-toolbar[_ngcontent-%COMP%]{--background: color-mix(in oklab, var(--calc-surface-raised) 88%, var(--calc-accent) 12%);--color: var(--calc-text-strong)}.estimate-back-btn[_ngcontent-%COMP%]{--color: var(--calc-text-strong)}.estimate-content[_ngcontent-%COMP%]{--background: color-mix(in oklab, var(--calc-surface-0) 88%, transparent)}.estimate-section-title[_ngcontent-%COMP%]{color:var(--calc-text-strong);font-size:.86rem;font-weight:700;letter-spacing:.08em;margin:0;text-transform:uppercase}.estimate-block-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.estimate-block-head[_ngcontent-%COMP%]{align-items:flex-start;display:flex;justify-content:space-between;gap:.35rem}.estimate-block-head-copy[_ngcontent-%COMP%]{min-width:0}.estimate-block-head-actions[_ngcontent-%COMP%]{align-items:center;display:flex;gap:.15rem}.estimate-block-kicker[_ngcontent-%COMP%]{color:var(--calc-text-muted);font-size:.72rem;font-weight:700;letter-spacing:.08em;margin:0;text-transform:uppercase}.estimate-block-title[_ngcontent-%COMP%]{color:var(--calc-text-strong);font-size:1rem;font-weight:700;margin:.1rem 0 0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.estimate-block-collapsed-meta[_ngcontent-%COMP%], .estimate-block-collapsed-duration[_ngcontent-%COMP%]{color:var(--calc-text-muted);font-size:.78rem;margin:.16rem 0 0}.estimate-block-collapsed-duration[_ngcontent-%COMP%]{font-variant-numeric:tabular-nums}.estimate-collapse-btn[_ngcontent-%COMP%]{--color: var(--calc-text-strong);--background: transparent;--background-hover: transparent;--background-activated: transparent;--box-shadow: none;min-height:44px;min-width:44px}.estimate-block-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.estimate-delete-btn[_ngcontent-%COMP%]{--color: color-mix(in oklab, var(--calc-danger) 88%, var(--calc-text-strong));--background: transparent;--background-hover: transparent;--background-activated: transparent;--box-shadow: none;min-height:44px;min-width:44px}.estimate-delete-btn-armed[_ngcontent-%COMP%]{--color: color-mix(in oklab, #f97316 86%, var(--calc-text-strong));--background: color-mix(in oklab, #f97316 18%, transparent);--background-hover: color-mix(in oklab, #f97316 24%, transparent);--background-activated: color-mix(in oklab, #f97316 28%, transparent);border-radius:9999px}.estimate-block-controls[_ngcontent-%COMP%]{display:grid;gap:.6rem;grid-template-columns:1.8fr 1fr}.estimate-row-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.55rem}.estimate-row-card[_ngcontent-%COMP%]{border-radius:12px}.estimate-row-head[_ngcontent-%COMP%]{align-items:center;display:flex;justify-content:space-between}.estimate-row-label[_ngcontent-%COMP%]{color:var(--calc-text-muted);font-size:.75rem;font-weight:700;letter-spacing:.04em;margin:0;text-transform:uppercase}.estimate-row-grid[_ngcontent-%COMP%]{display:grid;gap:.55rem;grid-template-columns:1fr}.estimate-row-grid[_ngcontent-%COMP%] + .estimate-row-grid[_ngcontent-%COMP%]{margin-top:.55rem}.estimate-input-with-segment[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.35rem}.estimate-mini-segment[_ngcontent-%COMP%]{max-width:220px}.estimate-row-readout[_ngcontent-%COMP%]{border:1px solid color-mix(in oklab,var(--calc-border-subtle) 72%,transparent);border-radius:10px;padding:.55rem .6rem}.estimate-row-readout-title[_ngcontent-%COMP%]{color:var(--calc-text-muted);font-size:.68rem;font-weight:700;letter-spacing:.08em;margin:0;text-transform:uppercase}.estimate-row-readout-value[_ngcontent-%COMP%]{color:var(--calc-text-strong);font-size:.95rem;font-variant-numeric:tabular-nums;font-weight:700;margin:.2rem 0 0}.estimate-row-readout-subtle[_ngcontent-%COMP%]{color:var(--calc-text-muted);font-size:.73rem;margin:.15rem 0 0}.estimate-block-actions[_ngcontent-%COMP%]{align-items:center;display:flex;gap:.55rem;justify-content:space-between}.estimate-block-actions-left[_ngcontent-%COMP%]{align-items:center;display:flex;gap:.45rem}.estimate-action-btn[_ngcontent-%COMP%], .estimate-add-block-btn[_ngcontent-%COMP%], .estimate-copy-workout-btn[_ngcontent-%COMP%]{--color: var(--calc-text-strong);--border-color: var(--calc-border-strong);--border-radius: var(--calc-radius-md);--background: transparent;min-height:44px}.estimate-copy-workout-btn[_ngcontent-%COMP%]{margin-top:-.15rem}.estimate-collapse-shortcut-btn[_ngcontent-%COMP%]{min-width:44px}.estimate-block-summary[_ngcontent-%COMP%]{text-align:right}.estimate-block-summary-title[_ngcontent-%COMP%]{color:var(--calc-text-muted);font-size:.68rem;letter-spacing:.08em;margin:0;text-transform:uppercase}.estimate-block-summary-value[_ngcontent-%COMP%]{color:var(--calc-text-strong);font-size:.95rem;font-variant-numeric:tabular-nums;font-weight:700;margin:.2rem 0 0}.estimate-footer[_ngcontent-%COMP%]{border-top:1px solid color-mix(in oklab,var(--calc-border-subtle) 78%,transparent)}.estimate-footer-toolbar[_ngcontent-%COMP%]{--background: color-mix(in oklab, var(--calc-surface-raised) 89%, var(--calc-accent) 11%)}.estimate-footer-inner[_ngcontent-%COMP%]{margin:0 auto;max-width:720px;position:relative;padding:.65rem .8rem calc(.6rem + max(var(--ion-safe-area-bottom, 0px),env(safe-area-inset-bottom,0px)))}.estimate-footer-kicker[_ngcontent-%COMP%]{color:var(--calc-text-muted);font-size:.72rem;font-weight:700;letter-spacing:.08em;margin:0;text-transform:uppercase}.estimate-footer-total[_ngcontent-%COMP%]{color:var(--calc-text-strong);font-size:1.6rem;font-variant-numeric:tabular-nums;font-weight:800;line-height:1.1;margin:.18rem 0 0}.estimate-footer-secondary[_ngcontent-%COMP%]{color:var(--calc-text-muted);font-size:.86rem;margin:.2rem 0 0}.estimate-footer-duration[_ngcontent-%COMP%]{color:var(--calc-text-strong);font-size:.82rem;margin:.35rem 0 0}.estimate-footer-duration-muted[_ngcontent-%COMP%]{color:var(--calc-text-muted)}.estimate-footer-actions[_ngcontent-%COMP%]{position:absolute;right:.8rem;top:.55rem}.estimate-footer-load-btn[_ngcontent-%COMP%]{--color: var(--calc-text-strong);--background: color-mix(in oklab, var(--calc-surface-raised) 86%, transparent);--background-hover: color-mix(in oklab, var(--calc-surface-raised) 92%, white 8%);--background-activated: color-mix(in oklab, var(--calc-surface-raised) 94%, white 10%);--border-radius: 9999px;--box-shadow: none;min-height:44px;min-width:44px}.estimate-save-btn[_ngcontent-%COMP%]{--color: #ffffff;--background: var(--calc-accent-strong);--background-hover: color-mix(in oklab, var(--calc-accent-strong) 88%, black);--background-activated: color-mix(in oklab, var(--calc-accent-strong) 82%, black);--border-radius: var(--calc-radius-md);--ion-toolbar-background: #ffffff;display:block;margin:.6rem auto 0;min-height:48px;width:min(100%,320px)}ion-input[_ngcontent-%COMP%]{--border-color: color-mix(in oklab, var(--calc-text-muted) 40%, transparent);--highlight-color-focused: var(--calc-accent-strong);--highlight-color-valid: var(--calc-accent-strong);--color: var(--calc-text-strong)}@media (min-width: 768px){.estimate-row-grid[_ngcontent-%COMP%]{grid-template-columns:1.4fr 1fr}}"]});let r=l;return r})();var Uo=la(sa(),1);var Ko=(r,l,i)=>({lockType:r,isInputCollapsed:l,focusId:i}),Go=(r,l,i,e,t,n,c)=>({focusId:r,focusedResult:l,paceType:i,distance:e,distanceType:t,time:n,pace:c}),Yo=(r,l,i,e,t,n,c,m,_)=>({inputType:r,distance:l,pace:i,time:e,distanceType:t,paceType:n,lockType:c,isInputCollapsed:m,focusId:_}),qo=r=>({paceType:r}),Qo=(r,l,i,e)=>({splitsChartReady:r,splitsChartOptions:l,splitPlan:i,splits:e}),Zo=()=>[],en=r=>({"fixed-metric-chip-active":r}),tn=r=>({"input-metric-card-active":r}),Xi=r=>({"metric-highlight":r}),Xo=(r,l)=>l.id;function Jo(r,l){r&1&&s(0," Reverse heat adjustment active at ")}function er(r,l){r&1&&s(0," Pace adjusted for heat at ")}function tr(r,l){r&1&&(b(0,"br"),s(1,"to estimate your equivalent cool-weather time. "))}function nr(r,l){if(r&1){let i=k();a(0,"div",14)(1,"div"),x(2,Jo,1,0)(3,er,1,0),a(4,"span",34),s(5),o(),x(6,tr,2,0),o(),a(7,"button",35),u("click",function(){g(i);let t=p();return f(t.clearHeatAdjustment())}),b(8,"ion-icon",36),o()()}if(r&2){let i=p();d(2),C(i.heatAdjustment().direction==="reverse"?2:3),d(3),te(" ",i.heatAdjustment().temperature+"\xB0"+i.heatAdjustment().temperatureType.toUpperCase()," & ",i.heatAdjustment().dewPoint+"\xB0"+i.heatAdjustment().temperatureType.toUpperCase()," dewpoint "),d(),C(i.heatAdjustment().direction==="reverse"?6:-1)}}function ir(r,l){if(r&1){let i=k();a(0,"article",37)(1,"div",38)(2,"div",39)(3,"button",40),u("click",function(){g(i);let t=p().$implicit,n=p();return f(n.setDistance(t.distanceInMeters))}),s(4),o()(),a(5,"div",41)(6,"p",42),s(7),o()(),a(8,"div",43)(9,"p",42),s(10),o()(),a(11,"div",44)(12,"ion-button",45),u("click",function(){g(i);let t=p().$implicit,n=p();return f(n.viewResultDetails(t.id))}),b(13,"ion-icon",46),o()()()()}if(r&2){let i=l,e=p().$implicit,t=p();d(3),L("aria-label","Use "+e.type+" distance"),d(),T(" ",e.type," "),d(2),w("flash-highlight",t.highlightResults()),d(),v(e.time),d(2),w("flash-highlight",t.highlightResults()),d(),te(" ",e.pace," ","/"+(i.paceType==="m400"?"400m":i.paceType)," "),d(2),w("details-button-pop",t.activeDetailsButtonPop()==="row-"+e.id),L("aria-label","View details for "+e.type)}}function ar(r,l){if(r&1&&(x(0,ir,14,12,"article",37),I(1,"async")),r&2){let i,e=p();C((i=me(3,qo,E(1,1,e.paceType$)))?0:-1,i)}}function or(r,l){if(r&1){let i=k();a(0,"div",47)(1,"app-splits-panel",48),u("splitHalfDeltaChange",function(t){g(i);let n=p(3);return f(n.handleSplitHalfDeltaChange(t))})("splitHalfDeltaReset",function(){g(i);let t=p(3);return f(t.handleSplitHalfDeltaReset())})("splitStrategyProfileChange",function(t){g(i);let n=p(3);return f(n.handleSplitStrategyProfileChange(t))})("splitTransitionPointChange",function(t){g(i);let n=p(3);return f(n.handleSplitTransitionPointChange(t))})("splitLapTagChange",function(t){g(i);let n=p(3);return f(n.handleSplitLapTagChange(t))})("splitLapTagsReset",function(){g(i);let t=p(3);return f(t.handleSplitLapTagsReset())}),o()()}if(r&2){let i=l,e=p(3);h("@focusTabPane","active"),d(),h("highcharts",e.highcharts)("splitsChartReady",!!i.splitsChartReady)("splitsChartOptions",i.splitsChartOptions)("splitPlan",i.splitPlan)("splits",i.splits||hn(6,Zo))}}function rr(r,l){if(r&1&&(x(0,or,2,7,"div",47),I(1,"async"),I(2,"async"),I(3,"async"),I(4,"async")),r&2){let i,e=p(2);C((i=fn(9,Qo,E(1,1,e.splitsChartReady$),E(2,3,e.splitsChartOptions$),E(3,5,e.splitPlan$),E(4,7,e.splits$)))?0:-1,i)}}function lr(r,l){if(r&1){let i=k();a(0,"div",47)(1,"app-training-paces-panel",49),u("openTypeInfo",function(t){g(i);let n=p(2);return f(n.openTrainingTypeInfo(t))}),o()()}if(r&2){let i=p(2);h("@focusTabPane","active"),d(),h("tableMode",i.trainingTableMode())("trainingRows",i.trainingRows())("repRowsPrimary",i.repRowsPrimary())("repRowsSecondary",i.repRowsSecondary())}}function sr(r,l){if(r&1){let i=k();a(0,"div",47)(1,"app-lthr-panel",50),u("lthrBpmChange",function(t){g(i);let n=p(2);return f(n.onLthrBpmChange(t))})("openInfo",function(){g(i);let t=p(2);return f(t.openLthrInfo())}),o()()}if(r&2){let i=p(2);h("@focusTabPane","active"),d(),h("lthrSummary",i.lthrSummary())("lthrBpm",i.lthrBpm())}}function cr(r,l){if(r&1){let i=k();a(0,"div",47)(1,"app-blocks-panel",51),u("navigateToTab",function(t){g(i);let n=p(2);return f(n.onFocusTabChange(t))}),o()()}if(r&2){let i,e,t=p(2);h("@focusTabPane","active"),d(),h("distanceMeters",((i=t.goalPerformance())==null?null:i.distanceMeters)||0)("hasValidBaseline",(((e=t.goalPerformance())==null?null:e.timeSeconds)||0)>0)("distanceType",t.distanceType())("focusId",t.focusId())}}function dr(r,l){if(r&1&&(a(0,"div",16),x(1,rr,5,14)(2,lr,2,5,"div",47)(3,sr,2,3,"div",47)(4,cr,2,5,"div",47),o()),r&2){let i,e=p();d(),C((i=e.activeFocusTab())==="splits"?1:i==="training"?2:i==="lthr"?3:i==="blocks"?4:-1)}}function mr(r,l){if(r&1){let i=k();a(0,"div",53)(1,"div",54)(2,"button",55),u("click",function(t){g(i);let n=p(2);return f(n.onLockTypeChange(t,"distance"))}),b(3,"ion-icon",56),s(4),o(),a(5,"button",57),u("click",function(t){g(i);let n=p(2);return f(n.onLockTypeChange(t,"time"))}),b(6,"ion-icon",56),s(7),o(),a(8,"button",58),u("click",function(t){g(i);let n=p(2);return f(n.onLockTypeChange(t,"pace"))}),b(9,"ion-icon",56),s(10),o()()()}if(r&2){let i=p(),e=p();w("keyboard-collapsing",e.isKeyboardCollapsing())("pin-row-hidden-instant",i.focusId!==null||i.isInputCollapsed),h("@keyboardPanel",void 0),d(2),h("ngClass",me(14,en,i.lockType==="distance")),d(),h("name",i.lockType==="distance"?"pin":"pin-outline"),d(),T(" ",i.lockType==="distance"?"Distance Pinned":"Pin Distance"," "),d(),h("ngClass",me(16,en,i.lockType==="time")),d(),h("name",i.lockType==="time"?"pin":"pin-outline"),d(),T(" ",i.lockType==="time"?"Time Pinned":"Pin Time"," "),d(),h("ngClass",me(18,en,i.lockType==="pace")),d(),h("name",i.lockType==="pace"?"pin":"pin-outline"),d(),T(" ",i.lockType==="pace"?"Pace Pinned":"Pin Pace"," ")}}function pr(r,l){if(r&1&&x(0,mr,11,20,"div",52),r&2){let i=p();h("ngIf",i.isKeyboardShowing())}}function ur(r,l){if(r&1){let i=k();a(0,"div",20)(1,"div",59)(2,"app-focused-performance-tabs",60),u("activeTabChange",function(t){g(i);let n=p();return f(n.onFocusTabChange(t))}),o()()()}if(r&2){let i=p();d(2),h("activeTab",i.activeFocusTab())}}function hr(r,l){if(r&1&&(a(0,"ion-label")(1,"p",65),s(2),o(),a(3,"h1",66),s(4),o(),a(5,"p",67),s(6),o()()),r&2){let i=p(2);d(2),v(i.focusedResult.type),d(2),v(i.focusedResult.time),d(2),te(" ",i.focusedResult.pace,"","/"+(i.paceType==="m400"?"400m":i.paceType)," ")}}function gr(r,l){if(r&1&&(a(0,"ion-label")(1,"p",65),s(2),o(),a(3,"h1",66),s(4),o(),a(5,"p",67),s(6),o()()),r&2){let i=p(2);d(2),te("",i.distance,"",i.distanceType,""),d(2),v(i.time),d(2),te("",i.pace,"","/"+(i.paceType==="m400"?"400m":i.paceType),"")}}function fr(r,l){if(r&1){let i=k();a(0,"ion-item",72),u("click",function(){let t=g(i).$implicit;p(2);let n=Ae(3),c=p(3);return n.dismiss(),f(c.useSplitsTool(t.command))}),a(1,"ion-label"),s(2),o()()}if(r&2){let i=l.$implicit;d(2),v(i.label)}}function _r(r,l){if(r&1&&(a(0,"ion-list",70),S(1,fr,3,1,"ion-item",71,pe),o()),r&2){let i=p(4);d(),O(i.splitsToolsMap)}}function br(r,l){r&1&&(a(0,"button",68),s(1,"Split By"),o(),a(2,"ion-popover",69,0),x(4,_r,3,0,"ng-template"),o())}function xr(r,l){if(r&1){let i=k();a(0,"ion-segment",73),u("ionChange",function(t){g(i);let n=p(3);return f(n.onModeChange(t))}),a(1,"ion-segment-button",74)(2,"ion-label"),s(3,"Road"),o()(),a(4,"ion-segment-button",75)(5,"ion-label"),s(6,"Track"),o()()()}if(r&2){let i=p(3);h("value",i.trainingTableMode())}}function Cr(r,l){if(r&1){let i=k();a(0,"ion-item",61)(1,"ion-button",62),u("click",function(){g(i);let t=p(2);return f(t.setFocus(null))}),b(2,"ion-icon",63),o(),x(3,hr,7,4,"ion-label")(4,gr,7,5,"ion-label")(5,br,5,0)(6,xr,7,1,"ion-segment",64),o()}if(r&2){let i,e,t=p(),n=p();d(3),C(t.focusId!==-1&&t.focusedResult?3:4),d(2),C(n.activeFocusTab()==="splits"&&(((i=n.goalPerformance())==null?null:i.timeSeconds)||0)>0?5:-1),d(),C(n.activeFocusTab()==="training"&&(((e=n.goalPerformance())==null?null:e.timeSeconds)||0)>0?6:-1)}}function vr(r,l){r&1&&x(0,Cr,7,3,"ion-item",61),r&2&&C(l.focusId!==null?0:-1)}function yr(r,l){r&1&&b(0,"ion-icon",78)}function kr(r,l){r&1&&b(0,"ion-icon",78)}function wr(r,l){r&1&&b(0,"ion-icon",78)}function Pr(r,l){if(r&1){let i=k();a(0,"div",76)(1,"button",77),u("click",function(){g(i);let t=p();return f(t.onInputTypeChange("distance"))}),x(2,yr,1,0,"ion-icon",78),a(3,"ion-label",79)(4,"span",80)(5,"span",81),s(6," Enter "),o(),a(7,"span",82),s(8,"Distance"),o()()(),a(9,"div",83)(10,"p",84),s(11),o(),a(12,"p",85),s(13),o()()(),a(14,"button",86),u("click",function(){g(i);let t=p();return f(t.onInputTypeChange("time"))}),x(15,kr,1,0,"ion-icon",78),a(16,"ion-label",79)(17,"span",80)(18,"span",81),s(19," Enter "),o(),a(20,"span",82),s(21,"Time"),o()()(),a(22,"div",83)(23,"p",87),s(24),o()()(),a(25,"button",88),u("click",function(){g(i);let t=p();return f(t.onInputTypeChange("pace"))}),x(26,wr,1,0,"ion-icon",78),a(27,"ion-label",79)(28,"span",80)(29,"span",81),s(30," Enter "),o(),a(31,"span",82),s(32,"Pace"),o()()(),a(33,"div",83)(34,"p",87),s(35),o(),a(36,"p",89),s(37),o()()()()}if(r&2){let i=l,e=p();w("hidden",i.isInputCollapsed||i.focusId!==null),d(),h("ngClass",me(21,tn,i.inputType==="distance")),d(),C(i.lockType==="distance"?2:-1),d(3),w("metric-enter-prefix-visible",i.inputType==="distance"&&e.showKeyboardInputPrompt()),d(5),h("ngClass",me(23,Xi,e.highlightDistance())),d(),T(" ",i.distance||"0"," "),d(),h("ngClass",me(25,Xi,e.highlightDistance())),d(),v(i.distanceType),d(),h("ngClass",me(27,tn,i.inputType==="time")),d(),C(i.lockType==="time"?15:-1),d(3),w("metric-enter-prefix-visible",i.inputType==="time"&&e.showKeyboardInputPrompt()),d(6),v(i.time||"00:00:00"),d(),h("ngClass",me(29,tn,i.inputType==="pace")),d(),C(i.lockType==="pace"?26:-1),d(3),w("metric-enter-prefix-visible",i.inputType==="pace"&&e.showKeyboardInputPrompt()),d(6),v(i.pace||"00:00"),d(2),v("/"+(i.paceType==="m400"?"400m":i.paceType))}}function Tr(r,l){if(r&1){let i=k();a(0,"ion-col",91)(1,"app-calculator-input",102),u("inputChange",function(t){g(i);let n=p(2);return f(n.onAdjustmentChange(t))}),o()()}if(r&2){let i=p(2);d(),h("collapseMode",i.isKeyboardCollapsing())("buttonRows",l)}}function Mr(r,l){if(r&1){let i=k();a(0,"ion-item",72),u("click",function(){let t=g(i).$implicit;p(2);let n=Ae(13),c=p();return f(c.onDistanceToolSelected(t.command,n))}),a(1,"ion-label"),s(2),o()()}if(r&2){let i=l.$implicit;d(2),v(i.label)}}function Sr(r,l){if(r&1&&(a(0,"ion-list",70),S(1,Mr,3,1,"ion-item",71,pe),o()),r&2){let i=p(2);d(),O(i.distanceToolsMap)}}function Or(r,l){if(r&1){let i=k();a(0,"ion-item",72),u("click",function(){let t=g(i).$implicit;p(2);let n=Ae(18),c=p();return n.dismiss(),f(c.usePaceTool(t.command))}),a(1,"ion-label"),s(2),o()()}if(r&2){let i=l.$implicit;d(2),v(i.label)}}function Ir(r,l){if(r&1&&(a(0,"ion-list",70),S(1,Or,3,1,"ion-item",71,pe),o()),r&2){let i=p(2);d(),O(i.paceToolsMap)}}function Er(r,l){if(r&1){let i=k();a(0,"ion-row",90),u("@keyboardPanel.done",function(t){g(i);let n=p();return f(n.onKeyboardPanelAnimationDone(t))}),x(1,Tr,2,2,"ion-col",91),I(2,"async"),a(3,"ion-col",92)(4,"app-calculator-input",93),u("clear",function(){g(i);let t=p();return f(t.onClearInput())})("inputChange",function(t){g(i);let n=p();return f(n.onInputChange(t))}),o()(),a(5,"ion-col",94)(6,"div",95)(7,"div",96)(8,"ion-button",97),u("click",function(){g(i);let t=p();return f(t.viewDetails())}),b(9,"ion-icon",46),o()(),a(10,"button",98),s(11," Distance Tools "),o(),a(12,"ion-popover",99,1),x(14,Sr,3,0,"ng-template"),o(),a(15,"button",100),s(16," Pace Tools "),o(),a(17,"ion-popover",101,2),x(19,Ir,3,0,"ng-template"),o()()()()}if(r&2){let i,e=p();w("keyboard-collapsing",e.isKeyboardCollapsing()),h("@keyboardPanel",void 0),d(),C((i=E(2,8,e.adjustmentButtons$))?1:-1,i),d(3),h("collapseMode",e.isKeyboardCollapsing())("buttonRows",e.inputButtons),d(4),w("details-button-pop",e.activeDetailsButtonPop()==="calculator")}}var Dr=260,Rr=260,Vr=320,Ji=24,Ar="cubic-bezier(0.32, 0, 0.2, 1)",Br="cubic-bezier(0.8, 0, 0.68, 1)",nn=180,Fr=/^[0-9]$/,Dd=(()=>{let l=class l{onModeChange(e){this.onTrainingTableModeChange(e.detail.value)}constructor(){this.store=A(be),this.modalCtrl=A(q),this.toastCtrl=A(Pe),this.darkModeMediaQuery=window.matchMedia("(prefers-color-scheme: dark)"),this.shouldRevealPromptAfterKeyboardExpand=!1,this.lightThemeColor="#c8daf3",this.darkThemeColor="#0f172a",this.maxLthrBpm=220,this.statusBarLightModeDarkenRatio=.1,this.statusBarDarkModeLightenRatio=.12,this.systemThemeListener=e=>{this.appTheme()==="system"&&this.applyTheme(this.appTheme(),e.matches,this.appAccent())},this.highcharts=Uo,this.paceToolsMap=ei,this.distanceToolsMap=ti,this.splitsToolsMap=ni,this.trainingTypeInfo=zi,this.activeFocusTab=D("splits"),this.trainingTableMode=D("road"),this.lthrBpm=D(""),this.highlightDistance=D(!1),this.highlightResults=D(!1),this.isKeyboardCollapsing=D(!1),this.activeDetailsButtonPop=D(null),this.distance$=this.store.select(Kt),this.distanceType$=this.store.select(Gt),this.time$=this.store.select(Yt),this.pace$=this.store.select(Ut),this.paceType$=this.store.select(lt),this.results$=this.store.select(Qt),this.visibleResults$=this.store.select(ki),this.focusedResult$=this.store.select(Ti),this.lockType$=this.store.select(ci),this.inputType$=this.store.select(di),this.focusId$=this.store.select(qt),this.adjustmentButtons$=this.store.select(mi),this.splits$=this.store.select(pi),this.splitDistanceBy$=this.store.select(ui),this.isInputCollapsed$=this.store.select(hi),this.splitsChartOptions$=this.store.select(gi),this.splitsChartReady$=this.store.select(fi),this.splitPlan$=this.store.select(xi),this.isKeyboardShowing=this.store.selectSignal(Ci),this.showKeyboardInputPrompt=D(!1),this.appTheme=this.store.selectSignal(Dt),this.appAccent=this.store.selectSignal(Rt),this.overallCalculationMode=this.store.selectSignal(vi),this.heatAdjustment=this.store.selectSignal(Vt),this.clampNotice=this.store.selectSignal(bi),this.distanceEstimatorPlan=this.store.selectSignal(yi),this.focusId=this.store.selectSignal(qt),this.results=this.store.selectSignal(Qt),this.distance=this.store.selectSignal(Kt),this.distanceType=this.store.selectSignal(Gt),this.paceType=this.store.selectSignal(lt),this.pace=this.store.selectSignal(Ut),this.time=this.store.selectSignal(Yt),this.themeEffect=Wt(()=>{let e=this.appTheme(),t=this.appAccent();this.applyTheme(e,this.darkModeMediaQuery.matches,t)}),this.clampNoticeEffect=Wt(()=>{let e=this.clampNotice();e&&(this.presentClampNotice(e.message),this.store.dispatch(M.clearClampNotice()))}),this.goalPerformance=U(()=>{let e=this.focusId();if(e===null)return null;if(e>=0){let c=this.results().find(m=>m.id===e);return c?{distanceMeters:c.distanceInMeters,timeSeconds:qe(c.time)}:null}let t=Number(this.distance());return{distanceMeters:this.distanceType()==="km"?t*1e3:t*1609.344,timeSeconds:qe(this.time())}}),this.trainingPaces=U(()=>{let e=this.goalPerformance();return!e||!e.timeSeconds?null:ai(e.distanceMeters,e.timeSeconds)}),this.trainingRepTables=U(()=>{let e=this.trainingPaces();return e?oi(e):null}),this.trainingRows=U(()=>{let e=this.trainingPaces();if(!e)return[];let t=n=>n*1.60934;return[{type:"easy",label:"Easy",pacePerKm:{min:ne(e.easy.min),max:ne(e.easy.max)},pacePerMi:{min:ne(t(e.easy.min)),max:ne(t(e.easy.max))}},{type:"marathon",label:"Marathon",pacePerKm:ne(e.marathon),pacePerMi:ne(t(e.marathon))},{type:"threshold",label:"Threshold",pacePerKm:ne(e.threshold),pacePerMi:ne(t(e.threshold))},{type:"interval",label:"Interval",pacePerKm:ne(e.interval),pacePerMi:ne(t(e.interval))},{type:"repetition",label:"Repetition",pacePerKm:ne(e.repetition),pacePerMi:ne(t(e.repetition))}]}),this.repRowsPrimary=U(()=>{let e=this.trainingRepTables();return e?[{type:"threshold",label:"Threshold",times:{"1200m":e.primary.threshold["1200m"],"800m":e.primary.threshold["800m"],"600m":e.primary.threshold["600m"],"400m":null,"300m":null,"200m":null}},{type:"interval",label:"Interval",times:{"1200m":e.primary.interval["1200m"],"800m":e.primary.interval["800m"],"600m":e.primary.interval["600m"],"400m":null,"300m":null,"200m":null}},{type:"repetition",label:"Repetition",times:{"1200m":e.primary.repetition["1200m"],"800m":e.primary.repetition["800m"],"600m":e.primary.repetition["600m"],"400m":null,"300m":null,"200m":null}}]:[]}),this.repRowsSecondary=U(()=>{let e=this.trainingRepTables();return e?[{type:"interval",label:"Interval",times:{"1200m":null,"800m":null,"600m":null,"400m":e.secondary.interval["400m"],"300m":e.secondary.interval["300m"],"200m":e.secondary.interval["200m"]}},{type:"repetition",label:"Repetition",times:{"1200m":null,"800m":null,"600m":null,"400m":e.secondary.repetition["400m"],"300m":e.secondary.repetition["300m"],"200m":e.secondary.repetition["200m"]}},{type:"fastReps",label:"Fast Reps",times:{"1200m":null,"800m":null,"600m":null,"400m":e.secondary.fastReps["400m"],"300m":e.secondary.fastReps["300m"],"200m":e.secondary.fastReps["200m"]}}]:[]}),this.lthrSummary=U(()=>{let e=this.trainingPaces();if(!e)return null;let t=ne(e.threshold),n=ne(e.threshold*1.60934),c=ri(Number(this.lthrBpm()));return{thresholdPacePerKm:t,thresholdPacePerMi:n,hasLthrBpm:!!c,zones:c||void 0}}),this.inputButtons=[["1","2","3"],["4","5","6"],["7","8","9"],[".","0","C"]],W({arrowForward:Dn,chevronCollapseOutline:An,heart:wt,calculator:Vn,calculatorOutline:kt,lockOpenOutline:jn,lockClosed:Wn,pin:Kn,pinOutline:Mt,hammerOutline:Hn,arrowBackOutline:X,chevronForwardOutline:Bn,informationCircleOutline:Pt,closeCircleOutline:Fn,createOutline:Ln,"keyboard-hide":"assets/keyboard_hide.svg","keyboard-show":"assets/keyboard_show.svg"})}async ngOnInit(){this.handleColorSchemeChange(),this.showKeyboardInputPrompt.set(this.isKeyboardShowing());let{value:e}=await Te.get({key:"LTHR_BPM"});if(e){let t=this.sanitizeLthrBpm(e);this.lthrBpm.set(t),t!==e&&Te.set({key:"LTHR_BPM",value:t})}}ngOnDestroy(){this.darkModeMediaQuery.removeEventListener("change",this.systemThemeListener),this.keyboardCollapseResetTimeout&&clearTimeout(this.keyboardCollapseResetTimeout),this.keyboardToggleDispatchTimeout&&clearTimeout(this.keyboardToggleDispatchTimeout),this.viewDetailsFocusTimeout&&clearTimeout(this.viewDetailsFocusTimeout),this.detailsButtonPopResetTimeout&&clearTimeout(this.detailsButtonPopResetTimeout)}async ionViewDidEnter(){await this.checkFirstInstall()}async checkFirstInstall(){let{value:e}=await Te.get({key:st});e!=="true"&&await(await this.modalCtrl.create({component:Bt,backdropDismiss:!1,cssClass:"onboarding-fullscreen-modal"})).present()}handleColorSchemeChange(){this.darkModeMediaQuery.addEventListener("change",this.systemThemeListener)}applyTheme(e,t,n){let c=e==="dark"||e==="system"&&t,m=document.documentElement;m.dataset.theme=e,m.classList.toggle("dark",c),m.classList.toggle("ion-palette-dark",c),this.applyAccent(n,c),this.updateThemeColorMeta(c),this.store.dispatch(M.changeTheme({isDarkMode:c}))}updateThemeColorMeta(e){let t=document.documentElement,m=getComputedStyle(t).getPropertyValue("--calc-surface-0").trim()||(e?this.darkThemeColor:this.lightThemeColor),_=document.querySelector('meta[name="theme-color"]');_&&_.setAttribute("content",m);let P=this.getStatusBarColorVariant(m,e);this.updateStatusBarTheme(P,e)}async updateStatusBarTheme(e,t){if(Ue.isNativePlatform())try{if(await $t.setOverlaysWebView({overlay:!1}),Ue.getPlatform()==="android"){let n={color:e};await Promise.all([$t.setBackgroundColor(n).catch(()=>{}),Ri.setBackgroundColor(n).catch(()=>{})])}await $t.setStyle({style:t?Ft.Light:Ft.Dark})}catch(n){console.warn("Unable to sync status bar theme",n)}}getStatusBarColorVariant(e,t){let n=this.normalizeHexColor(e);if(!n)return e;let c=t?this.statusBarDarkModeLightenRatio:this.statusBarLightModeDarkenRatio,m=t?255:0,_=this.parseHexColor(n),P={r:Math.round(_.r+(m-_.r)*c),g:Math.round(_.g+(m-_.g)*c),b:Math.round(_.b+(m-_.b)*c)};return this.rgbToHex(P.r,P.g,P.b)}normalizeHexColor(e){let t=e.trim(),n=/^#([0-9a-fA-F]{3})$/;if(n.test(t)){let[,c]=n.exec(t);return`#${c.split("").map(m=>`${m}${m}`).join("")}`.toLowerCase()}return/^#([0-9a-fA-F]{6})$/.test(t)?t.toLowerCase():null}parseHexColor(e){return{r:Number.parseInt(e.slice(1,3),16),g:Number.parseInt(e.slice(3,5),16),b:Number.parseInt(e.slice(5,7),16)}}rgbToHex(e,t,n){return`#${[e,t,n].map(c=>c.toString(16).padStart(2,"0")).join("")}`}applyAccent(e,t){let n=Jn(e),c=document.documentElement,m=t?n.dark:n.light;c.style.setProperty("--calc-accent",m.accent),c.style.setProperty("--calc-accent-strong",m.accentStrong),c.style.setProperty("--calc-link",m.accentStrong),c.style.setProperty("--calc-surface-0",m.surface0),c.style.setProperty("--calc-surface-1",m.surface1),c.style.setProperty("--calc-surface-2",m.surface2),c.style.setProperty("--calc-surface-3",m.surface3)}trackById(e,t){return t.id}setFocus(e){var t,n;try{(n=(t=this.ionContent)==null?void 0:t.nativeElement)==null||n.scrollToTop()}catch{}e===null&&(this.viewDetailsFocusTimeout&&(clearTimeout(this.viewDetailsFocusTimeout),this.viewDetailsFocusTimeout=void 0),this.detailsButtonPopResetTimeout&&(clearTimeout(this.detailsButtonPopResetTimeout),this.detailsButtonPopResetTimeout=void 0),this.activeDetailsButtonPop.set(null)),e!==null&&(this.activeFocusTab.set("splits"),this.trainingTableMode.set("road")),this.store.dispatch(M.setFocus({focusId:e}))}setDistance(e){this.highlightDistance.set(!0),setTimeout(()=>{this.highlightDistance.set(!1)},200),this.store.dispatch(M.setDistance({distanceInMeters:e}))}async openDistanceManager(){let e=await this.modalCtrl.create({component:Ui,componentProps:{results:this.results()},cssClass:"distance-manager-fullscreen-modal",backdropDismiss:!1});await e.present();let{data:t}=await e.onDidDismiss();t!=null&&t.results&&this.store.dispatch(M.setDistanceResults({results:t.results}))}async openDistanceEstimator(){let e=await this.modalCtrl.create({component:Zi,componentProps:{plan:this.distanceEstimatorPlan(),defaultPaceUnit:this.paceType()==="mi"?"mi":"km"},cssClass:"distance-estimator-fullscreen-modal",backdropDismiss:!1});await e.present();let{data:t}=await e.onDidDismiss();if(!(t!=null&&t.plan))return;let n=j(N({},t.plan),{updatedAt:new Date().toISOString()});this.store.dispatch(M.setDistanceEstimatorPlan({plan:n}))}async onDistanceToolSelected(e,t){if(await t.dismiss(),e==="estimateDistance"){await this.openDistanceEstimator();return}this.useDistanceTool(e)}onLockTypeChange(e,t){this.store.dispatch(M.changeLockType({lockType:t})),e.stopPropagation()}onAdjustmentChange(e){this.store.dispatch(M.adjustmentChanged({adjustment:e}))}onInputTypeChange(e){this.isKeyboardShowing()&&this.store.dispatch(M.changeInputType({inputType:e}))}onInputChange(e){this.store.dispatch(M.inputChanged({input:e}))}onClearInput(){this.store.dispatch(M.clearInput())}onGlobalKeydown(e){if(!this.isKeyboardShowing()||e.defaultPrevented||e.ctrlKey||e.metaKey||e.altKey||this.isEditableEventTarget(e))return;let t=this.getMappedKeyboardInput(e);if(t){if(e.preventDefault(),t==="C"){this.onClearInput();return}this.onInputChange(t)}}useDistanceTool(e){if(e==="estimateDistance"){this.openDistanceEstimator();return}let t=this.distanceType();if(t==="km"&&(e==="km"||e==="cKm")||t==="mi"&&(e==="mi"||e==="cMi")){this.presentClampNotice(`Distance is already in ${t==="km"?"kilometers":"miles"}.`);return}this.store.dispatch(M.useDistanceTool({command:e}))}async usePaceTool(e){if(e==="viewPaceChart"){if(!this.hasValidPaceChartCalculation()){this.presentClampNotice("Enter non-zero distance, time, and pace to view pace chart.");return}this.store.dispatch(M.initializePaceChart());let c=await this.modalCtrl.create({component:Ki,cssClass:"pace-chart-fullscreen-modal",backdropDismiss:!1});await c.present(),await c.onDidDismiss(),this.store.dispatch(M.applyPaceChartSelection());return}if(e==="heatAdjust"){let c=await this.modalCtrl.create({component:Ei,cssClass:"heat-adjustment-fullscreen-modal"});await c.present();let{data:m}=await c.onDidDismiss();m&&this.store.dispatch(M.applyHeatAdjustment({payload:{temperature:m.temperature,dewPoint:m.dewPoint,temperatureType:m.temperatureType,direction:m.direction==="reverse"?"reverse":"forward"}}));return}let t=this.paceType();if(t==="km"&&(e==="km"||e==="cKm")||t==="mi"&&(e==="mi"||e==="cMi")||t==="m400"&&(e==="m400"||e==="c400")){let c=t==="km"?"/kilometer":t==="mi"?"/mile":"/400m";this.presentClampNotice(`Pace is already in ${c}.`);return}this.store.dispatch(M.usePaceTool({command:e}))}hasValidPaceChartCalculation(){let e=Number(this.distance()),t=qe(this.time()),n=Et(this.pace());return Number.isFinite(e)&&e>0&&t>0&&n>0}clearHeatAdjustment(){this.store.dispatch(M.applyHeatAdjustment({payload:{temperature:"",dewPoint:"",temperatureType:this.heatAdjustment().temperatureType,direction:this.heatAdjustment().direction}}))}useSplitsTool(e){this.store.dispatch(M.useSplitsTool({command:e}))}viewResultDetails(e){this.triggerDetailsButtonPop(`row-${e}`),this.viewDetailsFocusTimeout&&clearTimeout(this.viewDetailsFocusTimeout),this.viewDetailsFocusTimeout=setTimeout(()=>{this.setFocus(e),this.viewDetailsFocusTimeout=void 0},nn)}viewDetails(){this.triggerDetailsButtonPop("calculator"),this.viewDetailsFocusTimeout&&clearTimeout(this.viewDetailsFocusTimeout),this.viewDetailsFocusTimeout=setTimeout(()=>{this.setFocus(-1),this.viewDetailsFocusTimeout=void 0},nn)}triggerDetailsButtonPop(e){this.activeDetailsButtonPop.set(e),this.detailsButtonPopResetTimeout&&clearTimeout(this.detailsButtonPopResetTimeout),this.detailsButtonPopResetTimeout=setTimeout(()=>{this.activeDetailsButtonPop.set(null),this.detailsButtonPopResetTimeout=void 0},nn)}handleSplitHalfDeltaChange(e){this.store.dispatch(M.setSplitHalfDelta({seconds:e}))}handleSplitHalfDeltaReset(){this.store.dispatch(M.resetSplitHalfDelta())}handleSplitStrategyProfileChange(e){this.store.dispatch(M.setSplitStrategyProfile({profile:e}))}handleSplitTransitionPointChange(e){this.store.dispatch(M.setSplitTransitionPoint({percent:e}))}handleSplitLapTagChange(e){this.store.dispatch(M.setSplitLapTag(e))}handleSplitLapTagsReset(){this.store.dispatch(M.resetLapTags())}onCalculationModeChange(e){this.store.dispatch(M.setOverallCalculationMode({mode:e.detail.value==="useRacePredictor"?"race":"pace"})),this.highlightResults.set(!1),setTimeout(()=>{this.highlightResults.set(!0),setTimeout(()=>{this.highlightResults.set(!1)},500)},10)}onFocusTabChange(e){this.activeFocusTab.set(e)}onTrainingTableModeChange(e){this.trainingTableMode.set(e)}onLthrBpmChange(e){let t=this.sanitizeLthrBpm(e);this.lthrBpm.set(t),Te.set({key:"LTHR_BPM",value:t})}getMappedKeyboardInput(e){let{key:t,code:n}=e;return t==="Backspace"||t==="Delete"||n==="NumpadClear"?"C":n==="NumpadDecimal"||t==="."||t===","?".":Fr.test(t)?t:null}isEditableEventTarget(e){return(typeof e.composedPath=="function"?e.composedPath():[e.target]).some(n=>{if(!(n instanceof HTMLElement))return!1;let c=n.tagName;return c==="INPUT"||c==="TEXTAREA"||c==="SELECT"?!0:n.isContentEditable||n.getAttribute("role")==="textbox"})}sanitizeLthrBpm(e){let t=e.replace(/[^0-9]/g,"").slice(0,3);return t?String(Math.min(this.maxLthrBpm,Number(t))):""}async openTrainingTypeInfo(e){let t=typeof e=="string"?{type:e,suggestedPaces:[]}:e,n=this.trainingTypeInfo[t.type];if(!n)return;await(await this.modalCtrl.create({component:Hi,componentProps:{typeInfo:n,suggestedPaces:t.suggestedPaces},cssClass:"training-pace-fullscreen-modal"})).present()}async openLthrInfo(){await(await this.modalCtrl.create({component:Wi,cssClass:"lthr-fullscreen-modal"})).present()}toggleKeyboard(){if(this.isKeyboardShowing()){this.isKeyboardCollapsing.set(!0),this.shouldRevealPromptAfterKeyboardExpand=!1,this.keyboardToggleDispatchTimeout&&clearTimeout(this.keyboardToggleDispatchTimeout),this.keyboardCollapseResetTimeout&&clearTimeout(this.keyboardCollapseResetTimeout),this.keyboardCollapseResetTimeout=setTimeout(()=>{this.isKeyboardCollapsing.set(!1),this.showKeyboardInputPrompt.set(!1),this.keyboardCollapseResetTimeout=void 0},Vr+Ji),this.keyboardToggleDispatchTimeout=setTimeout(()=>{this.store.dispatch(M.toggleKeyboard()),this.keyboardToggleDispatchTimeout=void 0},Ji);return}else this.keyboardCollapseResetTimeout&&(clearTimeout(this.keyboardCollapseResetTimeout),this.keyboardCollapseResetTimeout=void 0),this.keyboardToggleDispatchTimeout&&(clearTimeout(this.keyboardToggleDispatchTimeout),this.keyboardToggleDispatchTimeout=void 0),this.isKeyboardCollapsing.set(!1),this.shouldRevealPromptAfterKeyboardExpand=!0,this.showKeyboardInputPrompt.set(!1);this.store.dispatch(M.toggleKeyboard())}onKeyboardPanelAnimationDone(e){!this.shouldRevealPromptAfterKeyboardExpand||!(e.fromState==="void"&&e.toState!=="void"&&e.phaseName==="done")||!this.isKeyboardShowing()||this.isKeyboardCollapsing()||(this.showKeyboardInputPrompt.set(!0),this.shouldRevealPromptAfterKeyboardExpand=!1)}async openAboutModal(){await(await this.modalCtrl.create({component:Di,cssClass:"about-fullscreen-modal"})).present()}async presentClampNotice(e){await(await this.toastCtrl.create({message:e,duration:1700,position:"middle"})).present()}};l.\u0275fac=function(t){return new(t||l)},l.\u0275cmp=R({type:l,selectors:[["app-calculator"]],viewQuery:function(t,n){if(t&1&&Me(K,5,mt),t&2){let c;Se(c=Oe())&&(n.ionContent=c.first)}},hostBindings:function(t,n){t&1&&u("keydown",function(m){return n.onGlobalKeydown(m)},!1,pn)},decls:70,vars:91,consts:[["splitsPopover",""],["distancePopover",""],["pacePopover",""],[1,"safe-area-content","safe-area-content-top","calc-content"],[1,"mx-auto","max-w-xl","px-2","pb-4","pt-2"],[1,"sticky","top-2","z-10"],[1,"calc-surface-card","results-head-card"],[1,"results-head-grid","text-[11px]","font-semibold","uppercase","tracking-[0.08em]","text-[var(--calc-text-muted)]"],["fill","clear","mode","md","aria-label","Manage race distances",1,"distance-head-edit-btn","results-head-distance",3,"click"],[1,"distance-head-edit-copy"],["slot","end","name","create-outline",1,"distance-head-edit-icon","plt-android:translate-y-[-0.15em]"],[1,"results-head-time"],[1,"results-head-pace"],[1,"results-head-details"],[1,"calc-shell-subtle","calc-heat-banner","flex","items-center","justify-between","gap-2","py-2","pl-3","pr-2","text-xs"],[1,"results-table","mt-2"],[1,"focus-tab-shell"],[1,"safe-area-inline","safe-area-bottom","calc-footer"],[1,"mx-auto","max-w-5xl","px-2","pb-2"],[1,"keyboard-panel-anim","mx-auto","mt-0.5","max-w-xl","rounded-xl",3,"keyboard-collapsing","pin-row-hidden-instant"],[1,"my-2"],[1,"calc-shell-subtle","mx-auto","mt-1","grid","max-w-xl","grid-cols-3","gap-1","rounded-2xl","px-1","py-0.5",3,"hidden"],[1,"calc-keypad-grid","calc-shell-subtle","mt-1","rounded-2xl","p-1"],["class","keyboard-panel-anim ion-align-items-center",3,"keyboard-collapsing",4,"ngIf"],[1,"ion-align-items-center","mt-1"],["size","2"],["aria-label","Open about","fill","clear","shape","round",1,"calc-icon-btn","mx-auto","flex",3,"click"],["slot","icon-only","name","information-circle-outline"],["size","8"],["mode","ios",1,"app-segment",3,"ionChange","value"],["value","useSteadyPace"],["value","useRacePredictor"],["aria-label","Toggle keyboard","fill","clear","shape","round",1,"calc-icon-btn","mx-auto","flex",3,"click"],["slot","icon-only",3,"name"],[1,"font-semibold"],["type","button","aria-label","Clear heat adjustment",1,"calc-heat-dismiss","flex","items-center","justify-center","rounded-full","p-1","transition-colors",3,"click"],["name","close-circle-outline",1,"text-base"],[1,"result-row-card"],[1,"result-row-grid"],[1,"result-cell-distance"],["type","button",1,"result-link",3,"click"],[1,"result-cell-time"],[1,"result-primary"],[1,"result-cell-pace"],[1,"result-cell-details"],["fill","clear","shape","round",1,"calc-icon-btn","result-splits-btn",3,"click"],["slot","icon-only","name","arrow-forward"],[1,"focus-tab-pane"],[3,"splitHalfDeltaChange","splitHalfDeltaReset","splitStrategyProfileChange","splitTransitionPointChange","splitLapTagChange","splitLapTagsReset","highcharts","splitsChartReady","splitsChartOptions","splitPlan","splits"],[3,"openTypeInfo","tableMode","trainingRows","repRowsPrimary","repRowsSecondary"],[3,"lthrBpmChange","openInfo","lthrSummary","lthrBpm"],[3,"navigateToTab","distanceMeters","hasValidBaseline","distanceType","focusId"],["class","keyboard-panel-anim mx-auto mt-0.5 max-w-xl rounded-xl",3,"keyboard-collapsing","pin-row-hidden-instant",4,"ngIf"],[1,"keyboard-panel-anim","mx-auto","mt-0.5","max-w-xl","rounded-xl"],[1,"grid","grid-cols-3","gap-1"],["type","button","aria-label","Set distance as fixed metric",1,"fixed-metric-chip",3,"click","ngClass"],[1,"text-xs",3,"name"],["type","button","aria-label","Set time as fixed metric",1,"fixed-metric-chip",3,"click","ngClass"],["type","button","aria-label","Set pace as fixed metric",1,"fixed-metric-chip",3,"click","ngClass"],[1,"mx-auto","max-w-5xl"],[3,"activeTabChange","activeTab"],["mode","md",1,"focus-summary-item"],["aria-label","Back to calculator","size","large","shape","round","slot","start","fill","clear",1,"calc-icon-btn",3,"click"],["slot","icon-only","name","arrow-back-outline"],["mode","ios",1,"app-segment","w-[150px]","p-[2px]",3,"value"],[1,"calc-muted-copy","text-xs","uppercase","tracking-[0.08em]"],[1,"text-lg","font-extrabold"],[1,"calc-muted-copy","text-sm"],["id","splits-popover-trigger","aria-label","Open split by options",1,"tool-btn","px-3"],["trigger","splits-popover-trigger"],["mode","md"],["button",""],["button","",3,"click"],["mode","ios",1,"app-segment","w-[150px]","p-[2px]",3,"ionChange","value"],["value","road"],["value","track"],[1,"calc-shell-subtle","mx-auto","mt-1","grid","max-w-xl","grid-cols-3","gap-1","rounded-2xl","px-1","py-0.5"],["type","button","aria-label","Select distance input",1,"input-metric-card",3,"click","ngClass"],["name","pin",1,"metric-pin-marker"],[1,"metric-label","text-center","text-[10px]","font-semibold","uppercase","tracking-[0.08em]"],[1,"metric-label-copy"],[1,"metric-enter-prefix"],[1,"metric-label-main"],[1,"mb-0","mt-0","flex","flex-row","justify-center","gap-1","text-sm","font-semibold","leading-none"],[1,"metric-value","text-right",3,"ngClass"],[1,"metric-unit",3,"ngClass"],["type","button","aria-label","Select time input",1,"input-metric-card",3,"click","ngClass"],[1,"metric-value","text-right"],["type","button","aria-label","Select pace input",1,"input-metric-card",3,"click","ngClass"],[1,"metric-unit"],[1,"keyboard-panel-anim","ion-align-items-center"],["size","3"],["size","6"],[3,"clear","inputChange","collapseMode","buttonRows"],["size","3",1,"ion-align-self-stretch","min-w-0"],[1,"keypad-tools-column","h-full","py-0.5"],[1,"keypad-details-slot"],["aria-label","View details","fill","clear","shape","round",1,"calc-icon-btn","keypad-details-btn","result-splits-btn",3,"click"],["id","distance-tools-trigger","aria-label","Open distance tools",1,"tool-btn","w-full","p-2","text-center"],["trigger","distance-tools-trigger"],["id","pace-tools-trigger","aria-label","Open pace tools",1,"tool-btn","w-full","p-2","text-center"],["trigger","pace-tools-trigger"],[3,"inputChange","collapseMode","buttonRows"]],template:function(t,n){if(t&1&&(a(0,"ion-content",3),I(1,"async"),a(2,"div",4),I(3,"async"),a(4,"div")(5,"div",5)(6,"section",6)(7,"div",7)(8,"ion-button",8),u("click",function(){return n.openDistanceManager()}),a(9,"span",9),s(10,"Distance"),o(),b(11,"ion-icon",10),o(),a(12,"p",11),s(13,"Time"),o(),a(14,"p",12),s(15,"Pace"),o(),a(16,"p",13),s(17,"View"),o()(),x(18,nr,9,4,"div",14),o()(),a(19,"div",15),S(20,ar,2,5,null,null,Xo),I(22,"async"),o()()(),x(23,dr,5,1,"div",16),I(24,"async"),o(),a(25,"ion-footer",17)(26,"div",18),x(27,pr,1,1,"div",19),I(28,"async"),I(29,"async"),I(30,"async"),x(31,ur,3,1,"div",20),I(32,"async"),x(33,vr,1,1),I(34,"async"),I(35,"async"),I(36,"async"),I(37,"async"),I(38,"async"),I(39,"async"),I(40,"async"),x(41,Pr,38,31,"div",21),I(42,"async"),I(43,"async"),I(44,"async"),I(45,"async"),I(46,"async"),I(47,"async"),I(48,"async"),I(49,"async"),I(50,"async"),a(51,"ion-grid",22),I(52,"async"),I(53,"async"),x(54,Er,20,10,"ion-row",23),a(55,"ion-row",24)(56,"ion-col",25)(57,"ion-button",26),u("click",function(){return n.openAboutModal()}),b(58,"ion-icon",27),o()(),a(59,"ion-col",28)(60,"ion-segment",29),u("ionChange",function(m){return n.onCalculationModeChange(m)}),a(61,"ion-segment-button",30)(62,"ion-label"),s(63,"Steady Pace"),o()(),a(64,"ion-segment-button",31)(65,"ion-label"),s(66,"Race Predictor"),o()()()(),a(67,"ion-col",25)(68,"ion-button",32),u("click",function(){return n.toggleKeyboard()}),b(69,"ion-icon",33),o()()()()()()),t&2){let c,m,_;w("focus-scrollbar-visible",E(1,17,n.focusId$)!==null&&(n.activeFocusTab()==="splits"||n.activeFocusTab()==="blocks")),d(2),w("hidden",E(3,19,n.focusId$)!==null),d(16),C(+n.heatAdjustment().temperature&&+n.heatAdjustment().dewPoint?18:-1),d(2),O(E(22,21,n.visibleResults$)),d(3),C(E(24,23,n.focusId$)!==null?23:-1),d(4),C((c=gn(69,Ko,E(28,25,n.lockType$),E(29,27,n.isInputCollapsed$),E(30,29,n.focusId$)))?27:-1,c),d(4),C(E(32,31,n.focusId$)!==null?31:-1),d(2),C((m=_n(73,Go,E(34,33,n.focusId$),E(35,35,n.focusedResult$),E(36,37,n.paceType$),E(37,39,n.distance$),E(38,41,n.distanceType$),E(39,43,n.time$),E(40,45,n.pace$)))?33:-1,m),d(8),C((_=bn(81,Yo,[E(42,47,n.inputType$),E(43,49,n.distance$),E(44,51,n.pace$),E(45,53,n.time$),E(46,55,n.distanceType$),E(47,57,n.paceType$),E(48,59,n.lockType$),E(49,61,n.isInputCollapsed$),E(50,63,n.focusId$)]))?41:-1,_),d(10),w("keyboard-collapsing",n.isKeyboardCollapsing())("hidden",E(52,65,n.isInputCollapsed$)||E(53,67,n.focusId$)!==null),d(3),h("ngIf",n.isKeyboardShowing()),d(6),h("value",n.overallCalculationMode()==="race"?"useRacePredictor":"useSteadyPace"),d(9),h("name",n.isKeyboardShowing()?"keyboard-hide":"keyboard-show")}},dependencies:[Z,Q,Oi,$,Cn,Be,yn,ge,Y,ze,K,He,We,H,xt,le,Tn,je,wn,Vi,Li,Ni,Ai,Bi],styles:["[_nghost-%COMP%]{--ion-background-color: var(--calc-surface-0)}.calc-content[_ngcontent-%COMP%]{--background: linear-gradient( 180deg, color-mix(in oklab, var(--calc-surface-0) 82%, white) 0%, color-mix(in oklab, var(--calc-surface-2) 84%, var(--calc-accent) 16%) 100% )}.calc-content.focus-scrollbar-visible[_ngcontent-%COMP%]::part(scroll){overflow-y:scroll;scrollbar-gutter:stable both-edges;scrollbar-width:thin;scrollbar-color:color-mix(in oklab,var(--calc-accent) 46%,var(--calc-surface-3)) transparent}.calc-content.focus-scrollbar-visible[_ngcontent-%COMP%]::part(scroll)::-webkit-scrollbar{width:8px}.calc-content.focus-scrollbar-visible[_ngcontent-%COMP%]::part(scroll)::-webkit-scrollbar-track{background:color-mix(in oklab,var(--calc-surface-2) 58%,transparent);border-radius:9999px}.calc-content.focus-scrollbar-visible[_ngcontent-%COMP%]::part(scroll)::-webkit-scrollbar-thumb{background:color-mix(in oklab,var(--calc-accent) 56%,var(--calc-surface-3));border-radius:9999px}.calc-footer[_ngcontent-%COMP%]{background:color-mix(in oklab,var(--calc-surface-raised) 80%,var(--calc-accent) 20%)}[_ngcontent-%COMP%]:root.ion-palette-dark   .calc-footer[_ngcontent-%COMP%]{background:color-mix(in oklab,var(--calc-surface-0) 80%,transparent)}.focus-tab-shell[_ngcontent-%COMP%]{position:relative;overflow:hidden}.focus-tab-pane[_ngcontent-%COMP%]{width:100%}.keyboard-panel-anim[_ngcontent-%COMP%]{overflow:hidden;transform-origin:top center;will-change:height,transform;contain:paint;backface-visibility:hidden}.pin-row-hidden-instant[_ngcontent-%COMP%]{display:none!important}.keyboard-collapsing[_ngcontent-%COMP%]     app-calculator-input .pill-container{box-shadow:none!important;background:linear-gradient(145deg,color-mix(in oklab,var(--calc-surface-3) 88%,var(--calc-accent) 12%),color-mix(in oklab,var(--calc-surface-raised) 90%,var(--calc-accent) 10%))!important;border-color:var(--calc-border-subtle)!important;transition:none!important}.keyboard-collapsing[_ngcontent-%COMP%]     app-calculator-input .glow-overlay{opacity:0!important;display:none!important;animation:none!important}.tool-btn[_ngcontent-%COMP%]{cursor:pointer;-webkit-user-select:none;user-select:none;min-height:42px;border-radius:var(--calc-radius-md);border:1px solid var(--calc-border-strong);background:linear-gradient(145deg,color-mix(in oklab,var(--calc-surface-3) 90%,var(--calc-accent) 10%),color-mix(in oklab,var(--calc-surface-raised) 92%,var(--calc-accent) 8%));color:var(--calc-text-strong);font-size:.875rem;font-weight:400;box-shadow:var(--calc-shadow-sm);transition:transform var(--calc-motion-fast) var(--calc-motion-ease),filter var(--calc-motion-fast) var(--calc-motion-ease)}.tool-btn[_ngcontent-%COMP%]:active{transform:scale(.97);filter:brightness(.95)}.calc-surface-card[_ngcontent-%COMP%]{border-radius:var(--calc-radius-lg);border:1px solid var(--calc-border-subtle);background:color-mix(in oklab,var(--calc-surface-raised) 88%,var(--calc-info-bg));box-shadow:var(--calc-shadow-sm);padding:.5rem .1rem 0}.results-head-card[_ngcontent-%COMP%]{padding:.28rem .1rem}.results-table[_ngcontent-%COMP%]{border-radius:var(--calc-radius-lg);border:1px solid var(--calc-border-subtle);background:color-mix(in oklab,var(--calc-surface-raised) 90%,var(--calc-info-bg));box-shadow:var(--calc-shadow-sm);overflow:hidden}.result-row-card[_ngcontent-%COMP%]{border-radius:0;border:0;background:transparent;box-shadow:none;padding:0;transition:background-color var(--calc-motion-fast) var(--calc-motion-ease),border-color var(--calc-motion-fast) var(--calc-motion-ease)}.result-row-card[_ngcontent-%COMP%]:not(:last-child){border-bottom:1px solid color-mix(in oklab,var(--calc-border-subtle) 70%,transparent)}.result-row-card[_ngcontent-%COMP%]:nth-child(odd){background:color-mix(in oklab,var(--calc-surface-stripe) 88%,var(--calc-info-bg) 12%)}.results-head-grid[_ngcontent-%COMP%], .result-row-grid[_ngcontent-%COMP%]{display:grid;--results-cols: minmax(0, 1.5fr) minmax(5rem, .95fr) minmax(6.6rem, 1.02fr) 3.15rem;grid-template-columns:var(--results-cols);align-items:center;gap:.46rem;padding-inline:.56rem}.distance-head-edit-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;align-self:center;justify-self:start;font-size:inherit;font-weight:inherit;letter-spacing:inherit;text-transform:inherit;line-height:1;margin:0;--background: transparent;--background-activated: transparent;--background-focused: transparent;--background-hover: transparent;--box-shadow: none;--color: var(--calc-accent-strong);--padding-start: .2rem;--padding-end: .2rem;--padding-top: 0;--padding-bottom: 0;--min-height: 0;height:auto}.distance-head-edit-btn[_ngcontent-%COMP%]::part(native){display:inline-flex;align-items:center;gap:.2rem;font:inherit;font-size:inherit;font-weight:inherit;letter-spacing:inherit;text-transform:inherit;line-height:1;min-height:0;padding-block:0}.distance-head-edit-copy[_ngcontent-%COMP%]{display:inline-flex;align-items:center;font-size:inherit;font-weight:inherit;line-height:1}.distance-head-edit-icon[_ngcontent-%COMP%]{display:inline-flex;align-self:center;align-items:center;justify-content:center;font-size:.78rem;line-height:1}.distance-head-edit-btn[_ngcontent-%COMP%]:active{transform:scale(.97)}.results-head-time[_ngcontent-%COMP%], .results-head-pace[_ngcontent-%COMP%], .results-head-details[_ngcontent-%COMP%]{margin:0}.results-head-time[_ngcontent-%COMP%], .results-head-pace[_ngcontent-%COMP%]{justify-self:stretch;text-align:center;padding-right:0;white-space:nowrap}.results-head-details[_ngcontent-%COMP%]{justify-self:center;text-align:center;padding-left:.26rem;white-space:nowrap}.result-cell-distance[_ngcontent-%COMP%]{min-width:0;display:flex;justify-content:flex-start}.result-cell-time[_ngcontent-%COMP%], .result-cell-pace[_ngcontent-%COMP%]{min-width:0;justify-self:end}.result-cell-pace[_ngcontent-%COMP%]{padding-right:.22rem}.result-cell-time[_ngcontent-%COMP%]   .result-primary[_ngcontent-%COMP%], .result-cell-pace[_ngcontent-%COMP%]   .result-primary[_ngcontent-%COMP%]{text-align:right;white-space:nowrap;font-variant-numeric:tabular-nums}.result-cell-details[_ngcontent-%COMP%]{width:100%;justify-self:center;display:flex;justify-content:center;padding-left:.18rem}.result-link[_ngcontent-%COMP%]{min-height:26px;display:inline-flex;justify-content:center;align-items:center;font-size:.75rem;font-weight:600;color:var(--calc-accent-strong);background:color-mix(in oklab,var(--calc-surface-2) 78%,var(--calc-info-bg));border:1px solid var(--calc-border-strong);border-radius:9999px;padding:0 .6rem;white-space:nowrap;max-width:100%;overflow:hidden;text-overflow:ellipsis;transition:transform var(--calc-motion-fast) var(--calc-motion-ease),background-color var(--calc-motion-fast) var(--calc-motion-ease)}@media (max-width: 480px){.results-head-grid[_ngcontent-%COMP%], .result-row-grid[_ngcontent-%COMP%]{--results-cols: minmax(0, 1.44fr) minmax(4.9rem, .92fr) minmax(6.3rem, .98fr) 3.05rem;gap:.4rem;padding-inline:.5rem}}@media (min-width: 600px) and (max-width: 767px){.results-head-grid[_ngcontent-%COMP%], .result-row-grid[_ngcontent-%COMP%]{--results-cols: minmax(0, 1.34fr) minmax(6.7rem, 1fr) minmax(8.15rem, 1.02fr) 3.95rem;gap:.7rem;padding-inline:.72rem}.result-cell-time[_ngcontent-%COMP%], .result-cell-pace[_ngcontent-%COMP%]{justify-self:stretch}.result-cell-time[_ngcontent-%COMP%]   .result-primary[_ngcontent-%COMP%], .result-cell-pace[_ngcontent-%COMP%]   .result-primary[_ngcontent-%COMP%]{text-align:center}.result-cell-pace[_ngcontent-%COMP%]{padding-right:0}.results-head-details[_ngcontent-%COMP%]{padding-left:.32rem}.result-cell-details[_ngcontent-%COMP%]{padding-left:.28rem}}@media (min-width: 768px){.results-head-grid[_ngcontent-%COMP%], .result-row-grid[_ngcontent-%COMP%]{--results-cols: minmax(0, 1.28fr) minmax(7.4rem, 1fr) minmax(9rem, 1.06fr) 4.7rem;gap:.85rem;padding-inline:.9rem}.results-head-time[_ngcontent-%COMP%], .results-head-pace[_ngcontent-%COMP%]{padding-right:0}.results-head-details[_ngcontent-%COMP%]{padding-left:.36rem}.result-cell-time[_ngcontent-%COMP%], .result-cell-pace[_ngcontent-%COMP%]{justify-self:stretch}.result-cell-pace[_ngcontent-%COMP%]{padding-right:0}.result-cell-time[_ngcontent-%COMP%]   .result-primary[_ngcontent-%COMP%], .result-cell-pace[_ngcontent-%COMP%]   .result-primary[_ngcontent-%COMP%]{text-align:center}.result-cell-details[_ngcontent-%COMP%]{padding-left:.36rem}}.result-link[_ngcontent-%COMP%]:active{transform:scale(.96);background:color-mix(in oklab,var(--calc-surface-3) 88%,var(--calc-info-bg))}.result-primary[_ngcontent-%COMP%]{color:var(--calc-text-strong);font-size:.9rem;font-weight:600}@keyframes _ngcontent-%COMP%_resultFlash{0%{color:var(--calc-accent-strong);opacity:.5}to{color:var(--calc-text-strong);opacity:1}}.result-primary.flash-highlight[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_resultFlash .5s ease-out forwards}.result-splits-btn[_ngcontent-%COMP%]{--color: color-mix(in oklab, var(--calc-accent-strong) 82%, #0f172a);--background: color-mix(in oklab, var(--calc-surface-raised) 82%, var(--calc-info-bg));--background-hover: color-mix(in oklab, var(--calc-info-bg) 74%, var(--calc-accent) 26%);--background-activated: color-mix(in oklab, var(--calc-info-bg) 74%, var(--calc-accent) 26%);--border-width: 1px;--border-style: solid;--border-color: var(--calc-border-strong);--box-shadow: 0 1px 2px color-mix(in oklab, var(--calc-border-subtle) 90%, transparent)}.details-button-pop[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_detailsButtonPop .18s cubic-bezier(.2,.9,.2,1)}@keyframes _ngcontent-%COMP%_detailsButtonPop{0%{transform:scale(1)}45%{transform:scale(.9)}to{transform:scale(1)}}.input-metric-card[_ngcontent-%COMP%]{cursor:pointer;min-height:50px;position:relative;display:flex;flex-direction:column;justify-content:center;align-items:center;gap:2px;border-radius:var(--calc-radius-md);border:1px solid color-mix(in oklab,var(--calc-border-subtle) 38%,transparent);color:var(--calc-text-strong);background:var(--calc-surface-raised);padding:.2rem;transition:background-color var(--calc-motion-normal) var(--calc-motion-ease),transform var(--calc-motion-fast) var(--calc-motion-ease),border-color var(--calc-motion-normal) var(--calc-motion-ease),box-shadow var(--calc-motion-normal) var(--calc-motion-ease)}.input-metric-card[_ngcontent-%COMP%]:active{transform:scale(.985)}.input-metric-card[_ngcontent-%COMP%]   .metric-label[_ngcontent-%COMP%]{color:var(--calc-text-muted)}.metric-label-copy[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;line-height:1}.metric-label-main[_ngcontent-%COMP%]{line-height:1}.metric-enter-prefix[_ngcontent-%COMP%]{display:inline-block;max-width:0;opacity:0;overflow:hidden;white-space:nowrap;line-height:1;padding-right:0;transform:translate(-3px);transition:max-width .3s cubic-bezier(.16,1,.3,1),opacity .19s ease,padding-right .3s cubic-bezier(.16,1,.3,1),transform .3s cubic-bezier(.16,1,.3,1)}.metric-enter-prefix-visible[_ngcontent-%COMP%]{max-width:4.2em;opacity:1;padding-right:.28em;transform:translate(0)}.input-metric-card[_ngcontent-%COMP%]   .metric-value[_ngcontent-%COMP%]{color:var(--calc-text-strong)}.input-metric-card[_ngcontent-%COMP%]   .metric-unit[_ngcontent-%COMP%]{color:var(--calc-text-muted)}.metric-pin-marker[_ngcontent-%COMP%]{position:absolute;top:.28rem;right:.3rem;font-size:.72rem;color:color-mix(in oklab,var(--metric-pin-color, var(--calc-accent)) 85%,var(--calc-text-strong));opacity:.95}.input-metric-card-active[_ngcontent-%COMP%]{border-color:var(--calc-active-fill-border);background:var(--calc-active-fill);box-shadow:var(--calc-shadow-sm)}.input-metric-card-active[_ngcontent-%COMP%]   .metric-label[_ngcontent-%COMP%], .input-metric-card-active[_ngcontent-%COMP%]   .metric-value[_ngcontent-%COMP%], .input-metric-card-active[_ngcontent-%COMP%]   .metric-unit[_ngcontent-%COMP%]{color:var(--calc-active-fill-text)}.fixed-metric-chip[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;gap:.25rem;min-height:28px;white-space:nowrap;border-radius:9999px;border:1px solid color-mix(in oklab,var(--calc-border-subtle) 44%,transparent);color:var(--calc-text-muted);background:color-mix(in oklab,var(--calc-surface-raised) 92%,var(--calc-surface-1));font-size:9.5px;font-weight:700;letter-spacing:.01em;padding:0 .45rem;transition:transform var(--calc-motion-fast) var(--calc-motion-ease),background-color var(--calc-motion-fast) var(--calc-motion-ease),border-color var(--calc-motion-fast) var(--calc-motion-ease)}.fixed-metric-chip[_ngcontent-%COMP%]:active{transform:scale(.98)}.fixed-metric-chip-active[_ngcontent-%COMP%]{border-color:var(--calc-active-fill-border);color:var(--calc-active-fill-text);background:var(--calc-active-fill);box-shadow:var(--calc-shadow-sm)}.keypad-tools-column[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.keypad-details-slot[_ngcontent-%COMP%]{flex:1 1 auto;min-height:0;display:flex;align-items:center;justify-content:center}.keypad-details-btn[_ngcontent-%COMP%]{margin:0}.calc-heat-banner[_ngcontent-%COMP%]{border-color:color-mix(in oklab,var(--calc-border-strong) 80%,transparent);background:color-mix(in oklab,var(--calc-info-bg) 74%,var(--calc-accent) 26%);color:var(--calc-text-muted)}.calc-heat-dismiss[_ngcontent-%COMP%]:hover{background:color-mix(in oklab,var(--calc-accent) 16%,transparent)}.metric-highlight[_ngcontent-%COMP%]{color:var(--calc-accent-strong)}.calc-table-head[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.75rem;line-height:1rem;font-weight:600;color:var(--calc-text-muted)}ion-range[_ngcontent-%COMP%]::part(tick), ion-range[_ngcontent-%COMP%]::part(tick-active), ion-range[_ngcontent-%COMP%]::part(bar), ion-range[_ngcontent-%COMP%]::part(bar-active){background:var(--calc-accent)}@media (min-width: 768px){.calc-keypad-grid[_ngcontent-%COMP%]{max-width:36rem;margin-left:auto;margin-right:auto}}[_ngcontent-%COMP%]:root.ion-palette-dark   .result-splits-btn[_ngcontent-%COMP%]{--color: #f7fbff;--background: color-mix(in oklab, var(--calc-surface-1) 80%, var(--calc-accent) 20%);--background-hover: color-mix(in oklab, var(--calc-surface-1) 68%, var(--calc-accent) 32%);--background-activated: color-mix(in oklab, var(--calc-surface-1) 68%, var(--calc-accent) 32%);--border-color: color-mix(in oklab, var(--calc-accent) 48%, transparent);--box-shadow: 0 1px 3px color-mix(in oklab, var(--calc-accent) 30%, transparent)}@media (prefers-reduced-motion: reduce){.result-row-card[_ngcontent-%COMP%], .input-metric-card[_ngcontent-%COMP%], .fixed-metric-chip[_ngcontent-%COMP%], .metric-enter-prefix[_ngcontent-%COMP%]{transition:none}.result-row-card[_ngcontent-%COMP%]:active, .input-metric-card[_ngcontent-%COMP%]:active, .fixed-metric-chip[_ngcontent-%COMP%]:active{transform:none}.details-button-pop[_ngcontent-%COMP%]{animation:none}}"],data:{animation:[Fe("focusTabPane",[we(":enter",[ue({opacity:0,transform:"translateY(32px)"}),ke("240ms cubic-bezier(0.22, 0.61, 0.36, 1)",ue({opacity:1,transform:"translateY(0)"}))])]),Fe("keyboardPanel",[we(":enter",[ue({height:0,transform:"translateY(-8px)"}),ke(`${Dr}ms ${Br}`,ue({height:"*",transform:"translateY(0)"}))]),we(":leave",[ue({height:"*",transform:"translateY(0)"}),ke(`${Rr}ms ${Ar}`,ue({height:0,transform:"translateY(-8px)"}))])])]}});let r=l;return r})();export{Dd as CalculatorPage};
